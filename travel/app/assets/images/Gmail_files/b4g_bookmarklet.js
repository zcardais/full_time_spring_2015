(function(){window.b4g=window.b4g||{};var dU,dN;var a1={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(en){for(var ek=0;ek<en.length;ek++){var el=en[ek].string;var em=en[ek].prop;this.versionSearchString=en[ek].versionSearch||en[ek].identity;if(el){if(el.indexOf(en[ek].subString)!==-1){return en[ek].identity}}else{if(em){return en[ek].identity}}}},searchVersion:function(el){var ek=el.indexOf(this.versionSearchString);if(ek===-1){return}return parseFloat(el.substring(ek+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};a1.init();var ci="none";switch(a1.browser){case"Chrome":ci="Chrome";break;case"Firefox":ci="Firefox";break;case"Safari":if(a1.version<5.1){ci="Old Safari"}else{ci="Safari"}break;default:ci="Other";break}var dS=false;window.onbeforeunload=function(){if(dS){if(ci==="Firefox"){alert("You are editing a message that you previously scheduled with Boomerang. DO NOT LEAVE THIS PAGE WITHOUT RESCHEDULING. \n\nIf you do, you will CANCEL SENDING THIS MESSAGE ALTOGETHER and the message will remain in your Drafts folder.")}return("You are editing a message that you previously scheduled with Boomerang. DO NOT LEAVE THIS PAGE WITHOUT RESCHEDULING. \n\nIf you do, you will CANCEL SENDING THIS MESSAGE ALTOGETHER and the message will remain in your Drafts folder.")}};var cu="https://s3.amazonaws.com/BoomerangForGmail/bookmarklet/";var bt=bb();var Z=null;var ab=null;var h=Date();var ac=9.5;var bn=6;var bc=false;var dE=null;var dD="https://b4g.baydin.com/";var bm=["success","success","Boomerang encountered a problem during authentication. Ask Boomerang to send this message again, and we will log you back in.","Boomerang was not able to access the Sent Mail folder. Please enable IMAP and allow Sent Mail to be shown in IMAP.","403 Not Authenticated","Boomerang was not able to access the Drafts folder. Please enable IMAP and allow Drafts to be shown in IMAP.","Boomerang was not able to access the Boomerang-Outbox folder. Please enable IMAP and allow the Boomerang-Outbox label to be shown in IMAP.","Boomerang was not able to access the Inbox. Please enable IMAP. In addition, please allow All Mail to be shown in IMAP.","Boomerang was not able to access the All Mail folder. Please enable IMAP. In addition, please allow All Mail to be shown in IMAP.","Boomerang cannot uniquely identify this email, because there is another draft with the same subject and recipient. Please change the subject and try again.","Boomerang cannot uniquely identify this email, because there is another email in the Boomerang-Outbox with the same subject and recipient. Please change the subject and try again.","Boomerang was unable to find this Draft. Please allow the draft to save again after a couple seconds, then try again. If you are still unsuccessful and you don't mind sharing this message to help improve our product, please forward to support@baydin.com","Boomerang was not able to locate this email. Please try again. If you are still unsuccessful and you don't mind sharing this email to help us improve our product, please forward it to support@baydin.com.","You've reached the maximum number of messages that can be delivered at the time that you specified. Please adjust your delivery time to be at least two minutes apart from your other messages and try again.","Invalid date.","Boomerang was not able to identify the sender of this email. One possible conflict is the Gmail Labs: Authentication icon for verified senders. If you do not have this Labs enabled, please let us know at support@baydin.com.","Boomerang encountered a problem while processing this email. Please try again. If you are still unsuccessful and you don't mind sharing this email to help us improve our product, please forward it to support@baydin.com","nag_screen_1","nag_screen_2","nag_screen_3","paywall","pro","personal","basic","none","account error","Boomerang was not able to access the Boomerang folder. Please enable IMAP and allow the Boomerang label to be shown in IMAP.","Boomerang was not able to access the Boomerang Outbox folder. Please enable IMAP and allow the Boomerang-Outbox label to be shown in IMAP.","Third party cookies must be enabled for Boomerang to work, but they are not currently enabled in your browser.<br/><br/> Please enable them, or create an exception for <strong>b4g.baydin.com</strong>. For information on how to do this, please visit the help page for your browser: <br /><a target='_blank' href='http://support.google.com/chrome/bin/answer.py?hl=en&answer=95647'>Chrome</a> | <a target='_blank' href='http://support.mozilla.org/en-US/kb/Enabling%20and%20disabling%20cookies'>Firefox</a> | <a target='_blank' href='http://docs.info.apple.com/article.html?path=Safari/5.0/en/9277.html'>Safari</a>","You have scheduled too many messages to be sent during that 24-hour period. This message was NOT scheduled. Please schedule your message to be sent at least 24 hours earlier or later. If you want to remove this limit, please upgrade to a paid plan.","premium","Boomerang doesn't support attaching Google+ Photos at this time. Please download this photo to your computer and drag-and-drop the saved copy into the email instead. Alternatively, add it as a regular attachment to the email."];var ee=0;var d0=1;var dL=12;var at=16;var b3=17;var dQ=18;var bL=19;var cX=0;function d3(ek){return ek===b3||ek===dQ||ek===bL||ek>=b4}var be=20;var b4=100;var cr=21;var bE=22;var U=23;var aP=24;var cn=25;var a5=30;var w=28;var dw=1;var c5=2;var bo=1;var bT=2;var cq="<div class='overlay' style='background:#bcbcbc; opacity:0.95; filter:alpha(opacity=95);'><img id='blue-arrow' style='position:fixed;top:50px;right:100px;visibility:hidden;' width='200px' height='266px' src='"+cu+"bluegiantarrow.gif' /><div id='dialog' style='height:auto;'><div id='title-bar'>Authenticating...</div><div class='dialog-content' style='text-align:center;'><img src='"+cu+"auth-loader.gif'/></div></div></div>";var ch="<div class='overlay' style='background:#bcbcbc; opacity:0.9; filter:alpha(opacity=9);'></div>";var da="If you did not see an authentication window, please allow pop-ups for mail.google.com. <ol><li>Click this icon in the upper right corner of your browser window: <img src='"+cu+"popupblockericon.jpg' style='padding-top:5px;padding-bottom:5px;'/> </li><li>Select <strong>\"Always allow popups from mail.google.com\"</strong>.</li><li><a href='javascript: window.location.reload()'>Refresh</a> the page, and try again.</li></ol>";var Q="<div id='error_dialog' style=''><ol><li>Do you have a pop-up blocker enabled?<br/><b>Click 'Options' or 'Preferences'</b> in the notification bar above, click on <b>'Allow pop-ups on mail.google.com'</b>, and <a href='javascript: window.location.reload()'>refresh</a>.</li> <li>Added the exception to your pop-up blocker but still getting this? <br/> <a href='http://boomeranggmail.com/faq.html#Troubleshoot'>Click here</a> to troubleshoot.</a></li></div>";var bP="<div class='overlay' style='background:#bcbcbc; opacity:0.9;filter:alpha(opacity=90);'><div id='dialog' style='height:100px'><div id='title-bar'>Logging in...</div><div class='dialog-content'> Please <a id='safari-boomerang' href='javascript:void(0)'>click here</a> so we can log you in with Boomerang.</div></div></div>";var dq="You should try Boomerang for Gmail";var bX="Hey,\r\nI thought you might like this awesome Gmail plugin I have been using.\r\n\r\nHere are some of the things you can do with Boomerang:\r\n1. Write messages now and schedule them to deliver at any time\r\n2. Schedule messages to return to your inbox at a later time\r\n3. Remind yourself to follow up on messages that don't get a response within a certain time\r\n\r\n";var c0=3;var ej=4;var I=/[a-zA-Z0-9\._+\-]+@[a-zA-Z0-9\.\-]+\.[a-z\.A-Z]+/g;function dT(ek){var el=/^[a-zA-Z0-9\._+\-]+@[a-zA-Z0-9\.\-]+\.[a-z\.A-Z]+$/;return(el.test(dU.trim(ek)))}var cl=0;var dO=0;var bJ=new Array(7);bJ[0]="Monday";bJ[1]="Tuesday";bJ[2]="Wednesday";bJ[3]="Thursday";bJ[4]="Friday";bJ[5]="Saturday";bJ[6]="Sunday";var dh=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;var dx=1;var b6=2;var aW=3;var dv="ddd, dd MMM yyyy HH:mm:ss";var a2=1;var bK=2;function t(en){bw(["nag screen","show",en]);if(ci!=="Old Safari"){if(en===b3){dc("<p style='margin: 15px;'>Hey, did you know that you’ve already scheduled more than 10 messages with Boomerang this month?</p> <a href='https://b4g.baydin.com/subscriptions' class='b4g-button green' id='signup-button' target='_blank'>Upgrade</a>",false,"Give me 1 more message!")}else{if(en===dQ){dc("<p style='margin: 15px;'>You have already scheduled beyond the 10 messages Boomerang Basic provides for free.</p> <div style='text-align:center;'><img src='"+cu+"coffecup.png' style='margin:0px auto;'/></div> <p style='margin:0 15px 15px;'>For not much more than a trip to Starbucks a month, you can schedule an unlimited number of messages and help us keep Boomerang running. We've scheduled your message anyway.</p> <a href='https://b4g.baydin.com/subscriptions' class='b4g-button green' id='signup-button' target='_blank'>Upgrade</a>",false,"Give me 1 more message!")}else{if(en===bL){dc("<p style='margin: 15px;'>You have already scheduled beyond the 10 messages Boomerang Basic provides for free.</p>  <p style='margin: 0 15px 15px 15px;'>You can get more free messages by telling others about Boomerang!</p> <span class='b4g-button green' id='multi-friend-button'>INVITE YOUR CONTACTS</span>",false,"Give me 1 more message!")}else{if(en===be){dc("<ul style='list-style-type: none;'><li><i>Our dinner's not steak and fondue</i></li><li><i>Instead it's ramen and stew</i></li><li><i>If our users don't buy</i></li><li><i>We'll starve and then die</i></li><li><i>So no more messages for you!</i></li></ul><p style='margin: 0 15px;'>You’ve hit your quota of messages for this month. Boomerang Basic provides for 10, but you’ve scheduled more than 15. <span style='color:red;'><strong>Your message was NOT scheduled.</strong></span></p><p style='margin: 5px 0 0 15px;'>Please upgrade your subscription to get unlimited message scheduling.</p> <a href='https://b4g.baydin.com/subscriptions' class='b4g-button green' id='signup-button' target='_blank' style='margin-left: 80px;'>Upgrade Subscription</a> <p style='margin: 5px 0 0 15px;'>You can also refer a friend to earn some message credits. </p><a href='https://b4g.baydin.com/refer' class=' b4g-button dialog-gray' id='refer-button' target='_blank'>Refer a friend</a>",false,"<span id='referral_confirm'>No, thanks.</span>")}else{if(en>=b4){var ek=en-b4;var eo=(ek&1)===0;var em=(ek&2)===0;var el="<div id='referral_success'></div><div id='referral_dialog'><p style='margin: 0 0 18px 0;'>Boomerang Basic provides 10 messages per month for free. You’ve already scheduled 15 this month.</p><p>It costs us money to provide Boomerang to you, so to continue scheduling messages, you can either buy a subscription, or share Boomerang with your followers and earn 25 more credits as thanks.</p> <p class='referral-share-options'><a href='https://b4g.baydin.com/subscriptions' class='b4g-button green' id='signup-button' target='_blank' href='javascript:void(0);'>Upgrade</a> <span>or</span> ";if(em){el+="<span class='referral-gplus'><g:plusone callback='b4g_plus' href='http://www.boomeranggmail.com' /></span>"}if(eo){el+="<a class='b4g-button blue' id='tweet-button' target='_blank' onclick='b4g_tweet();' href='javascript:void(0);'>Tweet Now</a>"}el+="</p></div>";dc(el,false,"<span id='referral_confirm'>No! Give me 1 more message anyway.</span>");(function(){var ep=document.createElement("script");ep.type="text/javascript";ep.async=true;ep.src="https://apis.google.com/js/plusone.js";var eq=document.getElementsByTagName("script")[0];eq.parentNode.insertBefore(ep,eq)})()}}}}}}else{if(en===b3){alert("Hey, did you know that you’ve already scheduled more than 10 messages with Boomerang this month? That's okay. We've scheduled your message anyway.")}else{if(en===dQ){alert("You have already scheduled beyond the 10 messages Boomerang Basic provides for free. For not much more than a trip to Starbucks a month, you can schedule an unlimited number of messages and help us keep Boomerang running. We've scheduled your message anyway. ")}else{if(en===bL){alert("Boomerang Basic provides 10 messages per month for free. You’ve already scheduled 15 this month. It costs us money to provide Boomerang to you, so to continue scheduling messages, please upgrade your subscription from Boomerang menu at the top right of your Gmail screen. We've scheduled your message anyway.")}else{alert("Our dinner's not steak and fondue. Instead it's ramen and stew. If our users don't buy. We'll starve and then die. So no more messages for you! You’ve hit your quota of messages for this month. Boomerang Basic provides for 10, but you’ve scheduled more than 15. Please upgrade your subscription to Boomerang Personal or Boomerang Professional. Your message was NOT scheduled. ")}}}}}var cm=document.getElementsByTagName("head")[0];function b8(el){el=el||0;var ek;if(!document.getElementById("b4g-style-css")){ek=document.createElement("link");ek.id="b4g-style-css";ek.type="text/css";ek.rel="stylesheet";ek.href=cu+"css/extensionsafestyle.css?v=2";ek.media="screen";ek.onerror=function(){var em=document.getElementById("b4g-style-css");em.parentElement.removeChild(em);if(el<10){b8(el+1)}};cm.appendChild(ek)}if(!document.getElementById("b4g-jqueryui-css")){ek=document.createElement("link");ek.id="b4g-jqueryui-css";ek.type="text/css";ek.rel="stylesheet";ek.href=cu+"css/extensionsafejqueryui.css";ek.media="screen";ek.onerror=function(){var em=document.getElementById("b4g-jqueryui-css");em.parentElement.removeChild(em);if(el<10){b8(el+1)}};cm.appendChild(ek)}}var bw=function(){console.log("b4g-track",arguments)};var aU={read:function(ek,el){setTimeout(function(){var em=bS(ek);el(null,em)},0)},write:function(ek,el,em){A(ek,el);setTimeout(function(){em(null)},0)}};var a;function ct(){a={};var en=window.location.toString();var el=en.indexOf("?");var ek=en.lastIndexOf("#");if(el<0){return}if(ek<0){ek=en.length}var em=en.substring(el+1,ek).split("&");em.forEach(function(ep){var eo=ep.indexOf("=");a[ep.substr(0,eo)]=ep.substr(eo+1)})}function ax(ek,em){var el=new XMLHttpRequest();el.open("GET",ek,true);el.onreadystatechange=function(){if(el.readyState!=4||el.status!=200){return}var en=document.createElement("script");en.text=el.responseText;document.head.appendChild(en).parentNode.removeChild(en);if(em){em()}};el.send()}var J;var p=String(document.location);if(p===top.location.toString()&&p.indexOf("ContactManager")<0&&p.indexOf("mu/mp")<0&&p.indexOf("mail-static")===-1&&window.innerWidth>1&&window.innerHeight>1&&document.body.contentEditable!=="true"&&document.body.className.indexOf("editable")===-1){ct();ax("https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js",function(){clearTimeout(J);an()});an();b8()}function an(){p=String(document.location);if(typeof window.jQuery==="undefined"&&p.indexOf("ContactManager")<0){J=setTimeout(an,500)}else{dW(0)}}function dW(ek){if(ek===0||typeof window.jQuery.ui==="undefined"){J=setTimeout(function(){dW(ek+1)},500);if(ek%10===0){ax(cu+"b4g-jquery-extensions.js?1",function(){clearTimeout(J);dW(ek+1)})}}else{dU=dN=window.jQuery.noConflict(true);window.b4g.$=dU;setTimeout(V,0);setTimeout(dd,0)}}function dd(){cW.init();ap.init()}function dA(ek,el){ek.hover(function(){var em=null;var eo=dH(dU(this).text(),el,false);switch(dU(this).text().toLowerCase()){case"tomorrow morning":case"tomorrow afternoon":var en=ed(eo,true);var ep=g(eo,true);em=en+", around "+ep;break;case"- by 5pm today":em="At a random time before 5pm today";break;case"- within 1 week":em="At a random time within 1 week";break;case"- within 1 month":em="At a random time within 1 month";break;default:em=au(eo,true)}if(em==null){em=""}dU(this).attr("title",em)},function(){dU(this).attr("title","")})}function V(){var ek=aq();if(ek!=null&&ek!==""){cs()}setInterval(cO,500);aT(function(){M({type:"is-inbox-zero"})});d();if(a.b4g_troubleshoot){cE(a.b4g_troubleshoot)}}var br=(function(){var ek=0;return function(em,el){clearTimeout(ek);ek=setTimeout(em,el)}})();function cO(){if(dU.fn.overlaps==null&&cX<5){ax(cu+"b4g-jquery-extensions.js");dU=dN;cX++}else{cX=0}p=String(document.location);if(p.indexOf("mbox")>0){bc=true}if(p.indexOf("inbox")>0){bc=false}if(!cv()){cJ()}bt=bb();if(dC()){cU();return}var el=dU(cy,bt);var ek=dU(bx,bt);var em=dU(".aDh").length>0;if(em){if(cv()){bk()}else{d9()}}if(ek.length>0){ai();if(!bz()){de()}j();bY()}dp();k()}var k=function(){var ek=dU(".D.E.G-atb");ek.each(function(){if(dU(this).css("z-index")!==3){dU(this).css("z-index",3)}})};function bY(){var ek=bb();dU(".nH .hh",ek).filter(function(){if(dU(".cZ",this).text()==="Boomerang for Gmail"){return true}}).hide()}function cs(){var ek=bS("hasSeenB4GTutorial");var el=aq();if(ek==null&&el){if(bS("b4gMenuEntries")!=null){A("hasSeenB4GTutorial","yes")}else{a7("https://b4g.baydin.com/mailcruncher/hasseentutorial?guser="+encodeURIComponent(el),co,"")}}}function co(em,ek,el){A("hasSeenB4GTutorial","yes");if(em===dw&&ci!=="Old Safari"){by()}}function cR(){var el=bb();dU(".dialogdiv").remove();var ek="<div class='dialogdiv multi-friend-content' style='display:none'><div class='multi-friend-load' style='text-align:center; padding: 20px;'><img src='https://b4g.baydin.com/site_media/bookmarklet/auth-loader.gif' style='position:absolute; top: 50px;'/></div><div class='multi-friend-main' style='display:none;'><div class='multi-friend-max-num' style='padding:8px 0 0 0; width:100%; color:#b93f24; text-align:center;font-size: 14px;display: none;'>You may send invites to up to 200 friends.</div><div style='padding: 8px 20px 0px 20px;'><input type='text' class='multi-friend-search' placeholder='Search by name, email, or company'/></div><div id='multi-friend-list'><b class='multi-friend-contacts-non-found' style='display:none;'>No contacts found.</b><div id='most-contact-container' style='display:none;'><div class='top-of-list multi-friend-list-item'><input type='checkbox' value='blank' class='multi-friend-select-all recommended-contacts' style='margin: 3px 10px 3px 0.5ex;' checked/><b>Recommended Contacts (<span class='multi-friend-most-contacted-count'></span>)</b></div><div id='multi-friend-most-contacted'></div></div><div id='all-contact-container' style='display:none;'><div class='top-of-list multi-friend-list-item'><b style='margin: 3px 10px 3px 27px;'>Other Contacts (<span class='multi-friend-contacts-count'></span>)</b></div><div id='multi-friend-contacts'></div></div></div><div class='multi-friend-lower-portion'><div class='multi-friend-credit-count' style='vertical-align: middle; padding-bottom: 15px;'><b>Message Credits Earned: <span id='multi-friend-credit-count-value'>0</span></b></div><div class='multi-friend-credit-help' style='vertical-align: middle; padding-bottom: 15px;'>You receive 1 message credit for each person you email to join Boomerang. If they download Boomerang, you will earn 10+ credits and a chance to win a Kindle Fire!</div><div><input type='button' class='b4g-button green' value='INVITE CONTACTS' id='multiInvitesSubmit' style='font-size:13px;padding: 7px 16px;margin:0 0 3px 0;'/><input type='button' class='b4g-button' value='CANCEL' id='multiInvitesCancel' style='font-size:13px;padding: 7px 16px;margin:0 0 3px 10px;'/></div></div></div></div>";dU("body",el).append(dU(ek));dU(".dialogdiv",el).dialog({resizable:false,modal:true,position:["center",75],closeOnEscape:true,width:500,dialogClass:"multi-friend",title:"Invite your contacts to Boomerang for Gmail",});dU.ajax({type:"GET",dataType:"json",position:["center",75],xhr:x,url:"https://b4g.baydin.com/getcontactslist?guser="+encodeURIComponent(ab),success:function(ep){if(ep.rec.length<=0){bw(["multi-friend-selector","error","no recommended contacts"]);dU(".multi-friend-load",el).text("It doesn't look like you have any contacts!");setTimeout(function(){dU(".dialogdiv").dialog("close")},3000);return}var eo=ep.rec.length+ep.other.length;var en=ep.rec.length;var em=ep.other.length;bi(dU("#multi-friend-most-contacted",el),ep.rec,"recommendedContactsCheck");dU(".multi-friend-most-contacted-count",el).text(ep.rec.length);dU("#most-contact-container",el).show();bi(dU("#multi-friend-contacts",el),ep.other,"otherContactsCheck");dU(".multi-friend-contacts-count",el).text(0);dU(".otherContactsCheck",el).parent().hide();dU(".multi-friend-main",el).show();dU(".multi-friend-load",el).hide();dU(".b4g-ui-dialog-titlebar-close",el).hide();dU(".multi-friend-search",el).keyup(function(es){var et=dU(".multi-friend-search",el).val().toLowerCase();if(et){var er=0;dU("#all-contact-container",el).show();dU(".top-of-list",el).hide();dU(".contact-info",el).each(function(){if(dU(this).text().toLowerCase().indexOf(et)>=0){dU(this).parent(".contact",el).show();er++}else{dU(this).parent(".contact",el).hide()}});if(!er){dU(".multi-friend-contacts-non-found",el).show()}else{dU(".multi-friend-contacts-non-found",el).hide()}}else{dU(".top-of-list",el).show();dU(".recommendedContactsCheck",el).parent().show();var eq=dU(".otherContactsCheck:checked",el);if(eq.size()>0){eq.parent().addClass("searchedAndFoundContact",el);dU(".otherContactsCheck:not(:checked)",el).parent().hide();dU(".multi-friend-contacts-count",el).text(dU(".searchedAndFoundContact",el).size());dU(".searchedAndFoundContact",el).show()}else{if(dU(".searchedAndFoundContact",el).size()<=0){dU("#all-contact-container",el).hide()}else{dU(".otherContactsCheck",el).parent().hide();dU(".searchedAndFoundContact",el).show()}}}});dU(".multiFriendCheck",el).change(function(){var eq=dU(".multiFriendCheck:checked",el).size();if(eq>=200){dU(".multiFriendCheck:not(:checked)",el).attr("disabled","disabled");dU(".multi-friend-max-num:not(:visible)",el).show();dU(".b4g-ui-dialog-title",el).text("Invite your contacts to Boomerang for Gmail ("+eq+" selected)")}else{if(eq>=190){dU(".multi-friend-max-num:not(:visible)",el).show();dU(".b4g-ui-dialog-title",el).text("Invite your contacts to Boomerang for Gmail ("+eq+" selected)")}else{if(eq===0){dU(".b4g-ui-dialog-title",el).text("Invite your contacts to Boomerang for Gmail")}else{dU(".multi-friend-max-num:visible",el).hide();dU(".multiFriendCheck:not(:checked) :disabled",el).removeAttr("disabled");dU(".b4g-ui-dialog-title",el).text("Invite your contacts to Boomerang for Gmail ("+eq+" selected)")}}}dU("#multi-friend-credit-count-value",el).text(eq)});dU(".multi-friend-select-all",el).change(function(){var eq=dU(".multiFriendCheck:checked",el).size();if(dU(this).is(":checked")){dU(".recommendedContactsCheck:not(:checked)",el).slice(0,200-eq).attr("checked","checked");dU(".multiFriendCheck",el).trigger("change");return}dU(".recommendedContactsCheck:checked",el).removeAttr("checked");dU(".multiFriendCheck",el).trigger("change")});dU(".multi-friend-select-all",el).trigger("change");dU("#multiInvitesSubmit",el).click(function(){bw(["multi-friend-selector","send emails"]);var eq=[];dU(".multiFriendCheck:checked",el).each(function(){eq.push(dU(this).val())});dR(el,eq.join(", "),dq,bX)});dU("#multiInvitesCancel",el).click(function(){bw(["multi-friend-selector","close"]);dU(".dialogdiv").dialog("close")})},error:function(eo,em,en){dU(".dialogdiv").dialog("close");if(eo.responseText==="revoked"){bw(["multi-friend-selector","error","OAuth keys revoked"]);ea(cR)}else{if(eo.responseText==="invalid email"){bw(["multi-friend-selector","error","invlaid email"]);bH("Attempt failed: Boomerang cannot identify your email. Contact support@baydin.com for help resolving the issue.")}else{bw(["multi-friend-selector","error",eo.responseText]);bH("Something went wrong. Reload the page and try again.")}}}})}function dR(ep,eo,el,ek){var en=/[a-zA-Z0-9\._+-]+@[a-zA-Z0-9\.-]+\.[a-z\.A-Z]+/g;var em=eo.toLowerCase().match(en);if(em==null){alert("Please select at least one email address.");return}document.body.style.cursor="wait";dU.ajax({url:"https://b4g.baydin.com/sendreferralemailinvitations",data:{addresses:eo,subject:el,body:ek,origin:"f1jp4fqjip"},type:"POST",xhr:x,success:function(eq){document.body.style.cursor="default";dU(".multi-friend-main",ep).hide();dU(".multi-friend-load").show().html("<h2>"+eq+"</h2>");window.setTimeout(function(){dU(".dialogdiv",ep).dialog("close")},2000)},error:function(){document.body.style.cursor="default";alert("There was an error sending out your emails. Try again.")}})}function bi(ep,eo,em){for(var el=0;el<eo.length;el++){var en="<span class='contact-info'>"+eo[el].name+" &lt;"+eo[el].email+"&gt;</span>";var ek="<div class='contact multi-friend-list-item'><input type='checkbox' value='"+eo[el].email+"' class='multiFriendCheck "+em+"'/>"+en+"</div>";ep.append(dU(ek))}}function bH(en,eq,em,el,ep){var er={Ok:{text:"OK","class":"b4g-button dialog-gray",click:function(){dU(this).dialog("destroy")}}};em=(typeof em==="undefined")?er:em;eq=(typeof eq==="undefined")?"&nbsp &nbsp Boomerang for Gmail":eq;ep=(typeof ep==="undefined")?"dialogdiv":ep;var eo;if(ci==="Old Safari"){alert(en)}else{var ek=bb();dU("."+ep).remove();eo=dU("<div class='"+ep+"' style='display:none;'>"+en+"</div>");dU("body",ek).append(eo);dU("."+ep,ek).dialog(dU.extend({title:eq,modal:true,closeOnEscape:true,buttons:em},el||{}));al()}bw(["Show dialog",en]);return eo}function n(em,en){if(ci==="Old Safari"){alert(em)}else{var el=bb();dU(".dialogdiv").remove();var ek="<div class='dialogdiv' style='display:none;'>"+em+"</div>";dU("body",el).append(dU(ek));dU(".dialogdiv",el).dialog({title:" &nbsp &nbsp   "+en,modal:true,closeOnEscape:true,width:450,buttons:{Ok:{text:"Ok","class":"b4g-button dialog-gray",click:function(){dU(this).dialog("destroy")}}}});al()}}function dc(ep,en,em){if(ci==="Old Safari"){alert(ep)}else{var el,eo=bb();dU(".dialogdiv").remove();if(em){el="<div class='dialogdiv' style='display:none;'>"+ep+"<span style='float:right; margin:0 15px 0 0;'><a class='closeLink' href='javascript:void(0)'>"+em+"</a></span></div>"}else{el="<div class='dialogdiv' style='display:none;'>"+ep+"</div>"}dU("body",eo).append(dU(el));if(ep.indexOf("INVITE YOUR CONTACTS")!==-1){dU("#multi-friend-button").click(function(){bw(["multi-friend-selector","click","nag screen"]);ea(cR)})}var ek={title:"Boomerang for Gmail",modal:true,closeOnEscape:true,width:370};if(en){ek.buttons={Ok:{text:"OK Fine!","class":"b4g-button dialog-gray",click:function(){dU(this).dialog("destroy")}}}}dU(".dialogdiv",eo).dialog(ek);dU(".closeLink").click(function(){dU(".dialogdiv").dialog("close")});al()}}function B(ek,em,el){dU.ajax({method:"get",url:ek,xhr:x,success:function(en){em(en,ek,el)}})}function ea(en){var el=aq();var ek="https://b4g.baydin.com/contacts/checklogin?guser="+el;function ep(es,eq,er){if(es!=="success"){em(eo,er)}else{en()}}function eo(et,er,es){if(et==="success"){en()}else{if(et==="cookies"){alert("Attempt failed: "+et)}else{if(ci==="Firefox"){bH(Q)}else{if(ci==="Safari"||ci==="Old Safari"){var eq=dU(bP);dU("body").append(eq);dU("#safari-boomerang").click(function(){ep(et,er,es);eq.remove()})}else{bH("Attempt failed: "+bm[et])}}}}}function em(eA,ew){var ev,er=aq();if(ci==="Chrome"){ev=dU(cq);setTimeout(eg,5000)}else{ev=dU(ch)}var eu=800;var ez=600;var ey=0;var es=0;try{ey=window.screenY+Math.max(0,Math.floor((dU(window).height()-ez)/2));es=window.screenX+Math.max(0,Math.floor((dU(window).width()-eu)/2))}catch(et){}dU("body").append(ev);var ex=window.open("https://b4g.baydin.com/contacts/login?guser="+er,"","width="+eu+",height="+ez+",location=1,status=1,resizable=1,top="+ey+",left="+es);var eq=setInterval(function(){if((!ex&&ci!=="Chrome")||ex.closed){ev.remove();clearInterval(eq);if(ci.indexOf("Safari")===-1&&ci.indexOf("Firefox")===-1){B("https://b4g.baydin.com/contacts/checklogin?guser="+er+"&hasAlreadyAuthenticated=True",eA,ew)}else{B("https://b4g.baydin.com/contacts/checklogin?guser="+er,eA,ew)}}},100)}B(ek,ep,"")}function al(){var ek=bb();if(ci==="Chrome"){dU(".dialogdiv a",ek).click(function(){var el=dU(this).attr("href");if(el.indexOf("javascript")===-1){window.open(el,"_blank")}})}}function u(ek){bw(["welcome dialog","show",ek]);var el="";var en="";switch(ek){case 1:el="<div id='wc_screen'> <div class='wc_header'>Thank you for installing Boomerang.</div> <div class='wc_text'>Let's take you on a tour of Boomerang features inside Gmail.</div> <div class='wc_img'><div style='margin-top: 15px; margin-bottom: 5px;'><span style='margin-left: 100px;'><strong>Return messages to inbox</strong></span><span style='margin-left:100px;'><strong>Schedule messages</strong></span></div><img class='wc_screenshot' width='475px' style='margin-left: 70px;' src='"+cu+"1_ftuepic.png' /></div><div class='wc_pg_no'>1 of 5 <span class='startButton b4g-button red'>START</span><a class='skipButton b4g-button' href='javascript:void(0)'>SKIP</a> </div></div>";en="This feature is available in Safari versions 5.1 and higher. Please update Safari to use this feature.";break;case 2:el="<div id='wc_screen'> <div class='wc_header'>Boomerang</div> <div class='wc_text'>Bring a message back to your inbox when you want it.</div> <div class='wc_img'><p class='wc_img_header'>Clicking on the Boomerang button will allow you to specify the time you want the message back in your inbox.</p><div align='center'><img class='wc_screenshot' height='106px' src='"+cu+"2_boomerangbutton.png' /></div><br/> <a class='wc_video_link' href='http://www.youtube.com/watch?v=XU1iRwqJC1U' target='_blank'><img src='"+cu+"playbutton.png' style='position:relative; top:3px;'> Watch a video to learn more.</a></div><div class='wc_pg_no'>2 of 5 <span class='previousButton b4g-button'>BACK</span><span class='nextButton b4g-button green'>NEXT</span><a class='skipButton b4g-button' href='javascript:void(0)'>SKIP</a> </div></div>";break;case 3:el="<div id='wc_screen'> <div class='wc_header'>Send Later</div> <div class='wc_text'>Schedule a message to be sent anytime as long as it's in the future.</div> <div class='wc_img'><p class='wc_img_header'>Write a message in Gmail like you always do and then click Send Later menu to specify the time you want it sent. You don’t need to do anything else, we will handle the rest.</p><div align='center'><img class='wc_screenshot' height='160px' src='"+cu+"3_sendlater.jpg' /></div><a class='wc_video_link' href='http://www.youtube.com/watch?v=abqz45EN98w' target='_blank'><img src='"+cu+"playbutton.png' style='position:relative; top:3px;'> Watch a video to learn more.</a></div><div class='wc_pg_no'>3 of 5 <span class='previousButton b4g-button'>BACK</span><span class='nextButton b4g-button green'>NEXT</span><a class='skipButton b4g-button' href='javascript:void(0)'>SKIP</a> </div></div>";break;case 4:el="<div id='wc_screen'> <div class='wc_header'>Manage Scheduled Messages</div> <div class='wc_text'>View, reschedule or cancel scheduled messages all in one place.</div> <div class='wc_img'><p class='wc_img_header'>Open the Boomerang  menu on the top right of Gmail screen. and click on  the Manage scheduled messages option. There, you will be able to see the list of all scheduled messages and reschedule or cancel them if you change your mind. You can also set your preferences for Booomerang.</p><div align='center'><img class='wc_screenshot' width='253px' src='"+cu+"4_manage.jpg' /></div><br/><a class='wc_video_link' href='http://www.youtube.com/watch?v=_gWiqyVYOrc' target='_blank'><img src='"+cu+"playbutton.png' style='position:relative; top:3px;'> Watch a video to learn more.</a></div><div class='wc_pg_no'>4 of 5 <span class='previousButton b4g-button'>BACK</span><span class='nextButton b4g-button green'>NEXT</span><a class='skipButton b4g-button' href='javascript:void(0)'>SKIP</a> </div></div>";break;case 5:el="<div id='wc_screen'><div class='wc_header'>More Advanced Features</div><div class='wc_text'>Boomerang includes a few more features that can help you with your Inbox management.</div><div class='wc_img' ><ul><li><span class='wc_text'><strong>Response Tracking</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=IfqOJV_3uqI' target='_blank'><img src='"+cu+"playbutton.png' style='position:relative; top:3px;'></a><br/><span class='wc_img_header'>Track responses to any email you send or receive and get a reminder if you don't get a reply</span></li><br/><li><span class='wc_text'><strong>Recurring Messages</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=_2BlqvRmi-s' target='_blank'><img src='"+cu+"playbutton.png' style='position:relative; top:3px;'></a><br/><span>Write an email and send it every day, week, month or any interval you choose</span></li><br/><li><span class='wc_text'><strong>Notes</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=uwNoNCUBP4M' target='_blank'><img src='"+cu+"playbutton.png' style='position:relative; top:3px;'></a><br/><span class='wc_img_header'>Add notes to your Boomerang'ed messages</span></li><br/><li><span class='wc_text'><strong>Boomerang Mobile</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=MUZppQm08LM' target='_blank'><img src='"+cu+"playbutton.png' style='position:relative; top:3px;'></a><br/><span class='wc_img_header'>Schedule messages on the go on any smart phone or tablet</span></li><br/><li><span class='wc_text'><strong>Read Receipts</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=YJiMO1weJhA' target='_blank'><img src='"+cu+"playbutton.png' style='position:relative; top:3px;'></a><br/><span class='wc_img_header'>Receive a notification about whether an email is opened or if links in the email are clicked.</span></li></ul></div><div class='wc_pg_no'>5 of 5<span class='previousButton b4g-button last'>BACK</span><a class='skipButton b4g-button green' href='javascript:void(0)'>FINISH</a></div></div></div>";break}if(ci==="Old Safari"){alert(en)}else{bt=bb();dU(".dialogdiv").remove();var em="<div class='dialogdiv' style='display:none;'>"+el+"</div>";dU("body",bt).append(dU(em));dU(".dialogdiv",bt).dialog({modal:true,closeOnEscape:true,width:770,dialogClass:"welcomeDialog"});dU(".startButton").click(function(){u(2)});dU(".skipButton").click(function(){dU(".dialogdiv").dialog("close")});dU(".nextButton").click(function(){u(ek+1)});dU(".previousButton").click(function(){u(ek-1)});al()}}function bs(){var em=bS("b4gshowcardexpired")==="true";var ek=Date.parse(bS("b4gshowcardexpiredafter"))||Date.today().addDays(-4);var el=Date.parse(bS("b4glastcheckedbillingstatusdate")||Date.today().addDays(-365));if(em&&(Date.compare(Date.today(),ek)>-1)){bu()}else{if(Date.compare(Date.today(),Date.parse(el).addDays(5))>-1){bu()}}}function bu(){function el(){var eo=new Date(2013,3,17);var em=new Date();var en=(em-eo)/(24*60*60*1000);var ep=en/5;return ep>Math.random()}if(!el()){return}a7("https://b4g.baydin.com/mailcruncher/checkbillinginfo?guser="+aq(),function ek(eo,en,ep){var em=eo;A("b4glastcheckedbillingstatusdate",Date.today().toString(dv));if(em===aW){O();A("b4gshowcardexpired",true)}else{if(em===b6){A("b4gshowcardexpired",false)}else{A("b4gshowcardexpired",false)}}})}function O(){var em=bb();var el=aq();var ek=dU("<div class='b4g_card_expired_bar'><div>Your credit card payment for Boomerang was declined. <strong>Please update your billing information.</strong></div> <div style='height: 50px; line-height: 50px;'><a class='b4g-button red' id='b4g_card_expired_fix' style='display: inline; margin:0px;' target='_blank' href='https://b4g.baydin.com/fixexpiredbilling?guser="+encodeURIComponent(el)+"'>FIX THIS</a><a id='billing_expired_snooze'>Remind me later</a><a id='billing_expired_downgrade' style='text-decoration: none;' target='_blank' href='https://b4g.baydin.com/cancelsubscription?guser="+encodeURIComponent(el)+"'>Cancel my subscription</a></div></div>");ek.css({padding:"20px 0px 10px 0px",color:"#555",background:"#FFF1A8",border:"1px solid #EEE","text-align":"center"});if(dU(".b4g_card_expired_bar",em).length===0){dU(".aiw",em).find(".nH").first().show().append(ek)}dU("#billing_expired_snooze",em).click(function(){ek.hide();A("b4gshowcardexpiredafter",Date.today().addDays(3).toString(dv));A("b4gshowcardexpired",true);bw(["credit card expiration","clicked_RemindLater"])});dU("#b4g_card_expired_fix",em).click(function(){ek.hide();A("b4gshowcardexpired",true);A("b4gshowcardexpiredafter",Date.today().addDays(3).toString(dv));bw(["credit card expiration","clicked_FixThis"])});dU("#billing_expired_downgrade",em).click(function(){ek.hide();A("b4gshowcardexpired",false);bw(["credit card expiration","clicked_CancelMySubscription"])});bw(["credit card expiration","show"])}function aD(){var em=bb();var el=aq();var ek=bS("b4gshowcoupon")==="true";var eo=Date.parse(bS("b4glastcheckedcouponstatusdate")||Date.today().addDays(-365));if(ek){cb()}else{if(Date.compare(Date.today(),Date.parse(eo).addDays(2))>-1){a7("https://b4g.baydin.com/mailcruncher/checkcouponstatus?guser="+el,function en(eq,ep,er){A("b4glastcheckedcouponstatusdate",Date.today().toString(dv));var es=eq;if(es===a2){A("b4gshowcoupon",true);cb()}})}}}function cb(){var el=bb();var ek=aq();var em=dU("<div class='b4g_coupon_bar'><div style='text-align:right; padding:5px; height:0px;'><span style='text-align:right; cursor:pointer; padding:10px; font-size:1.3em;' class='b4g_coupon_dismiss_forever'>x</span></div><div style='display:inline-block;'><img src='"+cu+"bts_image.png' style='position:relative; top:2px; margin-right:20px'/></div><div style='display:inline-block; text-align:center;'><div style='margin:2px'><strong>Today only! Save 30% off your first year of Boomerang.</strong>*</div><div style='margin:2px'><strong>Use coupon \"back2school\"</strong></div><div><a style='margin-top: 10px;' class='b4g-button green' id='b4g_coupon_buy' href='javascript:void(0)'>SUBSCRIBE NOW</a> <a style='color: #999;' class='b4g_coupon_dismiss_forever' href='javascript:void(0)'>No thank you. Please go away.</a></div><p style='color: #999;margin:0px; font-size:.7em;'>*New individual subscribers only. Discount applies the first year only.</p></div></div>");em.css({color:"rgb(249,249,249)",background:"#34383b",padding:"0px","text-align":"center",});if(dU(".b4g_coupon_bar",el).length===0){dU(".aiw",el).find(".nH").first().show().append(em);dU("#b4g_coupon_buy",el).click(function(){A("b4gshowcoupon",false);window.open("https://b4g.baydin.com/subscriptions","_blank");b4g_send_image_request("https://b4g.baydin.com/mailcruncher/clearcouponstatus?guser="+ek,function(){},"success");bw(["coupon notification","clicked_buy"])});dU(".b4g_coupon_dismiss_forever",el).click(function(){em.hide();b4g_send_image_request("https://b4g.baydin.com/mailcruncher/clearcouponstatus?guser="+ek,function(){},"success");A("b4gshowcoupon",false);bw(["coupon notification","clicked_dismiss"])})}bw(["coupon notification","show"])}function ak(en,el){if(!el){el=bb()}var em="";var ek=dU("[name='"+en+"']",el);ek.each(function(){em+=dU(this).val()+" "});return(!em?"":o(em))}function y(){var el=bb();dU(".dialogdiv").remove();var ek=ds();dU("body",el).append(dU(ek));bU();dU(".dialogdiv",el).dialog({modal:true,closeOnEscape:true,width:500,title:"Boomerang Settings",buttons:{Ok:{text:"OK",style:"padding: 5px 20px;","class":"b4g-button by-button by-button-secondary",click:function(){if(bF(dU(this))){dU(this).dialog("destroy")}}},Cancel:{text:"Cancel",style:"padding: 5px 20px;","class":"b4g-button dialog-gray by-button",click:function(){dU(this).dialog("destroy")}}}});al();dU(".dialogdiv .b4g_settings_dialog").hide();dU(".dialogdiv .b4g_settings_shortcuts_question").click(function(em){dU(this).next("ul").toggle();bw(["keyboard-shortcuts-explanation","toggle"])});dU.ajax({method:"get",url:"https://b4g.baydin.com/getpreferences/",xhr:function(){var em=dU.ajaxSettings.xhr();em.withCredentials=true;return em},success:function(et){if(!et){bw(["Settings Dialog","failed launch"]);dU(".dialogdiv").remove();bH("<p>There seems to be an issue with your login credentials. Try visiting the <a href='https://b4g.baydin.com/settings'>manage page</a> to adjust your settings.</p>");return}var eu=(et.unread?"checked":"");var eo=(et.starred?"checked":"");var en=(et.topInbox?"checked":"");var ev=(et.labelled?"checked":"");var eA=(et.onSendSetting?"checked":"");var ep=(et.onSendOffset==null)?"1_weeks":et.onSendOffset;var em=(et.onSendCond==null)?"reply":et.onSendCond;var ez=(et.readReceipts?"checked":"");var eq=(et.plan==="premium"?true:false);dU("#unread",el).attr("checked",eu);dU("#starred",el).attr("checked",eo);dU("#topinbox",el).attr("checked",en);dU("#labelled",el).attr("checked",ev);dU("#keyboard-shortcuts",el).attr("checked",ap.is_enabled());bw(["Settings Dialog","successful launch"]);if(eq){dU(".b4g_settings_premium_link",el).hide();dU(".b4g_premium-text-disabled",el).removeClass(".b4g_premium-text-disabled").css("color","#333");dU(".b4g_send_condition_settings_box",el).show();dU("#b4g_send_check",el).attr("checked",eA);dU("[name=ifResponseSettingCond]",el).val(em);dU("#b4g_read_receipt_check",el).attr("checked",ez);var es=ep.split("_");dU("[name=ifResponseSettingNum]",el).val(es[0]);dU("[name=ifResponseSettingUnit]",el).val(es[1]);if(eA!=="checked"){dU(".pref-select",el).attr("disabled","disabled").removeClass("b4g-enabled-pref").addClass("b4g-disabled-pref");dU(".b4g_send_condition_value_settings_box",el).addClass("b4g-disabled-send-condition")}dU("#b4g_crm_enabled").click(function(){if(dU(this).is(":checked")){dU(".b4g_crm_hide_if_disabled").show()}else{dU(".b4g_crm_hide_if_disabled").hide()}});if(et.crm.active){dU("#b4g_crm_enabled").attr("checked",true);dU(".b4g_crm_hide_if_disabled").show()}var eC=et.crm.bccAddress;dU("#b4g_bccAddress").val(eC);dU("#b4g_bccAddressDisplay").text(eC);var ex=et.crm.crm;dU("#b4g_crm_select").val(ex);var er=et.crm.bccIncludeWith;dU(".b4g_crm_include_with[value="+er+"]").attr("checked",true);var ew=function(){dU("#b4g_bccAddress").show().select();dU("#b4g_bccAddressDisplay").hide();dU("#b4g_edit_link").hide();dU("#b4g_save_link").show()};var ey=function(){dU("#b4g_bccAddress").hide();dU("#b4g_bccAddressDisplay").show();dU("#b4g_edit_link").show();dU("#b4g_save_link").hide();var eD=dU("#b4g_bccAddress").val();if(dT(eD)){dU("#b4g_bccAddressDisplay").text(eD);return true}else{ew();console.log(eD);alert("Please enter a valid email address.");return false}};if(dU.trim(eC).length>0){ey()}else{ew()}dU("#b4g_edit_link").click(ew);dU("#b4g_save_link").click(ey);var eB=function(){var eE=dU("#b4g_crm_select").val();var eD=dU("#b4g_bccAddress");switch(eE){case"salesforce":eD.attr("placeholder","example@salesforce.com");break;case"highrise":eD.attr("placeholder","dropbox@12345678.highrisehq.com");break;case"insightly":eD.attr("placeholder","example@mailbox.insight.ly");break;case"capsule":eD.attr("placeholder","dropbox@12345678.example.capsulecrm.com");break;case"sugar":eD.attr("placeholder","example@sugarondemand.com");break;case"pipedrive":eD.attr("placeholder","12345@dropbox.pipedrive.com");break;case"zoho":eD.attr("placeholder","example@emails.zohocrm.com");break;default:eD.attr("placeholder","example@example.com");break}};eB();dU("#b4g_crm_select").change(eB)}else{dU(".b4g_send_condition_settings_box",el).show();dU(".pref-select",el).attr("disabled","disabled").removeClass("b4g-enabled-pref").addClass("b4g-disabled-pref");dU("#b4g_send_check",el).attr("disabled","disabled");dU("#b4g_read_receipt_check",el).attr("disabled","disabled");dU("#b4g_crm_enabled",el).attr("disabled","disabled");dU(".b4g_send_condition_settings_box",el).addClass("b4g-disabled-send-condition")}dU(".b4g_settings_loading",el).hide();dU(".b4g_settings_dialog",el).show();dU(".pref",el).change(function(){if(this===dU("#unread",el).get(0)&&this.checked==0){dU("#topinbox",el).get(0).checked=0}else{if(this===dU("#topinbox").get(0)&&this.checked==1){dU("#unread").get(0).checked=1}}if(eq){if(this===dU("#b4g_send_check_cond").get(0)){if(dU(this).val()==="no open"){dU("#b4g_read_receipt_check").attr("checked","checked")}}else{if(this===dU("#b4g_read_receipt_check").get(0)){if(!dU(this).is(":checked")&&dU("#b4g_send_check_cond").val()==="no open"){dU("#b4g_send_check_cond").val("always")}}}if(dU("#b4g_send_check",el).get(0).checked){dU(".pref-select",el).removeAttr("disabled").removeClass("b4g-disabled-pref").addClass("b4g-enabled-pref");dU(".b4g_send_condition_value_settings_box",el).removeClass("b4g-disabled-send-condition")}else{dU(".pref-select",el).attr("disabled","disabled").removeClass("b4g-enabled-pref").addClass("b4g-disabled-pref");dU(".b4g_send_condition_value_settings_box",el).addClass("b4g-disabled-send-condition")}}})},error:function(){window.open("https://b4g.baydin.com/settings","_blank");dU(".dialogdiv").remove();bw(["dev-CORS","failure","XHR-failure"])},dataType:"json"})}function ds(){return"<div class='dialogdiv' style='display:none; margin: 3px; color: #333'><div class='b4g_settings_loading' style='margin: 20px 0; font-size: 24px; width: %100; text-align: center;'>Loading...</div><div class='b4g_settings_dialog' style='font-size: 13px;'><div class='b4g_send_condition_settings_box'><div style='margin: 2px 0 0 0;'><h3 style='margin: 0 0 10px 0;'>When messages are returned, they should be:</h3><div class='bullet_text' style='margin:10px 0 0 0;'><input type='checkbox' class='pref' id='unread' style='margin: 4px 0;vertical-align: middle;'> <label for='unread' style='vertical-align: middle;'>Marked as unread</label><br/><input type='checkbox' class='pref' id='starred' style='margin: 4px 0;vertical-align: middle;'> <label for='starred' style='vertical-align: middle;'>Starred</label> <br/><input type='checkbox' class='pref' id='topinbox' style='margin: 4px 0;vertical-align: middle;'> <label for='topinbox' style='vertical-align: middle;'>At the top of your inbox</label><br/><input type='checkbox' class='pref' id='labelled' style='margin: 4px 0;vertical-align: middle;'> <label for='labelled' style='vertical-align: middle;'>Labeled as 'Boomerang-Returned'</label> <br/></div></div><div style='margin: 15px 0'><input type='checkbox' class='pref' id='keyboard-shortcuts' style='margin: 4px 0;vertical-align: middle;'> <label style='vertical-align: middle;' for='keyboard-shortcuts'>Enable keyboard shortcuts</label> <img src='"+cu+"questionmark.png' class='b4g_settings_shortcuts_question' style='cursor:pointer; width:14px; height:14px; vertical-align:middle;'><ul style='display:none; padding-left: 35px; margin-top: 5px;'><li>Press <strong>b</strong> to open the Boomerang menu</li><li>Press <strong>Ctrl/Cmd + s</strong> to open the send later menu (while you are composing a message)</li><li>Use the arrow keys, space bar, and enter to navigate inside the menus.</li></ul></div><div class='bullet_text'><h3 style='margin: 0 0 10px 0;'>Premium Settings</h3><div class='b4g_settings_premium_link' style='margin-bottom:5px;'><a href='https://b4g.baydin.com/subscriptions?utm_source=b4g&utm_medium=settings&utm_campaign=settingslink'>Upgrade to the Premium plan to enable these features.</a></div><div class='b4g_premium-text-disabled' style='color: #999;'><input type='checkbox' class='pref pref-check' id='b4g_read_receipt_check' style='margin: 4px 0;vertical-align: middle;'> <label for='b4g_read_receipt_check' style='vertical-align: middle;'>Request a read receipt for every email I send</label><br/><input type='checkbox' class='pref pref-check' id='b4g_send_check' style='margin: 4px 0;vertical-align: middle;'> <label for='b4g_send_check' style='vertical-align: middle;'>Enable Boomerang for every email I send:</label> <div class='b4g_send_condition_value_settings_box' style='margin-top:5px;'><span style='margin:8px 9px 8px 18px; color:#777;'>Remind me</span><span class='' style='height: 20px; top: 3px; margin: 0 0 6px 10px; padding: 1px 0px;'><select name='ifResponseSettingNum' id='b4g_send_check_num' class='b4g-enabled-pref pref pref-select' style=''><option value='1'>1</option><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='11'>11</option><option value='12'>12</option><option value='13'>13</option><option value='14'>14</option><option value='15'>15</option><option value='16'>16</option><option value='17'>17</option><option value='18'>18</option><option value='19'>19</option><option value='20'>20</option><option value='21'>21</option><option value='22'>22</option><option value='23'>23</option><option value='24'>24</option><option value='25'>25</option><option value='26'>26</option><option value='27'>27</option><option value='28'>28</option><option value='29'>29</option><option value='30'>30</option><option value='31'>31</option></select></span><span class='' style='height: 20px; top: 3px; margin: 0 0 6px 4px; padding: 1px 0px;'><select name='ifResponseSettingUnit' id='b4g_send_check_unit' class='b4g-enabled-pref pref pref-select' style=''><option value='hours'>hours</option><option value='days'>days</option><option value='weeks'>weeks</option><option value='months'>months</option></select></span><span style='margin:8px 7px 8px 8px; color:#777;'>after sending</span><span class='' style='height: 20px; top: 3px; margin: 0 0 6px 4px; padding: 1px 0px;'><select name='ifResponseSettingCond' id='b4g_send_check_cond' class='b4g-enabled-pref pref pref-select' style=''><option value='no reply'>if no reply</option><option value='no open'>if not opened</option><option value='always'>regardless</option></select></span></div></div><div class='b4g_premium-text-disabled' style='color: #999;margin-top:10px;'><input type='checkbox' id='b4g_crm_enabled' class='pref' style='vertical-align: middle;'> <label style='vertical-align: middle;' for='b4g_crm_enabled'>Enable CRM Integration</label><br/><div class='b4g_crm_hide_if_disabled' style='display:none;'><div style='clear:both; margin-top:10px; color:#777;'><span style='margin:3px 0px 12px 18px; width:120px; float:left; color:#777;' >Select CRM</span> <select id='b4g_crm_select' class='pref' style='float:left;'><option value='salesforce'>Salesforce</option><option value='highrise'>Highrise</option><option value='insightly'>Insightly</option><option value='capsule'>Capsule</option><option value='sugar'>Sugar</option><option value='pipedrive'>Pipedrive</option><option value='zoho'>Zoho</option><option value='other'>Other</option></select></div><div style='clear:both; color:#777;'><span style='margin:3px 0px 12px 18px; width:120px; float:left; color:#777;' >Bcc Address <img src='https://s3.amazonaws.com/BoomerangForGmail/bookmarklet/questionmark.png' class='b4g_settings_bccaddress_question' style='margin-right: 5px; cursor:pointer; width:14px; height:14px; vertical-align:middle;'></span> <input id='b4g_bccAddress' class='' placeholder='example@salesforce.com' type='text' style='float:left;width:250px; margin-left:0px; padding-left:4px;'><span id='b4g_bccAddressDisplay' style='margin:3px 0px 12px 2px; float:left;'></span><a id='b4g_edit_link' href='javascript:void(0);' style='margin:3px 0px 12px 15px; float:left;'>Edit</a><a id='b4g_save_link' href='javascript:void(0);' style='margin:3px 0px 12px 15px; float:left;'>Save</a></div><div style='clear:both; color:#777;'><span style='margin:0px 2px 0px 18px; width:120px; float:left; color:#777;' >Include with</span> <input style='margin-left: 0px; margin-right: 2px; vertical-align:middle;' class='pref b4g_crm_include_with' type='radio' id='b4g_crm_include_with_every' name='b4g_crm_include_with' value='every'/><label for='b4g_crm_include_with_every'>every email I send</label></div><div style='clear:both; margin-top: 5px; color:#777;'><span style='margin:3px 2px 0px 18px; width:120px; float:left;' ></span> <input style='margin-left: 0px; margin-right: 2px; vertical-align:middle;' class='pref b4g_crm_include_with' type='radio' id='b4g_crm_include_with_boomerang' name='b4g_crm_include_with' value='boomerang' /><label for='b4g_crm_include_with_boomerang'>only emails I Boomerang when sending</label></div></div></div></div></div></div></div>"}function bU(){dU(".b4g_settings_bccaddress_question").click(function(){var en=dU("#b4g_crm_select").val();var em="<p style='margin-left:20px;'>Enter the email address that your CRM provides.</p>";var el="Other";switch(en){case"salesforce":el="How to Find the Bcc Address for Salesforce";em="<p><strong>How to activate:</strong></p><ol>   <li>Find where it says 'Setup' in the upper right corner and select this option.</li>   <li>In the left menu bar, select 'Email Administration'. </li>   <li>Select the 'Email to Salesforce' tab.</li>   <li>Edit the settings and select the box to activate this feature.</li></ol><p><strong>How to find your Bcc address:</strong></p> <ol>   <li>Find your user name at the upper right corner and select the drop down bar.</li>   <li>Select 'My Settings'.</li>   <li>Select the Email tab under 'My Settings'</li>   <li>Select the 'My Email to Salesforce Tab' (this does not exist until you activate the feature).</li>   <li>You will see your email to salesforce address highlighted.</li></ol>";break;case"highrise":el="How to Find the Bcc Address for Highrise";em="<ol>   <li>Log into your Highrise account.</li>   <li>Find 'Account and Settings' and select the drop down bar.</li>   <li>Select 'My Info' from the drop down list.</li>   <li>You will see your BCC email address displayed under '<strong>Your Personal Email Dropbox</strong>'.</li></ol>";break;case"insightly":el="How to Find the Bcc Address for Insightly";em="<ol>   <li>Log into your Insightly account.</li>   <li>Select 'Emails' from the menu bar on the left.</li>   <li>You will see your BCC email address displayed there.</li></ol>";break;case"capsule":el="How to Find the Bcc Address for Capsule";em="<ol>   <li>Log into your Capsule account.</li>   <li>Select 'User' and then 'My Preferences' in the Capsule navigation bar.</li>   <li>You will see your BCC email address under <strong>'Mail Drop Box'</strong>.</li></ol>";break;case"sugar":el="How to Find the Bcc Address for Sugar";em="<p><strong>To activate Sugar Email Archiving for your instance, you must be the admin or request your account admin to follow the steps below:</strong></p><ol>   <li>Log into Sugar CRM.</li>   <li>Navigate to Admin > Email Archiving.</li>   <li>Read and agree to the privacy agreement.</li>   <li>Click <strong>'Enable Email Archiving'</strong>.</li>   <li>Then you will see your BCC address in the field 'Email Archiving Address'.</li></ol>";break;case"pipedrive":el="How to Find the Bcc Address for Pipedrive";em="<ol>   <li>Log into Pipedrive CRM.</li>   <li>Go to your Personal Settings.</li>   <li>Select the section named 'Email drop-box'.</li>   <li>Click the radio button 'Enabled' next to Dropbox status.</li>   <li>You will find your BCC address in the 'Your dropbox address' field.</li>   <li>Enter your email address in the box below and click 'Save changes'.</li></ol>";break;case"zoho":el="How to Find the Bcc Address for Zoho";em="<p>To activate BCC Dropbox in Zoho:</p><ol>   <li>Log into your Zoho account.</li>   <li>Click <strong>Setup > Users &amp; Permissions > Profiles</strong>.</li>   <li>In the <em>Profiles</em> page, click the <strong>Edit</strong> link corresponding to the profile that you want to edit.</li>   <li>From the list of profiles, select the <strong>BCC Dropbox</strong> check box under <em>General Permissions</em>.</li>   <li>Click <strong>Save</strong>.</li></ol><p>The BCC Dropbox email address will be available in Zoho CRM under <strong>Setup > Personal Settings >BCCDropbox.</strong></p><p>Note: This feature in Zoho is only available to the users on Professional and Enterprise plans.</p>";break;default:break}var ek=em;if(en!=="other"){ek="<div class='dialogdiv'>"+ek+"<p><img style='vertical-align:middle;' src='"+cu+"email.png'/><a id='emailme' href='javascript:void(0)' style='vertical-align:middle;'>Email me these instructions</a></p></div>"}bH(ek,el,undefined,{width:500},"crmhelp");dU("#emailme").click(function(){var eo="https://b4g.baydin.com/mailcruncher/sendcrmreminder?instructions="+encodeURIComponent(em)+"&subject="+el;a7(eo,dU.noop());dU(this).replaceWith("<span style='vertical-align:middle;'>Instructions sent!</span>")})})}function af(eq){var em=bb();if(ci==="Old Safari"){alert("This feature is available in Safari versions 5.1 and higher. Please update Safari to use this feature.")}else{if(!eq){var ep=ak("to");var eo=ak("cc");var el=ak("bcc");if(!ep&&!eo&&!el){bH("Please enter a recipient.");return}}dU(".dialogdiv").remove();var en=dU("<div class='dialogdiv' style='display:none;'><div id='recurring_dialog'><div id='start_date_time' class='recurring_field'><span class='recurring-row-title'>Starts</span><span id='start_date' class='recurring_right_col'><input id='start_date_input' type='text' name='starts' size='15'/><span id='start_time'>Send Time: <input id='start_time_input' name='time' size='10'/></span></span></div><div  class='recurring_field'><span class='recurring-row-title'>Repeats</span><select id='frequency'  class='recurring_right_col'><option value='day'> Daily</option><option value='week' selected='selected'>Weekly</option><option value='weekday' >Every Weekday</option><option value='month' >Monthly</option><option value='year'>Yearly</option></select></div><div id='num_time_interval'  class='recurring_field'><span class='recurring-row-title'>Every</span><span class='recurring_right_col'><input type='number' value='1' min='1' max='12' name='num_interval' id='num_interval'/><span id='interval'> week</span></span></div><div id='days_of_week'  class='recurring_field'><span class='recurring-row-title'>On</span><span class='recurring_right_col' style='vertical-align: top;'><input class='day_cb' type='checkbox' value='6' name='Sun' style='margin-left:0px'/> Sun<input class='day_cb' type='checkbox' value='0' name='Mon'/> Mon<input class='day_cb' type='checkbox' value='1' name='Tue'/> Tue<input class='day_cb' type='checkbox' value='2' name='Wed'/> Wed<input class='day_cb' type='checkbox' value='3' name='Thur'/> Thur<input class='day_cb' type='checkbox' value='4' name='Fri'/> Fri<input class='day_cb' type='checkbox' value='5' name='Sat'/> Sat</span></div><div  class='recurring_field'><span class='recurring-row-title'> Ends </span><div class='recurring_right_col' style='display:inline-block;vertical-align: middle; line-height: 24px;'><div style='margin-bottom:3px;'><input type='radio' id='radio_num_occurences' name='end_group' checked/> After <input type='number' value='10' min='1' max='100' id='num_occurences' name='num_occurences'/> messages</div><div style='margin-bottom:3px;'><input type='radio' id='radio_end_date' name='end_group'/> On <input id='end_date' value='' name='end_date' size='15'/></div><div style='margin-bottom:3px;'><input type='radio' id='radio_no_end' name='end_group'/> No end date <br/></div></div></div><br/><br/><br/><br/><div id='summary' class='recurring_field'><span class='recurring-row-title'>Summary:</span><div id='recurring_feedback' class='recurring_right_col' style='display:inline-block;padding-right:20px;'> </div></div><div class='b4g-button-container' align='center'><button id='schedule_recurring' class='b4g-button red' style='margin:4px 10px;'> Schedule </button><button id='cancel_recurring' class='b4g-button dialog-gray' style='margin:4px 10px;'>Cancel</button></div><br/></div></div>");dU("body",em).append(en);dU(".dialogdiv",em).dialog({modal:true,title:"Schedule Recurring Message",closeOnEscape:true,width:530,dialogClass:"recurringDialog"});dU(".dialogdiv",em).css({padding:"0px"});dU("#start_date_input",em).datepicker({showOn:"button",buttonImage:cu+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,defaultDate:0,minDate:0,});dU("#end_date",em).datepicker({showOn:"button",buttonImage:cu+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,defaultDate:0,minDate:0,onClose:function(es,er){dU("#radio_end_date").attr("checked",true)},});dU(".b4g-ui-datepicker-trigger",em).css({cursor:"pointer",margin:"-2px 0px 0px -25px"}).hover(function(){dU(this).css("box-shadow","0px 0px 3px #aaa");dU(this).css("-moz-box-shadow","0px 0px 3px #aaa")},function(){dU(this).css("box-shadow","none");dU(this).css("-moz-box-shadow","none")});a4();dU("#schedule_recurring").click(function(){(eq||schedule_recurring)()});dU("#cancel_recurring").click(function(){dU(".dialogdiv").dialog("close")});var ek=new Date().addMinutes(10);dU("#start_date_input").val(ek.toString("MM/dd/yy"));dU("#start_time_input").val(ek.toString("hh:mm tt"));return en}}function b9(ek){return ek.replace("6","x").replace("5","6").replace("4","5").replace("3","4").replace("2","3").replace("1","2").replace("0","1").replace("x","0")}function c(ek){return ek.replace("0","x").replace("1","0").replace("2","1").replace("3","2").replace("4","3").replace("5","4").replace("6","5").replace("x","6")}function d2(){var ek=dU("#frequency").val();switch(ek){case"day":ek="DAILY";break;case"week":ek="WEEKLY";break;case"weekday":ek="WEEKLY";break;case"month":ek="MONTHLY";break;case"YEARLY":ek="YEARLY";break;default:ek="YEARLY";break}return ek}function ck(en){var em=dU(".day_cb:checked").map(function(eo,ep){return dU(ep).val()}).get();var ek="";for(var el=0;el<em.length;el++){if(ek===""){ek+="("+em[el]}else{ek+=","+em[el]}}if(ek!==""){ek+=")"}if(en.getUTCDay()>en.getDay()||(en.getUTCDay()===0&&en.getDay()===6)){ek=b9(ek)}else{if(en.getUTCDay()<en.getDay()||(en.getUTCDay()===6&&en.getDay()===0)){ek=c(ek)}}return ek}function dV(){aX();var em="";try{var es=d2();var en=dU("#num_interval").val();var eu=dU("#start_date_input").val()+" "+dU("#start_time_input").val();var el=Date.parse(eu);var eo=el.getUTCMinutes();var er=el.getUTCHours();var et=el.getUTCDate();var ek=el.getUTCMonth()+1;var ep=ck(el);em=ar(es,en,eo,er,et,ek,ep)}catch(eq){}dU("#recurring_feedback").text(em)}function ar(ev,em,eo,eq,ex,el,ep){var et=Date.UTC(new Date().getFullYear(),el-1,ex,eq,eo);var es=new Date(et);var en=ep;if(es.getUTCDay()>es.getDay()||(es.getUTCDay()===0&&es.getDay()===6)){en=c(ep)}else{if(es.getUTCDay()<es.getDay()||(es.getUTCDay()===6&&es.getDay()===0)){en=b9(ep)}}var er="";var eu=en.replace("(","").replace(")","");for(var ew=0;ew<bJ.length;ew++){eu=eu.replace(ew.toString(),bJ[ew])}er+=eu;if(er===""){return""}var ek="Every ";if(em>1){ek+=em+" "}switch(ev){case"DAILY":ek+="day";break;case"WEEKLY":ek+="week";break;case"MONTHLY":ek+="month";break;case"YEARLY":ek+="year";break}if(em>1){ek+="s"}ek+=", ";if(ev==="WEEKLY"){ek+="on "+er.split(",").join(", ")+" "}if(ev==="MONTHLY"){ek+="on day "+es.getDate();if(es.getDate()>28){ek+="(or the last day of the month)"}ek+=" "}if(ev==="YEARLY"){ek+="on "+es.toString("MMM d")+" "}ek+="at "+es.toString("hh:mm tt");return ek}function aX(){dU("#recurring_feedback").text("")}function dk(){dU("input.day_cb").each(function(){dU(this).removeAttr("checked")});dU("#days_of_week").css("display","none")}function cQ(){dU("#days_of_week").css("display","block")}function a4(){dU("#frequency").change(function(){dU("#num_interval").val(1);if(dU("#frequency").val()==="week"){cQ();dU("input.day_cb").attr("checked",false);dU("#interval").text(" week")}else{if(dU("#frequency").val()==="weekday"){cQ();dU("input.day_cb").filter("[value='0'], [value='1'], [value='2'], [value='3'], [value='4']").attr("checked",true);dU("input.day_cb").filter("[value='5'], [value='6']").attr("checked",false);dU("#interval").text(" week")}else{dk();dU("input.day_cb").attr("checked",true);dU("#interval").text(" "+dU("#frequency").val())}}dV()});dU("#num_interval").change(function(){dV()});dU("#num_interval").click(function(){dV()});dU(".day_cb, #start_date, #start_time").change(function(){dV()});dU("#start_time").keyup(function(){dV()})}function cJ(){var eo=bb();var el=dU("#b4g_manage",eo);if(el.length>0||aq()===""){return}var em=dU(".gb_Ea");if(em.length===0){em=dU(".gb_Fa")}em.first().before('<div class="manage_menu" style="display: inline-block; -webkit-flex: 0 0 auto; flex: 0 0 auto;" id="b4g_manage"><div><img id="b4g_app_loader_icon" src="'+cu+'b4g_launcher_light.png" title="Boomerang" style="position: relative; top: 7px; left:3px;"/></div></div>');var eq=dU(".gb_ga");eq.click(function(){dU(eo).click()});dU("#b4g_app_loader_icon").hover(function(){dU(this).attr("src",cu+"b4g_launcher_color.png")},function(){dU(this).attr("src",cu+"b4g_launcher_light.png")});dU("#b4g_manage",eo).click(function(){q(dU(this))});var ep=40;var en=dU(".gb_5.gb_tb.gb_f.gb_sb");var ek=en.css("min-width");var er=(parseInt(ek,10)+ep).toString()+"px";en.css("min-width",er)}function q(ep){var et,er,ex,eo,es;eo=dU(".b4g_manage_dropdown",bt);if(eo.length>0){dU(eo).remove();return}er=cx();es=dD+"managelogin?guser="+encodeURIComponent(aq())+"&userNum="+er;ex=dD+"submitinvitelogin?email="+encodeURIComponent(aq());var eu=dD+"toolbox";var ew=dD+"premiumsupport";var ev=aM();if(ay(ev)){var el="<ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px;'> <li id='tmmanage' > <a href='"+es+"' class='top_menu_option' target='_blank' >Manage scheduled messages</a></li><li id='tmsettings' ><a class='top_menu_option' target='_blank' style='cursor:pointer;'>Settings</a></li><li id='tmtoolbox' > <a href='"+eu+"' class='top_menu_option' target='_blank' >Toolbox</a></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div><ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px;'> <li id='tmpremiumsupport' > <a href='"+ew+"' class='top_menu_option' target='_blank' >Premium Support</a></li><li id='tmfaq' > <a href='http://boomeranggmail.com/faq.html' class='top_menu_option' target='_blank' >Help</a></li><li id='tmhowto' > <a href='javascript:void(0)' class='top_menu_option' target='_blank'>How To</span></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div><ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px'> <li id='tmfriend' ><a href='"+ex+"' class='top_menu_option' target='_blank'>Refer a friend</a></li><li id='tmbuy' > <a href='http://b4g.baydin.com/subscriptions?guser="+encodeURIComponent(aq())+"' class='top_menu_option' target='_blank'>Buy a subscription</a></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div>"}else{var el="<ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px;'> <li id='tmmanage' > <a href='"+es+"' class='top_menu_option' target='_blank' >Manage scheduled messages</a></li><li id='tmsettings' ><a class='top_menu_option' target='_blank' style='cursor:pointer;'>Settings</a></li><li id='tmfaq' > <a href='http://boomeranggmail.com/faq.html' class='top_menu_option' target='_blank' >Help</a></li><li id='tmhowto' > <a href='javascript:void(0)' class='top_menu_option' target='_blank'>How To</span></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div><ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px'> <li id='tmfriend' ><a href='"+ex+"' class='top_menu_option' target='_blank'>Refer a friend</a></li><li id='tmbuy' > <a href='http://b4g.baydin.com/subscriptions?guser="+encodeURIComponent(aq())+"' class='top_menu_option' target='_blank'>Buy a subscription</a></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div>"}et=dU('<div class="b4g_manage_dropdown manage_menu" style="display: block; width:200px; margin-left:-5px; left:0px; background: #fff; border: 1px solid #ccc; border-color: rgba(0,0,0,.2); box-shadow: 0 2px 10px rgba(0,0,0,.2); overflow: hidden; position: absolute; right: 0; top: 44px; -webkit-animation: gb__a .2s; animation: gb__a .2s; -webkit-border-radius: 2px; border-radius: 2px; -webkit-user-select: text; ">'+el+'</div><div class="b4g_manage_dropdown" style="display:block; margin-left:5px; left:auto; border-color: transparent;border-style: dashed dashed solid;border-width: 0 8px 8px;position: absolute;z-index: 1;height: 0;width: 0;-webkit-animation: gb__a .2s;animation: gb__a .2s;border-bottom-color: #ccc;border-bottom-color: rgba(0,0,0,.2);top: 36px;"></div><div class="b4g_manage_dropdown" style="display:block; margin-left:5px; left:auto; border-color: transparent;border-bottom-color: #fff;border-style: dashed dashed solid;border-width: 0 8px 8px;position: absolute;top: 37px;z-index: 1;height: 0;width: 0;-webkit-animation: gb__a .2s;animation: gb__a .2s;"></div>');var em=et.find("a");em.css("color","#36c");em.css("text-decoration","none");em.hover(function(){dU(this).css("text-decoration","underline")},function(){dU(this).css("text-decoration","none")});et.appendTo("#b4g_manage");bw(["Top Menu","Open menu"]);var eq=bS("b4g-inline-manage-last-update-"+aq());if(eq==null){var ek=new Date();var en=(ek.getMonth()+1)+"/"+ek.getDate()+"/"+ek.getFullYear();eq=en+" 12:00 AM"}dU(".tmdataupdate",bt).text(eq);dU(bt).click(function(ez){var ey=cI(ez);if(dU(ey).parents().andSelf().filter("#b4g_manage").length===0){dU(et).remove();dU(bt).unbind("click")}});dU("#tmdata",bt).click(function(){R(function(){aC(bt)})});dU("#tmmanage",bt).click(function(){bw(["Top Menu","Click manage scheduled messages"])});dU("#tmbuy",bt).click(function(){bw(["Top Menu","Click buy a subscription"])});dU("#tmfaq",bt).click(function(){bw(["Top Menu","Click help"])});dU("#tmhowto",bt).click(function(){by();bw(["Top Menu","Click How To"])});dU("#tmfriend",bt).click(function(){bw(["Top Menu","Click tell a friend"])});dU("#tmtoolbox",bt).click(function(){bw(["Top Menu","Click toolbox"])});dU("#tmpremiumsupport",bt).click(function(){bw(["Top Menu","Click premium support"])});dU("#tmsettings",bt).click(function(){R(y);bw(["Top Menu","Click settings"])})}function aC(ek){cW.expire_cache();b2("Updating...",2000)}function by(){u(1)}function ai(){var em=bb();var ep=dU(".boomerang-button",em);if(ep.length>0){return}var ek=dU(v,em);if(ek.length<1){return}var eo=document.createElement("div");eo.innerHTML="<div aria-haspopup='true' style='-webkit-user-select: none; -moz-user-select:none;margin-bottom:0px;margin-top:-2px; outline: none;' role='button' class='J-J5-Ji W6eDmd L3 J-Zh-I J-J5-Ji Bq L3' tabindex='0'><img class='f tk3N6e-I-J3' src='"+cu+"tinyboomlogo.png' style='vertical-align: middle;'/> Boomerang <div class='VP5otc-d2fWKd tk3N6e-I-J3 J-J5-Ji'> </div></div>";var eq=dU(".Ykrj7b",em).html();var el=dU(H,em).filter(function(){return dU(this).text().trim()===eq}).attr("class");dU(eo).attr("class",el+" boomerang-button b4g_button");var es=null;var er=dU(dg,em);for(var en=0;en<er.length;en++){es=eo.cloneNode(true);dU(es).click(function(et){aZ(et,this,cG);bw(["thread menu","click"])});er.get(en).appendChild(es)}}function de(){var en=bb();var eq=dU(".b4g-magic",en);var eu=dU(".cf.hX:contains('Boomerang')",en);if(eq.length>0||eu.length>0){return}var ek=bj();ek=aj(ek);var ep=b5(ek,new Date(),6);var eo=dU(cZ,en);if(ep.length>0&&ep[0]>new Date()&&ep[0]<new Date().addMonths(18)){var et=extractTime(ek)!=null;var em="";var el=new Date(ep[0]);if(et){em="2 hours before";el=el.addHours(-2)}else{em="1 day before";el=el.addDays(-1)}if(el>new Date()){var es=" <img class='f' src='"+cu+"tinyboomlogo.png' style='margin: 1px 0px -1px 0px; vertical-align: middle;'/> Boomerang this? ";var er=ep[0];es+="<select style='padding: 1px  0;line-height: 12px;' name='magicChoice' id='magicChoice' >";es+="<option value='the week before'>the week before</option><option value='the day before'>the day before</option><option value='the morning of'>the morning of</option><option value='2 hours before'>2 hours before</option><option value='the afternoon of'>the afternoon of</option><option value='the day after'>the day after</option><option value='the week after'>the week after</option></select>";es+="<strong> "+er.toString("MMM d, yyyy")+" "+er.toString("h:mmtt")+"</strong>. ";es+="<input type='submit' id='confirmMagic' value='Confirm'/>";eo.attr("style","height: 25px; padding-top: 5px; margin-bottom: 5px; text-align:center;");eo.html("<span class='vh boomerang b4g-magic' style='font-weight: normal !important; background-color: #FFC; padding: 5px 5px 5px 5px; font-size: 80%; color: rgb(42, 93, 176);'>"+es+"</span> ");if(et){dU("#magicChoice option[value='2 hours before']",en).attr("selected","selected")}else{dU("#magicChoice option[value='the day before']",en).attr("selected","selected")}dU("#confirmMagic",en).click(function(){var ex=dU("#magicChoice",en).val();var ew=bn;var ev="";switch(ex){case"the week before":ev=new Date(er).clearTime().addDays(-7).addHours(ew);break;case"the day before":ev=new Date(er).clearTime().addDays(-1).addHours(ew);break;case"the morning of":ev=new Date(er).clearTime().addHours(ew);break;case"2 hours before":ev=new Date(er).addHours(-2);break;case"the afternoon of":ev=new Date(er).clearTime().addHours(12);break;case"the day after":ev=new Date(er).clearTime().addDays(1).addHours(ew);break;case"the week after":ev=new Date(er).clearTime().addDays(7).addHours(ew);break;default:ev=new Date(er).addHours(-2)}eo.attr("style","height: 31px; list-style-type:none;padding: 0px 5px 5px 5px;text-align:center;");eo.html("<img class='b4g-magic' src='"+cu+"ajax-loader.gif' alt='Loading...'>");cG(ev,{isByMagic:true});bw(["magic link","click",ex])})}}else{eo.html("<span class='vh boomerang b4g-magic' style='display:none'></span>")}}function a3(ek){if(!ek){ek=bb()}var el=dU(".boomerangSendCheck",ek);if(el.is(":checked")){el.hide();el.attr("disabled",true);el.after("<img src='"+cu+"checkbox-loader.gif' class='b4g_checkbox_loader' alt='Loading...'>");R(function(){el.show();el.attr("disabled",false);dU(".b4g_checkbox_loader").remove();if(aM()==="premium"){var en=JSON.parse(bS("b4g_preferences-"+aq()));if(en.crm.active&&en.crm.bccIncludeWith==="boomerang"){var em=en.crm.bccAddress;d4(ek,em)}}})}}var aI="<div class='b4g-notes' style='width: 220px'><h3 style='margin: 7px 0 10px 0;'>Enter your note below.</h3><textarea rows='10' id='note_entry' style='border:1pxsolid#999;background-color:#fbf1b5;width:100%;box-sizing:border-box;'>Some text</textarea><div style='font-size:.9em'>This note will return with your message.</div><div style='text-align:center;padding:10px 10px 7px 10px;'><button id='notes_save_button' class='by-button by-button-secondary' style='width:70px;'><span class='by-button-text'>Save</span></button><button id='notes_cancel_button' class='by-button' style='width:70px;margin-left:5px;'><span class='by-button-text'>Cancel</span></button></div></div>";function aZ(er,em,eo){var eq=bb();var es=er.target;if(dU(es).closest("#b4g_menu").length>0){return}var ev=eq.getElementById("b4g_menu");if(ev){cH(er,em)}else{dU("div",em).addClass("J-Zh-I-JO");dU("div",em).addClass("J-Zh-I-Kq");var en='<ul id="b4g_menu" tabindex="0" class="b4g_menu" style="padding:0px;position:absolute;left:'+dU(er.currentTarget).position().left+'px;  background-color: rgb(255, 255, 255); -webkit-user-select: none; min-width: 17em;min-height:auto;" role="menu" aria-haspopup="true" aria-activedescendant=""><div id="b4g_inner_menu" class="b4g_menu SK AX" style="-webkit-user-select: none; font-size:12px;color:#333;padding:0;"><li class="menu-caption" style="list-style-type:none;padding: 7px 11px 0 11px;margin: 0 0 1px 0;"><span style="padding:0px;">Return Conversation to Inbox:</span><img class="b4g_menu" id="notes_toggle" data-tooltip="Add Note" data-tooltip-delay="400" src="'+cu+'notes_off.png"  height="16px" style="opacity:.9;position:absolute;right:31px;top:6px;cursor:pointer;"/><img id="b4g-menu-customization-button" data-tooltip="Customize Menu" data-tooltip-delay="400" src="'+cu+'gear.png" height="16px" style="opacity:.9;position:absolute;right:11px;top:7px;cursor:pointer;"></li><div id="notes_menu" class="b4g_menu SK AX" style="display:none;min-width:17em;min-height:auto;left:2px;margin:5px;border:none;box-shadow:none;-moz-box-shadow:none;">'+aI+'</div><li class="b4g_menu b4g-menu-option" style="padding:6px 11px 6px 11px;"><input type="checkbox" id="conditionalBoomerang" class="b4g_menu" name="condBoomerang"/> Only if nobody responds</li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 6px 11px;background:#ddd;"></li><li class="b4g-standard-times"></li><li class="b4g-custom-times"></li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 0px 11px;background:#ddd;"></li><li class="menu-caption" style="padding:7px 11px 4px 11px;">At a specific time:</li><li class="b4g-menu-option" style="padding: 0 0 7px 11px;"><div style="color: #666; font-style: italic; font-size: 10px; margin-top: 3px;" class="b4g_menu">Examples: "Monday 9am", "Dec 23"</div><form onsubmit="return false;"><div style="padding-top:3px; vertical-align: middle;" class="b4g_menu"><input style="margin-left:1px;padding:3px 22px 2px 2px;" class="b4g_menu" type="text" name="time" id="datepicker"><input id="specific-time-submit" type="submit" value="Confirm" style="margin: 0px 7px 5px 9px;font-size:11px;vertical-align:top;" class="b4g_menu by-button by-button-secondary"></div><div style="color:#969696;margin-left:1px;"><span id="date-preview" class="b4g_menu" style="color:green;"></span></div></form></li><li class="b4g-menu-divider" style="height:1px;margin:0px 11px;background:#ddd;"></li><li class="b4g-menu-option"><a id="random-time" class="menu-anchor" style="margin:4px 0px;border-width:0px;color:#333;padding: 6px 11px;cursor:pointer;" href="javascript:void(0)"><span style="vertical-align:bottom;margin-left:0px;">Random time</span><img src="'+cu+'down.png" width="10px" style="opacity:.7;vertical-align:middle;margin:-2px 0px 0px 5px;"/></a></li><li class="random b4g-menu-option" style="display:none;"><a class="random_link menu-anchor" href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding:3px 13px;display:block;cursor:pointer;">- By 5pm today</a></li><li class="random b4g-menu-option" style="display:none;"><a class="random_link menu-anchor" href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding:3px 13px;display:block;cursor:pointer;">- Within 1 week</a></li><li class="random b4g-menu-option" style="display:none;margin-bottom:6px;"><a class="random_link menu-anchor" href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding:3px 13px;display:block;cursor:pointer;">- Within 1 month</a></li></div></ul>';dU(em).parent().append(en);var ew=dU("#b4g_menu",eq);ap.enable_menu_arrow_keys(ew);dU("#conditionalBoomerang",eq).change(function(){bw(["thread menu","conditional boomerang",(dU(this).is(":checked")?"checked":"un-checked")])});i(dU(".b4g-standard-times",eq));Y(eq);dU(".b4g_menu_item",eq).click(function(){function eA(eB){eo(eB);bw(["boomerang menu","send later time",eB])}eA(dU(this).text())});dA(dU(".b4g_menu_item",eq),bn);if(dE==null||dE<new Date()){Z=Date.today().addDays(2).addHours(8)}else{Z=dE}var ex=Z.toString("M/d/yyyy h:mm tt");var ep=dU("#datepicker",eq);ep.val(ex);ep.keyup(function(){var eA=dU(this).val();aQ(eA)});ep.focus(function(){var eA=dU(this).val();aQ(eA)});dU("input#specific-time-submit",eq).click(function(eA){cD(eA,eo)});var eu=a9();if(eu.length>0){dU(".b4g-custom-times",eq).before("<div class='b4g-menu-divider' style='height:1px;margin:6px 11px;background:#ddd;'></div>");for(var ey=0;ey<eu.length;ey++){var ek=c1(eu[ey],null);dU(".b4g-custom-times",eq).append(ek)}dU(".b4g-custom-menu-item",eq).hover(function(){dU(this).addClass("J-N-JT")},function(){dU(this).removeClass("J-N-JT")});dU(".b4g-custom-menu-item",eq).click(function(){function eA(eB){bq(eB,eo);bw(["b4g menu","picked",eB])}eA(dU(this).text())});dA(dU(".b4g-custom-menu-item",eq),bn)}var ez=function(){b0(dU("#random-time:first-child",eq),ev);eh();bw(["thread menu","random time","opened"])};var et=function(){N(dU("#random-time:first-child",eq),ev);eh();bw(["thread menu","random time","closed"])};dU("#random-time",eq).parent().toggle(ez,et);dU(".random_link",eq).click(function(){function eA(eB){eo(eB);bw(["b4g menu","random time","picked - "+eB])}eA(dU(this).text())});dA(dU(".random_link",eq),bn);var el=dU("#b4g-menu-customization-button",eq);el.click(function(){ag()});el.hover(function(){dU(this).css("opacity","1")},function(){dU(this).css("opacity",".9")});dU(eq).bind("click",{owner:em},az);cN(ep);dU(".b4g-ui-datepicker-trigger",eq).css("cursor","pointer");dU(".b4g-ui-datepicker-trigger",eq).css("margin-left","-21px");dU(".b4g-ui-datepicker-trigger",eq).css("margin-top","-2px");dU(".b4g-ui-datepicker-trigger",eq).hover(function(){dU(this).css("box-shadow","0px 0px 3px #aaa")},function(){dU(this).css("box-shadow","none")});ep.mousedown(function(eA){eA.stopImmediatePropagation()});ep.css("-moz-user-select","text");ep.parents().each(function(){dU(this).css("-moz-user-select","text")});ep.focus();ep.select();dU("span#date-preview.b4g_menu",eq).text("");dU("#note_entry",eq).val("");dU("#notes_toggle",eq).click(function(){am(ao,bB);bw(["notes","click"])}).hover(function(){dU(this).css("opacity","1")},function(){dU(this).css("opacity",".9")});dU("#notes_save_button",eq).click(function(){cw();if(dU("#note_entry",eq).val()){dU("#notes_toggle",eq).attr("src",cu+"notes_on.png");dU("#notes_toggle",eq).attr("data-tooltip","Edit Note");dU("#notes_toggle",eq).css("top","6px")}eh()});dU("#notes_cancel_button",eq).click(function(){cw();dU("#note_entry",eq).val("");dU("#notes_toggle",eq).attr("src",cu+"notes_off.png");dU("#notes_toggle",eq).attr("data-tooltip","Add Note");dU("#notes_toggle",eq).css("top","6px");eh()});eh()}}function az(em){var ek=bb();var el=cI(em);if(el.className.indexOf("ui")!==0&&el.className.indexOf("J-Zh-I J-J5-Ji Bq L3 J-Zh-I-JO J-Zh-I-Kq")===-1&&el.className.indexOf("f")!==0&&el.className.indexOf("VP5otc-d2fWKd")===-1&&el.className.indexOf("menu-anchor")===-1&&el.className.indexOf("b4g_menu")===-1&&el.className.indexOf("menu-caption")===-1&&el.className.indexOf("send-later-button")===-1&&el.className.indexOf("boomerang-button")===-1&&el.className.indexOf("sendboomerang-button")===-1&&el.className.indexOf("conditional-caption")===-1&&dU(el).closest(".b4g-ui-datepicker,.b4g_menu,.b4g-ui-corner-all").length===0){cH(em,em.data.owner);dU(ek).unbind("click",az)}}function cH(el,ek){dU("#b4g_menu").remove()}function cN(ek){ek.datepicker({showOn:"button",buttonImage:cu+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,dateFormat:"m/dd/yy",minDate:0,onSelect:function(en,em){var el=ek;var eo=new Date().toString("hh:mm tt");el.val(el.val()+" "+eo);bw(["boomerang menu","select custom time",el.val()])},onClose:function(em,el){ek.focus()}});dU(".b4g-ui-datepicker-trigger",bt).css("margin-left","5px");dU(".b4g-ui-datepicker-trigger",bt).css("vertical-align","middle")}function ao(){cw();dU("#note_entry",bt).focus()}function bB(){bH("A Personal or Pro subscription is required to use this feature. To add notes, please upgrade your subscription.","Boomerang for Gmail",{Upgrade:{text:"Upgrade to add notes","class":"b4g-button green",click:function(){window.open("https://b4g.baydin.com/subscriptions","_blank")}},"Never mind":{text:"Never mind","class":"b4g-button dialog-gray",click:function(){dU(this).dialog("destroy")}}},{width:350,dialogClass:"b4g-upgradenag-dialog"});bw(["notes","blocked non-subscriber"])}function P(en,el){var ek='<a href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding: 3px 11px;display:block;cursor:pointer;" class="b4g_menu_item menu-anchor J-N">'+en+"</a>";var em='<div class="b4g-menu-option">'+ek+"</div>";if(el){em+='<div class="b4g-menu-divider" style="height:1px;margin:6px 11px;background:#ddd;"></div>'}return em}function c1(em,en){var ek='<a href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding: 3px 11px;display:block;cursor:pointer;" class="b4g-custom-menu-item menu-anchor J-N">'+em+"</a>";var el='<div class="b4g-menu-option">'+ek+"</div>";return el}function b0(el,ek){dU(".random",ek).show();el.html('<span style="vertical-align:bottom;margin-left:0px;">Random time</span><img src="'+cu+'up.png" width="10px" style="opacity:.7;vertical-align:middle;margin:-2px 0px 0px 5px;"/>')}function N(el,ek){dU(".random",ek).hide();el.html('<span style="vertical-align:bottom;margin-left:0px;">Random time</span><img src="'+cu+'down.png" width="10px" style="opacity:.7;vertical-align:middle;margin:-2px 0px 0px 5px;"/>')}function aV(){var el=bb();var ek=dU("#b4g_inner_menu",el);if(ek.length>0){ek.empty();dU(".b4g-ui-datepicker").css("display","none");ek.append('<li style="list-style-type:none;text-align:center;padding:0px 2px;margin:6px 0px;">Processing message...</li>');ek.append('<li style="list-style-type:none;padding:5px 10px;text-align:center;"><img src="'+cu+'ajax-loader.gif" alt="Loading..."></li>');eh()}}function ba(ek){var el=ek.replace(/^\s+|\s+$/g,"").replace(/^in|^In|^IN/,"+");var em=Date.parse(el.toLowerCase().replace("tomorrow","").replace("tom",""));if(em&&em<new Date()&&dJ(el)&&el.indexOf("yester")===-1&&el.indexOf("today")===-1){em=em.addDays(7)}if(el.toLowerCase().indexOf("tom")!==-1){if(!em){em=new Date()}em=em.addDays(1)}if(em&&em<(new Date()).addDays(-1)&&em>(new Date()).addYears(-1)&&el.indexOf("day")===-1&&el.indexOf("now")===-1&&!hasYear(el)){em=em.addYears(1)}if(/^\d{1,2}:\d{1,2}$/.test(el.trim())&&em<new Date()){em=em.addHours(12);if(em<new Date()){em=em.addHours(12)}}return em}function dJ(ek){var el=ek.toLowerCase();return(el.indexOf("sun")===0||el.indexOf("mon")===0||el.indexOf("tue")===0||el.indexOf("wed")===0||el.indexOf("thu")===0||el.indexOf("fri")===0||el.indexOf("sat")===0)}function aQ(ek){var el=bb();if(!ek){return}Z=ba(ek);var em=au(Z,true);if(Z==null){dU("#date-preview",el).html("<span class='b4g_menu' style='color:#ff0000;'>"+em+"</span>")}else{if(Z<new Date()){dU("#date-preview",el).html("<span class='b4g_menu' style='color:#ff0000;'>"+em+"</span>")}else{dU("#date-preview",el).html("<span class='b4g_menu'>"+em+"</span>")}}eh()}function eg(){try{var el=dU(".dialog-content");el.css("text-align","left");el.html(da);dU("#blue-arrow").css("visibility","visible")}catch(ek){}}function dF(){dU(".UD",bt).first().css("visibility","");dU(".UB",bt).first().css("visibility","");dU(".vh",bt).first().html("").css("visibility","").closest(".b8.UC").css("top",-10000)}function dM(){dU(".UD",bt).first().css("visibility","visible");dU(".UB",bt).first().css("visibility","visible");dU(".vh",bt).first().css("visibility","visible").closest(".b8.UC").css("top",0)}function b2(ek,el){dU(".vh",bt).first().html(ek);dM();setTimeout(dF,el)}function bb(){var el=document.getElementById("canvas_frame");if(!el){return document}var ek=(el.contentWindow||el.contentDocument);if(ek.document){ek=ek.document}return ek}function dl(){var ek=null;var el=document.getElementById("js_frame");if(el!=null){ek=(el.contentWindow||el.contentDocument);if(ek.document){ek=ek.document}}return ek}function X(){return dU(dl()).text().indexOf("Sending in the background")>=0}function aA(){var ep,ek,em=window.location.hash.toString();if(!em){var eo=window.location.toString();ek=eo.lastIndexOf("#");if(ek>-1){em=eo.substr(eo.lastIndexOf("#"))}}ek=em.lastIndexOf("/");if(ek>-1){var en=em.substr(ek+1);var el=/[0-9a-f]+(?=$|\?)/;ep=el.exec(en)}if(ep){ep=ep[0]}else{ep=a.th||""}return ep}function r(ek){return bl("draft",ek).val()}function cI(ek){ek=ek||window.event;return ek.target||ek.srcElement}function bl(ek,el){if(!el){el=bb()}return dU("*[name='"+ek+"']",el).filter(":first")}function aq(){if(ab){return ab}else{var ek=I;var ep=dU(".msg").html();var em=ek.exec(ep);if(!em){em="";var en=document.title.split(" ");for(var eo=0;eo<en.length;eo++){var el=ek.exec(en[eo]);if(el){em=el[0]}}}else{em=em[0]}ab=em;return em}}function am(ek,el){z(dI,ek,el)}function aa(ek,el){z(aL,ek,el)}function aK(ek,el){z(ay,ek,el)}function z(el,ek,en){var em=aM();if(em&&el(em)){ek()}else{R(function(){var eo=aM();if(el(eo)){ek()}else{en()}})}}function aM(){var ek=aq();return bS("b4g_plan-"+ek)}function dI(ek){return ek&&ek!=="basic"}function aL(ek){return ek&&(ek.indexOf("pro")>-1||ek==="premium")}function ay(ek){return ek&&(ek==="premium")}function cx(){var el=String(document.location);var ek=/mail\.google\.com\/mail\/u\/(\d+)/;var em=ek.exec(el);var en;if(em==null){en=0}else{en=em[1]}return en}function dC(){return a.b4gEdit==="true"}function bj(){var eo=bb();var ek=eo.getElementsByClassName("hP");var el=ek[0].childNodes;var en="";for(var em=0;em<el.length;em++){var eq=el[em].nodeValue;if(eq!=null){en=en+eq}}var ep=dU(v,eo);if(ep.length<1){return""}return en+" "+ep.get(0).firstChild.textContent}function bh(em){var ek,el=this;ek=bt.createEvent("MouseEvents");ek.initMouseEvent("mousedown",true,true,window,0,0,0,0,0,false,false,false,false,0,null);el.dispatchEvent(ek);ek=bt.createEvent("MouseEvents");ek.initMouseEvent("mouseup",true,true,window,0,0,0,0,0,false,false,false,false,0,null);el.dispatchEvent(ek)}function bp(){bt=bb();var el=dU(".iH .J-Zh-I-KE",bt);if(el.length===0){el=dU("[role='button']:visible",bt)}var ek=el.filter(function(){return dU(this).attr("act")==="7"});ek.each(bh)}function bR(){bt=bb();var em=dU("[role='button']",bt);var el=em.filter(function(){return dU(this).attr("act")==="19"}).first();var en=dU('div[act="19"]',bt).attr("aria-label");if(el.length<1){em=dU(".iH .VP5otc-tOAp0c",bt);el=em.filter(function(){return dU(this).text().indexOf(en)!==-1}).first()}if(el.length<1){em=dU(".iH .QkhFhe",bt);el=em.filter(function(){return dU(this).parent().attr("title").indexOf(en)!==-1}).first()}var ek=el.length>0;el.each(bh);return ek}function dt(el,ek){var en=window.location.hash;if(dC()){dS=false;window.close()}if(ek==="return"){if(cv()){bp();dS=false;window.onbeforeunload=false;alert(el);window.close();return}else{bp();bR()}}else{if(ek==="send"||ek==="send_new_compose"){p=String(document.location);if(cv()){alert(el);window.close();return}else{if(!bR()){if(bc){window.location.hash="#mbox"}else{window.location.hash="#inbox"}if(bz()){dU(".gB.acO",bt).hide().after("<div>"+el+"</div>");cH()}setTimeout(a0,5000)}}}}dF();a0();var em=setInterval(function(){if(window.location.hash!==en||en==="#inbox"||en==="#mbox"){b2(el,5000);clearInterval(em)}},2000)}function aF(em,el,ek){setTimeout(function(){dt(em,ek)},el)}function cD(el,eo){var ek=bb();var en=Date.parse(Z);if(en!=null){var em=dU("#datepicker",ek).val();if(s(em)){ca(em);eo(en)}else{bH("The time you entered is in the past. We can only schedule messages for the future.");bw(["boomerang menu","confirm specific time","error time in the past entered"])}}else{bH("Unable to read specified time. Please try again.");bw(["boomerang menu","confirm specific time","error invalid time"])}bw(["boomerang menu","confirm specific time","clicked"])}function bq(em,el){var ek=ba(em);if(ek!=null){el(ek)}else{bH("Something went wrong processing the customized date. Please let the Boomerang team know.")}}function aS(em,el){if(!el){el=bb()}var en=dU(".conditional-caption",el);var ek=dH(em,bn);h=ek;en.data("returnDate",ek);en.text(String(em));dU(".b4g-ui-datepicker").css("display","none");en.removeClass("J-Zh-I-JO");en.removeClass("J-Zh-I-Kq");dU(".boomerangSendCheck",el).attr("checked",true);a3(el);dU(".b4g_menu",el).remove();bw(["boomerang menu","send boomrang menu","clicked"])}function aR(en,el){if(!el){el=bb()}var em=dU(".conditional-caption",el);var ek=dH(en,bn);h=ek;em.data("returnDate",ek);em.text("by "+en.toString("ddd MMM d h:mm tt"));dU(".b4g-ui-datepicker").css("display","none");em.removeClass("J-Zh-I-JO");em.removeClass("J-Zh-I-Kq");dU(".boomerangSendCheck",el).attr("checked",true);a3(el);dU(".b4g_menu",el).remove();bw(["boomerang menu","send specific time","clicked"])}function e(ek,em){var en=new Date();var el=Math.floor(Math.random()*30)-15;switch(em){case"hours":en=en.addHours(parseInt(ek));break;case"days":en=en.addDays(parseInt(ek)).addMinutes(el);break;case"weeks":en=en.addWeeks(parseInt(ek)).addMinutes(el);break;case"months":en=en.addMonths(parseInt(ek)).addMinutes(el);break;default:en=0}return en}function cG(ew,em){em=em||{};var eo=bb();var el=aq();var et=cj();var ev=aB();var eu=b1();var en=dH(ew,bn);var ep=au(en,false);var eq=dU("#note_entry",eo).val();if(eq==null){eq=""}var ek="https://b4g.baydin.com/mailcruncher/schedulereturn";ek=ek+"?subject="+encodeURIComponent(et);ek=ek+"&senders="+encodeURIComponent(JSON.stringify(ev));ek=ek+"&guser="+encodeURIComponent(el);ek=ek+"&sentDates="+encodeURIComponent(JSON.stringify(eu));ek=ek+"&offset="+encodeURIComponent(en.valueOf());ek=ek+"&threadId="+encodeURIComponent(aA());if(bN()){ek=ek+"&language=English"}else{ek=ek+"&language=notEnglish"}if(dU("#conditionalBoomerang",eo).attr("checked")){ek=ek+"&conditional="+encodeURIComponent("True")}else{ek=ek+"&conditional="+encodeURIComponent("False")}if(bl("^i").length>0&&p.indexOf("label")>0){ek=ek+"&inbox=True"}else{ek=ek+"&inbox=False"}ek=ek+"&notes="+encodeURIComponent(eq);var es=String(document.location);var ex="Message will return "+ep+". ";aV();R(function(){er()});function er(){function ey(eA,eB,ez){if(d3(eA)){t(eA)}else{if(eA===be){t(eA);window.location=es}else{if(eA!==d0){bH("Attempt failed: "+bm[eA]);window.location=es}else{if(eA===d0){M({type:"return-later",isByMagic:em.isByMagic});cW.expire_cache()}}}}}a7(ek,ey,ex);aF(ex,300,"return")}}function dB(){var ek=dU(".dU",bt);return(ek.length>0)}function a7(em,ep,en){var el=new Image();var eo=new Date();var ek="&uniquestring="+eo.getTime();el.onload=function(){var eq=el.width;if(eq>=bm.length&&eq<b4){eq=at}el.style.display="none";ep(eq,em,en)};el.src=em+"&image=True"+ek}function bF(el){if(dU("#keyboard-shortcuts",el).is(":checked")){ap.enable();bw(["keyboard-shortcuts","toggle","enabled"])}else{ap.disable();bw(["keyboard-shortcuts","toggle","disabled"])}var et=(dU("#unread",el).get(0).checked==1)?"True":"False";var eo=(dU("#starred",el).get(0).checked==1)?"True":"False";var en=(dU("#topinbox",el).get(0).checked==1)?"True":"False";var eu=(dU("#labelled",el).get(0).checked==1)?"True":"False";var ez=(dU("#b4g_send_check",el).get(0).checked==1)?"True":"False";var eq=dU("#b4g_send_check_num option:selected",el).val()+"_"+dU("#b4g_send_check_unit",el).val();var em=dU("#b4g_send_check_cond option:selected",el).val();var ey=(dU("#b4g_read_receipt_check",el).get(0).checked==1)?"True":"False";var ep="&onSendSetting="+ez+"&onSendOffset="+eq+"&onSendCond="+em+"&readReceipts="+ey;var eA=dU("#b4g_crm_enabled").is(":checked")?"True":"False";var ew=dU("#b4g_crm_select").val();var ex=dU("#b4g_bccAddress").val();if(eA==="True"&&!dT(ex)){alert("Please enter a valid email address.");return false}var er=dU(".b4g_crm_include_with:checked").val();ep+="&crmActive="+eA+"&crmSelect="+ew+"&crmBcc="+ex+"&crmInclude="+er;var ek="https://b4g.baydin.com/changepreferences?unread="+et+"&starred="+eo+"&topInbox="+en+"&labelled="+eu+ep;var es=aq();var ev={readReceipts:ey==="True",onSendOffset:eq,onSendSetting:ez==="True",onSendCond:em,crm:{active:eA,bccIncludeWith:er,bccAddress:ex,crm:er}};A("b4g_preferences-"+es,JSON.stringify(ev));dU.ajax({method:"get",url:ek,xhr:function(){var eB=dU.ajaxSettings.xhr();eB.withCredentials=true;return eB},success:function(eB){bw(["Settings Dialog","settings changed successfully"])},error:function(eB){bw(["dev-CORS","failure","XHR-failure"])},});return true}function R(em,ek){function ep(eu,eq){function er(ez,ew){function ev(eC,eE,eD){if(eC===ej){eA(ex,eD)}else{if(eC===d0){ez()}else{if(eC===be){t(eC)}}}}function ex(eF,eD,eC){if(eF===d0){ez();bs()}else{if(eF===be){t(eF)}else{if(eF===w){bH("Attempt failed: "+bm[eF]);if(ew){ew("Failed to authenticate.")}}else{if(ci==="Firefox"){bH(Q)}else{if(ci==="Safari"||ci==="Old Safari"){var eE=dU(bP);dU("body").append(eE);dU("#safari-boomerang").click(function(){ev(eF,eD,eC);eE.remove()})}else{bH("Attempt failed: "+bm[eF]);if(ew){ew("Failed to authenticate.")}}}}}}}function eA(eI,eL){var eE,eC=aq();if(ci==="Chrome"){eE=dU(cq);setTimeout(eg,5000)}else{eE=dU(ch)}var eG=800;var eM=450;var eD=0;var eK=0;try{eD=window.screenY+Math.max(0,Math.floor((dU(window).height()-eM)/2));eK=window.screenX+Math.max(0,Math.floor((dU(window).width()-eG)/2))}catch(eJ){}dU("body").append(eE);var eH=window.open("https://b4g.baydin.com/mailcruncher/login?guser="+eC,"","width="+eG+",height="+eM+",location=1,status=1,resizable=1,top="+eD+",left="+eK);var eF=setInterval(function(){if(!eH&&ci!=="Chrome"||eH.closed){eE.remove();clearInterval(eF);if(ci.indexOf("Safari")===-1&&ci.indexOf("Firefox")===-1){a7("https://b4g.baydin.com/mailcruncher/checklogin?guser="+eC+"&hasAlreadyAuthenticated=True",eI,eL)}else{a7("https://b4g.baydin.com/mailcruncher/checklogin?guser="+eC,eI,eL)}}},100)}var eB=aq();var ey="https://b4g.baydin.com/mailcruncher/checklogin?guser="+eB;a7(ey,ev,"")}var es=aq();var et={guser:es};if(eq){et.hasAlreadyAuthenticated="True"}dU.ajax({url:"https://b4g.baydin.com/mailcruncher/checklogin2",data:et,type:"GET",xhr:x,success:function(ex){var ev=ex.status;if(ev==="success"){var ey=ex.plan;A("b4g_plan-"+es,ey);var ew=ex.preferences;A("b4g_preferences-"+es,JSON.stringify(ew))}eu(ev)},error:function(){A("b4g_plan-"+es,"pro - trial");er(em,ek);bw(["dev","checkloginerror",ci])}})}function eo(eq){if(eq==="unauthenticated"){el(en)}else{if(eq==="success"){em();bs()}else{if(eq==="paywall"){t(be)}}}}function en(er){if(er==="success"){em();bs()}else{if(er==="paywall"){t(be)}else{if(er==="cookies"){bH("Attempt failed: "+bm[w]);if(ek){ek("Failed to authenticate.")}}else{if(ci==="Firefox"){bH(Q)}else{if(ci==="Safari"||ci==="Old Safari"){var eq=dU(bP);dU("body").append(eq);dU("#safari-boomerang").click(function(){eo(er);eq.remove()})}else{bH("Attempt failed: Failed to authenticate");if(ek){ek("Failed to authenticate.")}}}}}}}function el(ez){var ev,er=aq();if(ci==="Chrome"){ev=dU(cq);setTimeout(eg,5000)}else{ev=dU(ch)}var eu=800;var ey=600;var ex=0;var es=0;try{ex=window.screenY+Math.max(0,Math.floor((dU(window).height()-ey)/2));es=window.screenX+Math.max(0,Math.floor((dU(window).width()-eu)/2))}catch(et){}dU("body").append(ev);var ew=window.open("https://b4g.baydin.com/mailcruncher/login?guser="+er,"","width="+eu+",height="+ey+",location=1,status=1,resizable=1,top="+ex+",left="+es);var eq=setInterval(function(){if((!ew&&ci!=="Chrome")||ew.closed){ev.remove();clearInterval(eq);if(ci.indexOf("Safari")===-1&&ci.indexOf("Firefox")===-1){ep(ez,true)}else{ep(ez,false)}}},100)}ep(eo,false)}function cY(ek){var en=new Date();var em=ek;if(en>em){return new Date()}var el=Math.floor(Math.random()*(em-en));var eo=new Date(en.valueOf()+el);return eo}function dX(em,ek){var el=new Date(em);var en=Date.parse(ek);if(en==null){return new Date().addDays(7)}else{if(en.clearTime()<el.clearTime()){return new Date(en.addDays(7))}}return new Date(en)}function aH(el){var ek=/dinner|evening|night|party/i;return !ek.test(el)}function T(er,ep,ek,el){var eq=er.toLowerCase();eq=eq.replace(/(th|rd|nd|st)/g,"");eq=eq.replace(/augu/g,"august");eq=eq.replace(/september/g,"sep");eq=eq.replace(/sept/g,"sep");var eo=hasYear(eq);if(!eo){eq+=", "+el.getFullYear()}var en=ep.toLowerCase();en=en.replace(/noon/g,"12:00pm");en=en.replace(/midnight/g,"12:00am");en=en.replace(/at|to|from|until|around/g,"");en=en.replace(/[ \.\-\n\r\t]/g,"");en=en.replace(/o('|’)?clock|ish/g,":00");en=en.replace(/(a\.?m\.?)/g,"am");en=en.replace(/(p\.?m\.?)/g,"pm");if(/^\d+$/.test(en)){en+=":00"}if(/^\d?\d:?\d*:?\d*$/.test(en)){if(/^(8|9|10|11):?\d*:?\d*$/.test(en)&&ek){en+="am"}else{en+="pm"}}var em=Date.parse(eq+" "+en);if(em==null){return null}if(!/((a|p)\.?m\.?)/i.test(ep)&&ep&&em<el){em=em.addHours(12)}if(!eo&&em<el&&em.clone().addDays(21)<new Date()){em=em.addYears(1)}return em}function cK(en,em){var ek=[];var el=new Date(en);ek.push(new Date(el));el=new Date(en).clearTime().addDays(-7).addHours(em);ek.push(new Date(el));el=new Date(en).clearTime().addDays(-1).addHours(em);ek.push(new Date(el));el=new Date(en).clearTime().addHours(em);ek.push(new Date(el));el=new Date(en).clearTime().addHours(12);ek.push(new Date(el));el=new Date(en).clearTime().addDays(1).addHours(em);ek.push(new Date(el));el=new Date(en).clearTime().addDays(7).addHours(em);ek.push(new Date(el));return ek}function b5(ek,el,eq){if(ek==null){return[]}var en=extractDate(ek);var em=extractTime(ek);var er=extractDay(ek);var ep=aH(ek);if(em==null){em="6:45am"}var eo=[];var es=null;if(en!=null){es=T(en,em,ep,el)}else{if(er!=null){es=T(dX(el,er).toString("MMM d yyyy"),em,ep,el)}}if(es!=null){eo=cK(es,eq)}return eo}function dH(el,er,ek){if(typeof ek==="undefined"){ek=true}var eq=new Date();var en=eq.getHours();var eo=false;if(en<4){eo=true}var em=Math.floor(Math.random()*30)-15;try{switch(el.toLowerCase()){case"in 1 hour":eq=eq.addHours(1);break;case"in 2 hours":eq=eq.addHours(2);break;case"in 4 hours":eq=eq.addHours(4);break;case"tomorrow morning":eq=Date.today().addDays(1).addHours(er);if(ek){eq.addMinutes(em)}if(eo){eq=eq.addDays(-1)}break;case"tomorrow afternoon":eq=Date.today().addDays(1).addHours(12);if(ek){eq.addMinutes(em)}if(eo){eq=eq.addDays(-1)}break;case"in 1 day":eq=new Date().addDays(1);break;case"in 2 days":eq=new Date().addDays(2);break;case"in 4 days":eq=new Date().addDays(4);break;case"in 1 week":eq=new Date().addWeeks(1);break;case"in 2 weeks":eq=new Date().addWeeks(2);break;case"in 1 month":eq=new Date().addMonths(1);break;case"- by 5pm today":eq=cY(Date.today().addHours(17));break;case"- within 1 week":eq=cY(Date.today().addDays(7));break;case"- within 1 month":eq=cY(Date.today().addMonths(1));break;default:eq=ba(el)}}catch(ep){eq=el}dE=eq;return eq}function au(el,ek){if(el==null){return"Not a valid date/time"}var em=ed(el,ek);em+=" "+g(el,ek);return em}function ed(el,ek){if(el.is().today()){return ek?"Today":"today"}else{if(Date.today().add(1).days().same().day(el)){return ek?"Tomorrow":"tomorrow"}else{return(ek?"":"on ")+el.toString("ddd, MMM d, yyyy")}}}function g(el,ek){return(ek?"":"at ")+el.toString("h:mm tt")}function o(eo){var el=I;var en=eo.match(el);var ek="";for(var em=0;en!=null&&em<en.length;em++){ek+=en[em];if(em<en.length-1){ek+=" "}}return ek}function aj(eo){var ek=/^Subject:/m;var em=eo.search(ek);if(em>0){eo=eo.substring(em)}var el=/Show quoted text/;var en=eo.search(el);if(en>0){eo=eo.substring(0,en)}return eo}function dz(el){var en;var ek=el.length;var em=[];var eo={};for(en=0;en<ek;en++){eo[el[en]]=0}for(en in eo){if(eo.hasOwnProperty(en)){em.push(en)}}return em}Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};(function(){var el=Date,ek=el.prototype,en=el.CultureInfo,eq=function(es,er){if(!er){er=2}return("000"+es).slice(er*-1)};ek.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};ek.setTimeToNow=function(){var er=new Date();this.setHours(er.getHours());this.setMinutes(er.getMinutes());this.setSeconds(er.getSeconds());this.setMilliseconds(er.getMilliseconds());return this};el.today=function(){return new Date().clearTime()};el.compare=function(es,er){if(isNaN(es)||isNaN(er)){throw new Error(es+" - "+er)}else{if(es instanceof Date&&er instanceof Date){return(es<er)?-1:(es>er)?1:0}else{throw new TypeError(es+" - "+er)}}};el.equals=function(es,er){return(es.compareTo(er)===0)};el.getDayNumberFromName=function(es){var ew=en.dayNames,er=en.abbreviatedDayNames,ev=en.shortestDayNames,eu=es.toLowerCase();for(var et=0;et<ew.length;et++){if(ew[et].toLowerCase()==eu||er[et].toLowerCase()==eu||ev[et].toLowerCase()==eu){return et}}return -1};el.getMonthNumberFromName=function(es){var ev=en.monthNames,er=en.abbreviatedMonthNames,eu=es.toLowerCase();for(var et=0;et<ev.length;et++){if(ev[et].toLowerCase()==eu||er[et].toLowerCase()==eu){return et}}return -1};el.isLeapYear=function(er){return((er%4===0&&er%100!==0)||er%400===0)};el.getDaysInMonth=function(er,es){return[31,(el.isLeapYear(er)?29:28),31,30,31,30,31,31,30,31,30,31][es]};el.getTimezoneAbbreviation=function(eu){var et=en.timezones,es;for(var er=0;er<et.length;er++){if(et[er].offset===eu){return et[er].name}}return null};el.getTimezoneOffset=function(er){var eu=en.timezones,et;for(var es=0;es<eu.length;es++){if(eu[es].name===er.toUpperCase()){return eu[es].offset}}return null};ek.clone=function(){return new Date(this.getTime())};ek.compareTo=function(er){return Date.compare(this,er)};ek.equals=function(er){return Date.equals(this,er||new Date())};ek.between=function(es,er){return this.getTime()>=es.getTime()&&this.getTime()<=er.getTime()};ek.isAfter=function(er){return this.compareTo(er||new Date())===1};ek.isBefore=function(er){return(this.compareTo(er||new Date())===-1)};ek.isToday=function(){return this.isSameDay(new Date())};ek.isSameDay=function(er){return this.clone().clearTime().equals(er.clone().clearTime())};ek.addMilliseconds=function(er){this.setMilliseconds(this.getMilliseconds()+er);return this};ek.addSeconds=function(er){return this.addMilliseconds(er*1000)};ek.addMinutes=function(er){return this.addMilliseconds(er*60000)};ek.addHours=function(er){return this.addMilliseconds(er*3600000)};ek.addDays=function(er){this.setDate(this.getDate()+er);return this};ek.addWeeks=function(er){return this.addDays(er*7)};ek.addMonths=function(er){var es=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+er);this.setDate(Math.min(es,el.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};ek.addYears=function(er){return this.addMonths(er*12)};ek.add=function(es){if(typeof es=="number"){this._orient=es;return this}var er=es;if(er.milliseconds){this.addMilliseconds(er.milliseconds)}if(er.seconds){this.addSeconds(er.seconds)}if(er.minutes){this.addMinutes(er.minutes)}if(er.hours){this.addHours(er.hours)}if(er.weeks){this.addWeeks(er.weeks)}if(er.months){this.addMonths(er.months)}if(er.years){this.addYears(er.years)}if(er.days){this.addDays(er.days)}return this};var eo,ep,em;ek.getWeek=function(){var ey,ex,ew,ev,eu,et,es,er,eA,ez;eo=(!eo)?this.getFullYear():eo;ep=(!ep)?this.getMonth()+1:ep;em=(!em)?this.getDate():em;if(ep<=2){ey=eo-1;ex=(ey/4|0)-(ey/100|0)+(ey/400|0);ew=((ey-1)/4|0)-((ey-1)/100|0)+((ey-1)/400|0);eA=ex-ew;eu=0;et=em-1+(31*(ep-1))}else{ey=eo;ex=(ey/4|0)-(ey/100|0)+(ey/400|0);ew=((ey-1)/4|0)-((ey-1)/100|0)+((ey-1)/400|0);eA=ex-ew;eu=eA+1;et=em+((153*(ep-3)+2)/5)+58+eA}es=(ey+ex)%7;ev=(et+es-eu)%7;er=(et+3-ev)|0;if(er<0){ez=53-((es-eA)/5|0)}else{if(er>364+eA){ez=1}else{ez=(er/7|0)+1}}eo=ep=em=null;return ez};ek.getISOWeek=function(){eo=this.getUTCFullYear();ep=this.getUTCMonth()+1;em=this.getUTCDate();return eq(this.getWeek())};ek.setWeek=function(er){return this.moveToDayOfWeek(1).addWeeks(er-this.getWeek())};el._validate=function(eu,et,er,es){if(typeof eu=="undefined"){return false}else{if(typeof eu!="number"){throw new TypeError(eu+" is not a Number.")}else{if(eu<et||eu>er){throw new RangeError(eu+" is not a valid value for "+es+".")}}}return true};el.validateMillisecond=function(er){return el._validate(er,0,999,"millisecond")};el.validateSecond=function(er){return el._validate(er,0,59,"second")};el.validateMinute=function(er){return el._validate(er,0,59,"minute")};el.validateHour=function(er){return el._validate(er,0,23,"hour")};el.validateDay=function(es,er,et){return el._validate(es,1,el.getDaysInMonth(er,et),"day")};el.validateMonth=function(er){return el._validate(er,0,11,"month")};el.validateYear=function(er){return el._validate(er,0,9999,"year")};ek.set=function(er){if(el.validateMillisecond(er.millisecond)){this.addMilliseconds(er.millisecond-this.getMilliseconds())}if(el.validateSecond(er.second)){this.addSeconds(er.second-this.getSeconds())}if(el.validateMinute(er.minute)){this.addMinutes(er.minute-this.getMinutes())}if(el.validateHour(er.hour)){this.addHours(er.hour-this.getHours())}if(el.validateMonth(er.month)){this.addMonths(er.month-this.getMonth())}if(el.validateYear(er.year)){this.addYears(er.year-this.getFullYear())}if(el.validateDay(er.day,this.getFullYear(),this.getMonth())){this.addDays(er.day-this.getDate())}if(er.timezone){this.setTimezone(er.timezone)}if(er.timezoneOffset){this.setTimezoneOffset(er.timezoneOffset)}if(er.week&&el._validate(er.week,0,53,"week")){this.setWeek(er.week)}return this};ek.moveToFirstDayOfMonth=function(){return this.set({day:1})};ek.moveToLastDayOfMonth=function(){return this.set({day:el.getDaysInMonth(this.getFullYear(),this.getMonth())})};ek.moveToNthOccurrence=function(es,et){var er=0;if(et>0){er=et-1}else{if(et===-1){this.moveToLastDayOfMonth();if(this.getDay()!==es){this.moveToDayOfWeek(es,-1)}return this}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(es,+1).addWeeks(er)};ek.moveToDayOfWeek=function(er,es){var et=(er-this.getDay()+7*(es||+1))%7;return this.addDays((et===0)?et+=7*(es||+1):et)};ek.moveToMonth=function(et,er){var es=(et-this.getMonth()+12*(er||+1))%12;return this.addMonths((es===0)?es+=12*(er||+1):es)};ek.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1};ek.getTimezone=function(){return el.getTimezoneAbbreviation(this.getUTCOffset())};ek.setTimezoneOffset=function(et){var er=this.getTimezoneOffset(),es=Number(et)*-6/10;return this.addMinutes(es-er)};ek.setTimezone=function(er){return this.setTimezoneOffset(el.getTimezoneOffset(er))};ek.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset())};ek.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset())};ek.getUTCOffset=function(){var es=this.getTimezoneOffset()*-10/6,er;if(es<0){er=(es-10000).toString();return er.charAt(0)+er.substr(2)}else{er=(es+10000).toString();return"+"+er.substr(1)}};ek.getElapsed=function(er){return(er||new Date())-this};if(!ek.toISOString){ek.toISOString=function(){function er(es){return es<10?"0"+es:es}return'"'+this.getUTCFullYear()+"-"+er(this.getUTCMonth()+1)+"-"+er(this.getUTCDate())+"T"+er(this.getUTCHours())+":"+er(this.getUTCMinutes())+":"+er(this.getUTCSeconds())+'Z"'}}ek._toString=ek.toString;ek.toString=function(et){var er=this;if(et&&et.length==1){var eu=en.formatPatterns;er.t=er.toString;switch(et){case"d":return er.t(eu.shortDate);case"D":return er.t(eu.longDate);case"F":return er.t(eu.fullDateTime);case"m":return er.t(eu.monthDay);case"r":return er.t(eu.rfc1123);case"s":return er.t(eu.sortableDateTime);case"t":return er.t(eu.shortTime);case"T":return er.t(eu.longTime);case"u":return er.t(eu.universalSortableDateTime);case"y":return er.t(eu.yearMonth)}}var es=function(ev){switch(ev*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return et?et.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(ev){if(ev.charAt(0)==="\\"){return ev.replace("\\","")}er.h=er.getHours;switch(ev){case"hh":return eq(er.h()<13?(er.h()===0?12:er.h()):(er.h()-12));case"h":return er.h()<13?(er.h()===0?12:er.h()):(er.h()-12);case"HH":return eq(er.h());case"H":return er.h();case"mm":return eq(er.getMinutes());case"m":return er.getMinutes();case"ss":return eq(er.getSeconds());case"s":return er.getSeconds();case"yyyy":return eq(er.getFullYear(),4);case"yy":return eq(er.getFullYear());case"dddd":return en.dayNames[er.getDay()];case"ddd":return en.abbreviatedDayNames[er.getDay()];case"dd":return eq(er.getDate());case"d":return er.getDate();case"MMMM":return en.monthNames[er.getMonth()];case"MMM":return en.abbreviatedMonthNames[er.getMonth()];case"MM":return eq((er.getMonth()+1));case"M":return er.getMonth()+1;case"t":return er.h()<12?en.amDesignator.substring(0,1):en.pmDesignator.substring(0,1);case"tt":return er.h()<12?en.amDesignator:en.pmDesignator;case"S":return es(er.getDate());default:return ev}}):this._toString()}}());(function(){var eA=Date,eq=eA.prototype,eB=eA.CultureInfo,eu=Number.prototype;eq._orient=+1;eq._nth=null;eq._is=false;eq._same=false;eq._isSecond=false;eu._dateElement="day";eq.next=function(){this._orient=+1;return this};eA.next=function(){return eA.today().next()};eq.last=eq.prev=eq.previous=function(){this._orient=-1;return this};eA.last=eA.prev=eA.previous=function(){return eA.today().last()};eq.is=function(){this._is=true;return this};eq.same=function(){this._same=true;this._isSecond=false;return this};eq.today=function(){return this.same().day()};eq.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun())}return false};eq.at=function(eF){return(typeof eF==="string")?eA.parse(this.toString("d")+" "+eF):this.set(eF)};eu.fromNow=eu.after=function(eF){var eG={};eG[this._dateElement]=this;return((!eF)?new Date():eF.clone()).add(eG)};eu.ago=eu.before=function(eF){var eG={};eG[this._dateElement]=this*-1;return((!eF)?new Date():eF.clone()).add(eG)};var eo=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),er=("january february march april may june july august september october november december").split(/\s/),et=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),ev=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),el=("final first second third fourth fifth").split(/\s/),eD;eq.toObject=function(){var eG={};for(var eF=0;eF<et.length;eF++){eG[et[eF].toLowerCase()]=this["get"+ev[eF]]()}return eG};eA.fromObject=function(eF){eF.week=null;return Date.today().set(eF)};var eC=function(eF){return function(){if(this._is){this._is=false;return this.getDay()==eF}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1)}this._isSecond=false;var eH=this._nth;this._nth=null;var eG=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(eF,eH);if(this>eG){throw new RangeError(eA.getDayName(eF)+" does not occur "+eH+" times in the month of "+eA.getMonthName(eG.getMonth())+" "+eG.getFullYear()+".")}return this}return this.moveToDayOfWeek(eF,this._orient)}};var ep=function(eF){return function(){var eH=eA.today(),eG=eF-eH.getDay();if(eF===0&&eB.firstDayOfWeek===1&&eH.getDay()!==0){eG=eG+7}return eH.addDays(eG)}};for(var ez=0;ez<eo.length;ez++){eA[eo[ez].toUpperCase()]=eA[eo[ez].toUpperCase().substring(0,3)]=ez;eA[eo[ez]]=eA[eo[ez].substring(0,3)]=ep(ez);eq[eo[ez]]=eq[eo[ez].substring(0,3)]=eC(ez)}var eE=function(eF){return function(){if(this._is){this._is=false;return this.getMonth()===eF}return this.moveToMonth(eF,this._orient)}};var es=function(eF){return function(){return eA.today().set({month:eF,day:1})}};for(var ey=0;ey<er.length;ey++){eA[er[ey].toUpperCase()]=eA[er[ey].toUpperCase().substring(0,3)]=ey;eA[er[ey]]=eA[er[ey].substring(0,3)]=es(ey);eq[er[ey]]=eq[er[ey].substring(0,3)]=eE(ey)}var em=function(eF){return function(){if(this._isSecond){this._isSecond=false;return this}if(this._same){this._same=this._is=false;var eK=this.toObject(),eJ=(arguments[0]||new Date()).toObject(),eI="",eH=eF.toLowerCase();for(var eG=(et.length-1);eG>-1;eG--){eI=et[eG].toLowerCase();if(eK[eI]!=eJ[eI]){return false}if(eH==eI){break}}return true}if(eF.substring(eF.length-1)!="s"){eF+="s"}return this["add"+eF](this._orient)}};var en=function(eF){return function(){this._dateElement=eF;return this}};for(var ex=0;ex<et.length;ex++){eD=et[ex].toLowerCase();eq[eD]=eq[eD+"s"]=em(et[ex]);eu[eD]=eu[eD+"s"]=en(eD)}eq._ss=em("Second");var ek=function(eF){return function(eG){if(this._same){return this._ss(arguments[0])}if(eG||eG===0){return this.moveToNthOccurrence(eG,eF)}this._nth=eF;if(eF===2&&(eG===undefined||eG===null)){this._isSecond=true;return this.addSeconds(this._orient)}return this}};for(var ew=0;ew<el.length;ew++){eq[el[ew]]=(ew===0)?ek(-1):ek(ew)}}());(function(){var ek,eq;Date.Parsing={Exception:function(eu){this.message="Parse error at '"+eu.substring(0,10)+" ...'"}};var et=Date.Parsing;var er=et.Operators={rtoken:function(eu){return function(ev){var ew=ev.match(eu);if(ew){return([ew[0],ev.substring(ew[0].length)])}else{throw new et.Exception(ev)}}},token:function(eu){return function(ev){return er.rtoken(new RegExp("^\\s*"+ev+"\\s*"))(ev)}},stoken:function(eu){return er.rtoken(new RegExp("^"+eu))},until:function(eu){return function(ev){var ew=[],ey=null;while(ev.length){try{ey=eu.call(this,ev)}catch(ex){ew.push(ey[0]);ev=ey[1];continue}break}return[ew,ev]}},many:function(eu){return function(ev){var ey=[],ew=null;while(ev.length){try{ew=eu.call(this,ev)}catch(ex){return[ey,ev]}ey.push(ew[0]);ev=ew[1]}return[ey,ev]}},optional:function(eu){return function(ev){var ew=null;try{ew=eu.call(this,ev)}catch(ex){return[null,ev]}return[ew[0],ew[1]]}},not:function(eu){return function(ev){try{eu.call(this,ev)}catch(ew){return[null,ev]}throw new et.Exception(ev)}},ignore:function(eu){return eu?function(ev){var ew=null;ew=eu.call(this,ev);return[null,ew[1]]}:null},product:function(){var ev=arguments[0],ew=Array.prototype.slice.call(arguments,1),ex=[];for(var eu=0;eu<ev.length;eu++){ex.push(er.each(ev[eu],ew))}return ex},cache:function(ew){var eu={},ev=null;return function(ex){try{ev=eu[ex]=(eu[ex]||ew.call(this,ex))}catch(ey){ev=eu[ex]=ey}if(ev instanceof et.Exception){throw ev}else{return ev}}},any:function(){var eu=arguments;return function(ew){var ex=null;for(var ev=0;ev<eu.length;ev++){if(eu[ev]==null){continue}try{ex=(eu[ev].call(this,ew))}catch(ey){ex=null}if(ex){return ex}}throw new et.Exception(ew)}},each:function(){var eu=arguments;return function(ew){var ez=[],ex=null;for(var ev=0;ev<eu.length;ev++){if(eu[ev]==null){continue}try{ex=(eu[ev].call(this,ew))}catch(ey){throw new et.Exception(ew)}ez.push(ex[0]);ew=ex[1]}return[ez,ew]}},all:function(){var ev=arguments,eu=eu;return eu.each(eu.optional(ev))},sequence:function(eu,ev,ew){ev=ev||er.rtoken(/^\s*/);ew=ew||null;if(eu.length==1){return eu[0]}return function(eC){var eD=null,eE=null;var eG=[];for(var eB=0;eB<eu.length;eB++){try{eD=eu[eB].call(this,eC)}catch(eF){break}eG.push(eD[0]);try{eE=ev.call(this,eD[1])}catch(eA){eE=null;break}eC=eE[1]}if(!eD){throw new et.Exception(eC)}if(eE){throw new et.Exception(eE[1])}if(ew){try{eD=ew.call(this,eD[1])}catch(ez){throw new et.Exception(eD[1])}}return[eG,(eD?eD[1]:eC)]}},between:function(ev,ew,eu){eu=eu||ev;var ex=er.each(er.ignore(ev),ew,er.ignore(eu));return function(ey){var ez=ex.call(this,ey);return[[ez[0][0],ek[0][2]],ez[1]]}},list:function(eu,ev,ew){ev=ev||er.rtoken(/^\s*/);ew=ew||null;return(eu instanceof Array?er.each(er.product(eu.slice(0,-1),er.ignore(ev)),eu.slice(-1),er.ignore(ew)):er.each(er.many(er.each(eu,er.ignore(ev))),eq,er.ignore(ew)))},set:function(eu,ev,ew){ev=ev||er.rtoken(/^\s*/);ew=ew||null;return function(eL){var ez=null,eB=null,eA=null,eC=null,eD=[[],eL],eK=false;for(var eF=0;eF<eu.length;eF++){eA=null;eB=null;ez=null;eK=(eu.length==1);try{ez=eu[eF].call(this,eL)}catch(eI){continue}eC=[[ez[0]],ez[1]];if(ez[1].length>0&&!eK){try{eA=ev.call(this,ez[1])}catch(eJ){eK=true}}else{eK=true}if(!eK&&eA[1].length===0){eK=true}if(!eK){var eG=[];for(var eE=0;eE<eu.length;eE++){if(eF!=eE){eG.push(eu[eE])}}eB=er.set(eG,ev).call(this,eA[1]);if(eB[0].length>0){eC[0]=eC[0].concat(eB[0]);eC[1]=eB[1]}}if(eC[1].length<eD[1].length){eD=eC}if(eD[1].length===0){break}}if(eD[0].length===0){return eD}if(ew){try{eA=ew.call(this,eD[1])}catch(eH){throw new et.Exception(eD[1])}eD[1]=eA[1]}return eD}},forward:function(eu,ev){return function(ew){return eu[ev].call(this,ew)}},replace:function(ev,eu){return function(ew){var ex=ev.call(this,ew);return[eu,ex[1]]}},process:function(ev,eu){return function(ew){var ex=ev.call(this,ew);return[eu.call(this,ex[0]),ex[1]]}},min:function(eu,ev){return function(ew){var ex=ev.call(this,ew);if(ex[0].length<eu){throw new et.Exception(ew)}return ex}}};var en=function(eu){return function(){var ev=null,ey=[];if(arguments.length>1){ev=Array.prototype.slice.call(arguments)}else{if(arguments[0] instanceof Array){ev=arguments[0]}}if(ev){for(var ex=0,ew=ev.shift();ex<ew.length;ex++){ev.unshift(ew[ex]);ey.push(eu.apply(null,ev));ev.shift();return ey}}else{return eu.apply(null,arguments)}}};var es="optional not ignore cache".split(/\s/);for(var em=0;em<es.length;em++){er[es[em]]=en(er[es[em]])}var eo=function(eu){return function(){if(arguments[0] instanceof Array){return eu.apply(null,arguments[0])}else{return eu.apply(null,arguments)}}};var ep="each any all".split(/\s/);for(var el=0;el<ep.length;el++){er[ep[el]]=eo(er[ep[el]])}}());(function(){var eo=Date,eu=eo.prototype,ep=eo.CultureInfo;var eq=function(ew){var ex=[];for(var ev=0;ev<ew.length;ev++){if(ew[ev] instanceof Array){ex=ex.concat(eq(ew[ev]))}else{if(ew[ev]){ex.push(ew[ev])}}}return ex};eo.Grammar={};eo.Translator={hour:function(ev){return function(){this.hour=Number(ev)}},minute:function(ev){return function(){this.minute=Number(ev)}},second:function(ev){return function(){this.second=Number(ev)}},meridian:function(ev){return function(){this.meridian=ev.slice(0,1).toLowerCase()}},timezone:function(ev){return function(){var ew=ev.replace(/[^\d\+\-]/g,"");if(ew.length){this.timezoneOffset=Number(ew)}else{this.timezone=ev.toLowerCase()}}},day:function(ev){var ew=ev[0];return function(){this.day=Number(ew.match(/\d+/)[0])}},month:function(ev){return function(){this.month=(ev.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(ev)/4:Number(ev)-1}},year:function(ev){return function(){var ew=Number(ev);this.year=((ev.length>2)?ew:(ew+(((ew+2000)<ep.twoDigitYearMax)?2000:1900)))}},rday:function(ev){return function(){switch(ev){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break}}},finishExact:function(ev){ev=(ev instanceof Array)?ev:[ev];for(var ex=0;ex<ev.length;ex++){if(ev[ex]){ev[ex].call(this)}}var ew=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=ew.getDate()}if(!this.year){this.year=ew.getFullYear()}if(!this.month&&this.month!==0){this.month=ew.getMonth()}if(!this.day){this.day=1}if(!this.hour){this.hour=0}if(!this.minute){this.minute=0}if(!this.second){this.second=0}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.day>eo.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.")}var ey=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){ey.set({timezone:this.timezone})}else{if(this.timezoneOffset){ey.set({timezoneOffset:this.timezoneOffset})}}return ey},finish:function(ev){ev=(ev instanceof Array)?eq(ev):[ev];if(ev.length===0){return null}for(var eA=0;eA<ev.length;eA++){if(typeof ev[eA]=="function"){ev[eA].call(this)}}var ex,ew=eo.today();if(this.now&&!this.unit&&!this.operator){return new Date()}else{if(this.now){ew=new Date()}}var eB=!!(this.days&&this.days!==null||this.orient||this.operator);var eC,ez,ey;ey=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){ew.setTimeToNow()}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;eB=true}}if(!eB&&this.weekday&&!this.day&&!this.days){ex=Date[this.weekday]();this.day=ex.getDate();if(!this.month){this.month=ex.getMonth()}this.year=ex.getFullYear()}if(eB&&this.weekday&&this.unit!="month"){this.unit="day";eC=(eo.getDayNumberFromName(this.weekday)-ew.getDay());ez=7;this.days=eC?((eC+(ey*ez))%ez):(ey*ez)}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1}if(this.month&&!this.day&&this.value){ew.set({day:this.value*1});if(!eB){this.day=this.value*1}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;eB=true}if(eB&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";eC=(this.month-ew.getMonth());ez=12;this.months=eC?((eC+(ey*ez))%ez):(ey*ez);this.month=null}if(!this.unit){this.unit="day"}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*ey}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1}this[this.unit+"s"]=this.value*ey}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.weekday&&!this.day&&!this.days){ex=Date[this.weekday]();this.day=ex.getDate();if(ex.getMonth()!==ew.getMonth()){this.month=ex.getMonth()}}if((this.month||this.month===0)&&!this.day){this.day=1}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value)}if(eB&&this.timezone&&this.day&&this.days){this.day=this.days}return(eB)?ew.add(this):ew.set(this)}};var er=eo.Parsing.Operators,en=eo.Grammar,et=eo.Translator,el;en.datePartDelimiter=er.rtoken(/^([\s\-\.\,\/\x27]+)/);en.timePartDelimiter=er.stoken(":");en.whiteSpace=er.rtoken(/^\s*/);en.generalDelimiter=er.rtoken(/^(([\s\,]|at|@|on)+)/);var ek={};en.ctoken=function(ez){var ey=ek[ez];if(!ey){var eA=ep.regexPatterns;var ex=ez.split(/\s+/),ew=[];for(var ev=0;ev<ex.length;ev++){ew.push(er.replace(er.rtoken(eA[ex[ev]]),ex[ev]))}ey=ek[ez]=er.any.apply(null,ew)}return ey};en.ctoken2=function(ev){return er.rtoken(ep.regexPatterns[ev])};en.h=er.cache(er.process(er.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),et.hour));en.hh=er.cache(er.process(er.rtoken(/^(0[0-9]|1[0-2])/),et.hour));en.H=er.cache(er.process(er.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),et.hour));en.HH=er.cache(er.process(er.rtoken(/^([0-1][0-9]|2[0-3])/),et.hour));en.m=er.cache(er.process(er.rtoken(/^([0-5][0-9]|[0-9])/),et.minute));en.mm=er.cache(er.process(er.rtoken(/^[0-5][0-9]/),et.minute));en.s=er.cache(er.process(er.rtoken(/^([0-5][0-9]|[0-9])/),et.second));en.ss=er.cache(er.process(er.rtoken(/^[0-5][0-9]/),et.second));en.hms=er.cache(er.sequence([en.H,en.m,en.s],en.timePartDelimiter));en.t=er.cache(er.process(en.ctoken2("shortMeridian"),et.meridian));en.tt=er.cache(er.process(en.ctoken2("longMeridian"),et.meridian));en.z=er.cache(er.process(er.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),et.timezone));en.zz=er.cache(er.process(er.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),et.timezone));en.zzz=er.cache(er.process(en.ctoken2("timezone"),et.timezone));en.timeSuffix=er.each(er.ignore(en.whiteSpace),er.set([en.tt,en.zzz]));en.time=er.each(er.optional(er.ignore(er.stoken("T"))),en.hms,en.timeSuffix);en.d=er.cache(er.process(er.each(er.rtoken(/^([0-2]\d|3[0-1]|\d)/),er.optional(en.ctoken2("ordinalSuffix"))),et.day));en.dd=er.cache(er.process(er.each(er.rtoken(/^([0-2]\d|3[0-1])/),er.optional(en.ctoken2("ordinalSuffix"))),et.day));en.ddd=en.dddd=er.cache(er.process(en.ctoken("sun mon tue wed thu fri sat"),function(ev){return function(){this.weekday=ev}}));en.M=er.cache(er.process(er.rtoken(/^(1[0-2]|0\d|\d)/),et.month));en.MM=er.cache(er.process(er.rtoken(/^(1[0-2]|0\d)/),et.month));en.MMM=en.MMMM=er.cache(er.process(en.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),et.month));en.y=er.cache(er.process(er.rtoken(/^(\d\d?)/),et.year));en.yy=er.cache(er.process(er.rtoken(/^(\d\d)/),et.year));en.yyy=er.cache(er.process(er.rtoken(/^(\d\d?\d?\d?)/),et.year));en.yyyy=er.cache(er.process(er.rtoken(/^(\d\d\d\d)/),et.year));el=function(){return er.each(er.any.apply(null,arguments),er.not(en.ctoken2("timeContext")))};en.day=el(en.d,en.dd);en.month=el(en.M,en.MMM);en.year=el(en.yyyy,en.yy);en.orientation=er.process(en.ctoken("past future"),function(ev){return function(){this.orient=ev}});en.operator=er.process(en.ctoken("add subtract"),function(ev){return function(){this.operator=ev}});en.rday=er.process(en.ctoken("yesterday tomorrow today now"),et.rday);en.unit=er.process(en.ctoken("second minute hour day week month year"),function(ev){return function(){this.unit=ev}});en.value=er.process(er.rtoken(/^\d\d?(st|nd|rd|th)?/),function(ev){return function(){this.value=ev.replace(/\D/g,"")}});en.expression=er.set([en.rday,en.operator,en.value,en.unit,en.orientation,en.ddd,en.MMM]);el=function(){return er.set(arguments,en.datePartDelimiter)};en.mdy=el(en.ddd,en.month,en.day,en.year);en.ymd=el(en.ddd,en.year,en.month,en.day);en.dmy=el(en.ddd,en.day,en.month,en.year);en.date=function(ev){return((en[ep.dateElementOrder]||en.mdy).call(this,ev))};en.format=er.process(er.many(er.any(er.process(er.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(ev){if(en[ev]){return en[ev]}else{throw eo.Parsing.Exception(ev)}}),er.process(er.rtoken(/^[^dMyhHmstz]+/),function(ev){return er.ignore(er.stoken(ev))}))),function(ev){return er.process(er.each.apply(null,ev),et.finishExact)});var es={};var em=function(ev){es[ev]=(es[ev]||en.format(ev)[0]);return es[ev]};en.formats=function(ew){if(ew instanceof Array){var ex=[];for(var ev=0;ev<ew.length;ev++){ex.push(em(ew[ev]))}return er.any.apply(null,ex)}else{return em(ew)}};en._formats=en.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);en._start=er.process(er.set([en.date,en.time,en.expression],en.generalDelimiter,en.whiteSpace),et.finish);en.start=function(ev){try{var ew=en._formats.call({},ev);if(ew[1].length===0){return ew}}catch(ex){}return en._start.call({},ev)};eo._parse=eo.parse;eo.parse=function(ev){var ew=null;if(!ev){return null}if(ev instanceof Date){return ev}try{ew=eo.Grammar.start.call({},ev.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(ex){return null}return((ew[1].length===0)?ew[0]:null)};eo.getParseFunction=function(ew){var ev=eo.Grammar.formats(ew);return function(ex){var ey=null;try{ey=ev.call({},ex)}catch(ez){return null}return((ey[1].length===0)?ey[0]:null)}};eo.parseExact=function(ev,ew){return eo.getParseFunction(ew)(ev)}}());function A(ek,el){if(typeof(localStorage)==="undefined"){bw(["dev","localStorage error","not available"])}else{try{if(typeof(ek)!=="undefined"&&ek!=null){localStorage.setItem(ek,el)}}catch(em){if(em.name==="QUOTA_EXCEEDED_ERR"){bw(["dev","localStorage error","over quota"])}else{bw(["dev","localStorage error","unexpected error -- "+em.name,em.message])}}}}function bS(ek){if(typeof(localStorage)==="undefined"){return null}else{try{return localStorage.getItem(ek)}catch(el){return null}}}function ca(eo){var ek=bS("b4gMenuEntries");var eq={};if(ek==null){eq[eo]=1}else{eq=JSON.parse(ek);var en=eq[eo];if(en==null){b7(eq);eq[eo]=1}else{var ep=[];for(var em in eq){if(eq.hasOwnProperty(em)){ep.push([em,eq[em]])}}ep.sort(function(es,er){return er[1]-es[1]});var el=1;if(ep.length>2){el=ep[2][1]/2}eq[eo]=en+el}}A("b4gMenuEntries",JSON.stringify(eq))}function b7(eo){var en=[];for(var em in eo){if(eo.hasOwnProperty(em)){en.push([em,eo[em]])}}en.sort(function(eq,ep){return ep[1]-eq[1]});if(en.length>25){for(var el=10;el<en.length;el++){delete (eo[en[el][0]])}}if(en[0][1]>1000){for(var ek in eo){if(eo.hasOwnProperty(ek)){eo[ek]=Math.ceil(eo[ek]/25)}}}return eo}function a9(){var ek=bS("b4g-menu-customizations");var el=[];if(ek!=null){el=JSON.parse(ek)["customEntries"]}return el}function ag(){cH();var em="<div id='custom-b4g-container'><div><h3 style='margin:0px;'>Add Your Own</h3><div id='custom_time_input'></div><div class='customize_menu_samples' style='color:#999;padding:2px 0;'>Examples: Tomorrow 8am, Monday 7am, +15 days, +3 weeks, +6 months, Dec 31</div><ul id='b4g_user_menu_option_list' style='padding:0 7px;'></ul></div><div id='customize_b4g_default_menu_options'><h3 style='margin-bottom:4px;'>Show in Menu?</h3><table id='b4g-menu-default-times'><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 1 hour</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 2 hours</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 4 hours</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>Tomorrow morning</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>Tomorrow afternoon</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 2 days</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 4 days</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 1 week</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 2 weeks</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 1 month</span></td></tr></table></div></div>";var ex={Ok:{"class":"b4g-button blue",text:"Update Menu",click:function(){bV();dU(this).dialog("destroy")},},Cancel:{"class":"b4g-button dialog-gray",text:"Cancel",click:function(){dU(this).dialog("destroy")}}};if(ci==="Old Safari"){alert(message);return}else{var eo=bb();dU(".dialogdiv").remove();var et="&nbsp &nbsp &nbsp Customize Boomerang Menu";var er="<div class='dialogdiv' style='display:none;'>"+em+"</div>";dU("body",eo).append(dU(er));dU(".dialogdiv",eo).dialog(dU.extend({title:et,modal:true,height:"auto",closeOnEscape:true,buttons:ex}));al()}var ev={};var eq=JSON.parse(bS("b4g-menu-customizations"));if(eq!=null){ev=eq.defaultEntries}dU("#customize_b4g_default_menu_options .b4g-time-option").parent().parent().each(function(){if(dU(this).text() in ev&&!ev[dU(this).text()]){dU(this).find("input:first").removeAttr("checked")}});var eu=dU("<form onsubmit='return false;'><input style='width:198px;line-height: 16px;' type='text' name='time'/><input type='button' class='by-button by-button-secondary' style='margin: 3px 0 5px 3px;padding:3px 13px;' value='Add'/><div style='color:#969696; margin-left:3px;'><span id='date-preview' style='color:green'></span></div></form>");dU("#custom_time_input").replaceWith(eu);var es=eu.find("input[type=text]");es.focus().select();es.keyup(function(){aQ(dU(this).val())});es.focus(function(){aQ(dU(this).val())});var en=[];if(eq!=null){en=eq.customEntries}for(var ep=0;ep<en.length;ep++){cL(en[ep],dU("#b4g_user_menu_option_list"))}eu.find("input[type=button]").click(function(){Z=ba(es.val());if(Z==null){alert("Boomerang doesn't understand your date format. Please try again.")}else{if(Z<new Date()){alert("This date is in the past. Please try again.")}else{if(dU("#b4g_user_menu_option_list li").length<5){cL(es.val(),dU("#b4g_user_menu_option_list"));es.val("");dU("#date-preview").html("")}else{alert("You can only have five custom times stored right now. Please remove an existing item to add a new one.")}}}});var ew=dU(".dialogdiv").parent().height();var el=dU(window).height();if(ew>el){var ek=dU("#custom-b4g-container").height();dU("#custom-b4g-container").height(ek-(ew-el));dU("#custom-b4g-container").css({"overflow-y":"scroll"})}dU(".dialogdiv").dialog({position:"center"});bw(["Show dialog","Customize Boomerang Menu"])}function cL(en,el){var em=dU("<span style='margin-left:20px;'><img style='cursor:pointer;' src='"+cu+"delete.png'></img></span>");em.click(function(){dU(this).closest("li").remove()});em.hover(function(){dU(this).css("opacity","1")},function(){dU(this).css("opacity",".8")});var ek=dU("<span class='b4g-custom-time-entry'>"+en.charAt(0).toUpperCase()+en.slice(1)+"</span>");el.append(ek);ek.wrap("<li style='list-style:none;padding:2px 0;' />");ek.after(em)}function bV(){var em={};dU("#customize_b4g_default_menu_options .b4g-time-option").each(function(){var en=dU(this).text();var eo=dU(this).closest("tr").find("input:first").attr("checked");em[en]=eo});var el=[];dU("#b4g_user_menu_option_list .b4g-custom-time-entry").each(function(){el.push(dU(this).text())});var ek={};ek.customEntries=el;ek.defaultEntries=em;A("b4g-menu-customizations",JSON.stringify(ek))}function s(el){var ek=new Date();return(ba(el)-(ek.getTime()-(5*60*1000))>0)}function bv(){return dU("button",bt).filter(function(){return dU(this).attr("aria-label")===dU("#gbqfb",bt).attr("aria-label")}).length>0}function cv(){return(p.indexOf("ui=2")>0||p.indexOf("view=cm")>0)&&cP().length===0}function cP(){var ek=bb();return dU("[role='banner']:visible",ek)}function S(el,ek){if(!ek){ek=bb()}return dU("[role='button']",ek).filter(function(){return dU(this).text().trim()===el})}function cB(ek){if(!ek){ek=bb()}var el=dU(".T-I.J-J5-Ji.Bq.nS.T-I-ax7.L3",ek).first().text();if(!el){el=dU(".T-I.J-J5-Ji.Bq.nS.T-I-KE.L3",ek).first().text()}if(!el){el=dU(".T-I.J-J5-Ji.Bq.nS.T-I-ax7.L3",ek).first().text()}if(!el){el=dU(".T-I.J-J5-Ji.aoO.L3.T-I-ax7",ek).first().text()}if(!el){el=dU(".T-I.J-J5-Ji.aoO.T-I-atl.L3",ek).first().text()}if(!el){el="Send"}return el}function bO(el){var ek=dU(".T-I.J-J5-Ji.Uo.T-I-atl.L3",el).first().text();if(!ek){ek=dU(".T-I.J-J5-Ji.Bq.undefined.T-I-ax7.L3",el).first().text()}if(!ek){ek="Send & Archive"}else{ek=ek.replace("&amp;","&")}return ek}function a6(em){if(!em){em=bb()}var en=cB(em);var ek=bO(em);var el=S(en,em).add(S(ek,em));return el}function cj(){return dU(bx,bt).filter(":visible").text()}function aB(){return dU(di,bt).map(function(){return dU(this).attr("email")}).toArray()}function b1(){return dU(bD,bt).map(function(){var ek=dU(this).attr("alt").replace(" at","");if(Date.parse(ek)==null){return null}else{return Date.parse(ek).valueOf()}}).toArray()}var v=".ii";var H=".iH > div [role=button]";var dg=".iH > div";var cy=".dK";var bx=".hP";var di=".gD";var bD=".g3";var cZ=".nH .if > .nH > .nH > .dJ";var c6=".ee";var dZ='<div class="b4g_menu G-asx T-I-J3 J-J5-Ji">&nbsp;</div>';function bN(){var el=dU(".aic").find("[role='button']");if(el.length==0){return true}var ek=el.text();if(ek.toLowerCase().indexOf("compose")>=0){return true}else{return false}}function f(){return document.location.href.indexOf("#inbox")>0||dU(".TK > .ain .afM").length>0}var K=[];var c8=false;function D(ek,ep){c8=false;var eo=ep.notes;var en=ep.conditional;var em,el=dU('.oZ-jc.T-Jo.J-J5-Ji[aria-checked="true"]',bt).filter(":visible");if(el.length===0&&bz()){if(cF()){el=dU('.apo-jc.T-Jo.J-J5-Ji.T-Jo-Jp[aria-checked="true"]',bt).filter(":visible");if(el.length===0){em=dU(".PE").filter(":visible").parent();el=dU("[role='checkbox']",em)}}else{em=dU(".PE").filter(":visible").parent();el=dU("[role='checkbox']",em)}}K=el.map(function(){var ew,ey,ex,es;if(cF()){ew=dU(this).parent().parent();ey=dU("[email]",ew).map(function(){return dU(this).attr("email")}).toArray();ex=dU(".y6 > span",ew.next()).first().text();es=dU(".apm > span",ew).attr("title")}else{ew=dU(this).parent().parent();ey=dU("[email]",ew).map(function(){return dU(this).attr("email")}).toArray();ex=dU(".y6 > span",ew).first().text();es=dU(".xW.xY > span",ew).attr("title")}var eu,et=aq();if(Date.parse(es.replace(" at",""))){eu=Date.parse(es.replace(" at","")).valueOf()}else{eu=null}var eq="https://b4g.baydin.com/mailcruncher/schedulereturnbulk";eq=eq+"?subject="+encodeURIComponent(ex);eq=eq+"&guser="+encodeURIComponent(et);eq=eq+"&sentDates="+encodeURIComponent(JSON.stringify([eu]));eq=eq+"&offset="+encodeURIComponent(ek.valueOf());eq=eq+"&notes="+encodeURIComponent(eo);if(bN()){eq=eq+"&language=English"}else{eq=eq+"&language=notEnglish"}if(en){eq=eq+"&conditional="+encodeURIComponent("True")}else{eq=eq+"&conditional="+encodeURIComponent("False")}if(f()){eq=eq+"&inbox=True"}else{eq=eq+"&inbox=False"}if(p.indexOf("#sent")>0){var er="";for(var ev=0;ev<ey.length;ev++){if(ev>0){er+=", "}er+=ey[ev]}eq=eq+"&to="+encodeURIComponent(er);eq=eq+"&senders="+encodeURIComponent(JSON.stringify(["None"]))}else{eq=eq+"&senders="+encodeURIComponent(JSON.stringify(ey))}var ez={status:"waiting",subject:ex,time:es,address:ey,url:eq,retried:false};return ez});K=K.filter(function(){return(this["address"]!=null)})}function bM(el){var ek="<div class='bulkdialog'>";ek+="<div class='bulkldialogHeader'>Processing "+K.length.toString()+" messages.</div>";ek+="<div class='bulkdialogReturnDate'>Messages will return "+el+" </div>";ek+="<table id='bulkTable'>";ek+="</table>";ek+="</div>";dU(".bulkdialog").remove();dU("body").append(dU(ek));dU(".bulkdialog").dialog({modal:true,width:"750px",resizable:false,dialogClass:"bulk",buttons:[{"class":"b4g-button dialog-gray b4g-bulk-close",text:"Cancel",click:function(){c8=true;a0();dU(this).dialog("destroy")}}],});dU(".b4g-ui-dialog-titlebar").hide();dP();cA()}function dP(){var ek="";for(var el=0;el<K.length;el++){if(K[el]["status"]==="error"){ek+="<tr id='bulkRow-"+el.toString()+"' class='error'>"}else{ek+="<tr id='bulkRow-"+el.toString()+"'>"}ek+="<td class='bulkStatus "+K[el]["status"]+"'>"+K[el]["status"]+"</td>";ek+="<td class='bulkAddress'>"+K[el]["address"]+"</td>";ek+="<td class='bulkSubject'>"+K[el]["subject"]+"</td>";if(K[el]["status"]==="error"&&!K[el]["retried"]){ek+="<td id='bulkRetry-"+el.toString()+"' class='bulkRetry b4g-button'>Retry</td>"}else{ek+="<td id='bulkRetry-"+el.toString()+"' class='bulkRetry'></td>"}ek+="</tr>"}dU("#bulkTable").html(ek);dU(".bulkRetry").click(cz);if(dy()){dU(".b4g-bulk-close").text("Close");if(ei()){setTimeout(function(){dU(".bulkdialog").remove();a0()},5000)}M({type:"return-later",bulk:K.length});cW.expire_cache()}}function cz(){var el=dU(this);var ek=el.attr("id").split("-")[1];K[ek]["retried"]=true;a7(K[ek]["url"],aJ,ek);K[ek]["status"]="processing";dP()}function aJ(em,el,ek){if(em===d0){K[ek]["status"]="success"}else{K[ek]["status"]="error";if(em===dL){bH("Boomerang was not able to locate this email from this folder view. Please open the email and Boomerang it individually.")}else{bH(bm[em])}}dP()}function a0(){var ek=bb();var el=dU("[role='button']",ek);var em=el.filter(function(){return dU(this).attr("act")==="20"});em.each(bh)}function cA(){if(c8){return}for(var ek=0;ek<K.length;ek++){if(K[ek]["status"]==="waiting"){K[ek]["status"]="processing";av(ek);break}}dP()}function dy(){var ek=true;for(var el=0;el<K.length;el++){if(K[el]["status"]!=="success"&&K[el]["status"]!=="error"){ek=false}}return ek}function ei(){var el=true;for(var ek=0;ek<K.length;ek++){if(K[ek]["status"]!=="success"){el=false}}return el}function av(ek){a7(K[ek]["url"],bg,ek)}function bg(en,el,ek){if(en===d0){K[ek]["status"]="success";cA()}else{if(en===dL||en===at){K[ek]["status"]="error";cA()}else{for(var em=0;em<K.length;em++){if(K[em]["status"]!=="success"){K[em]["status"]="error";K[em]["retried"]=true}}bH(bm[en])}}dP()}function dp(){dU(".Cq.aqL>div>div",bt).each(function(){var el=dU(".bulkboomerang",this);var en=dU("[act='10']",this).filter(":visible").length>0;if(el.length===0){var ek=dU("<div aria-haspopup='true' style='-webkit-user-select: none; -moz-user-select:none;margin-bottom:0px;outline: none;' role='button' class='J-J5-Ji W6eDmd L3 J-Zh-I J-J5-Ji Bq L3' tabindex='0'><img class='f tk3N6e-I-J3' src='"+cu+"tinyboomlogo.png' style='vertical-align: middle;'/> Boomerang <div class='VP5otc-d2fWKd tk3N6e-I-J3 J-J5-Ji'> </div></div>");var em=dU("[role='button']",bt).filter(function(){return dU(this).attr("act")==="20"}).attr("class");ek.attr("class","f "+em+" bulkboomerang b4g_button");ek.css("display","inline-block");ek.hide();ek.click(function(eo){aZ(eo,this,cT);bw(["bulk boomerang","click"])});dU(this).append(ek)}if(en&&bN()){el.css("display","inline-block")}else{el.hide()}})}function cT(el){var en=dU("#note_entry",bt).val();if(en==null){en=""}var ek=dH(el,bn);var eo=au(ek,false);var em=dU("#conditionalBoomerang",bt).attr("checked");dU(".b4g_menu",bt).remove();D(ek,{conditional:em,notes:en});if(K.length===0){bH("Please check at least one email to Boomerang.")}else{if(K.length>15){bH("You can Boomerang at most 15 messages at a time. Please Boomerang the messages individually.")}else{R(function(){a8(eo)})}}}function a8(el){var ek="https://b4g.baydin.com/mailcruncher/checkbulkstatus?guser="+aq();ek+="&num="+K.length;a7(ek,cV,el)}function cV(el,ek,em){if(el===d0){bM(em)}else{bH("You don't have enough credits left to Boomerang this many messages. Please Boomerang the messages individually.")}}function eh(){bW("b4g_inner_menu","b4g_menu")}function bW(eq,eo){try{var el=bb();var ep=dU("#"+eq,el);var en=dU("#"+eo,el);var ek=ep.height();en.css("min-height",ep.height()+"px")}catch(em){}}function cw(){var el=bb();dU("#notes_menu",el).toggle();var ek=dU("#b4g_inner_menu",el);ek.children().not("#notes_menu").toggle();dU(".random",ek).hide();eh()}function bz(){return bf()||cF()}function bf(){var ek=bb();return dU(".aph",ek).filter(":visible").length>0}function cF(){var ek=bb();return dU(".apj",ek).filter(":visible").length>0}function aO(){var ep=dU(".gU.Up > .J-J5-Ji");if(ep.find(".by-button").length>0){return}var ek=a.b4goldgid;var el=a.b4gnewtid;var eo=dU('<button class="by-button by-button-secondary" style="height: 30px; margin: 6px 0;"><span class="by-button-text">Save message</span></button>');var en=dU('<button class="by-button" style="height: 30px; margin: 6px 0 6px 5px;"><span class="by-button-text">Cancel</span></button>');var em=false;var er=function(et,ev){var eu=et.responseText||et.error;if(dU.type(eu)!=="string"){eu="Sorry, there was an error. We can't edit your message at the moment. Try again later."}alert(eu);eo.find(".by-button-text").text("Save message");en.find(".by-button-text").text("Cancel")};eo.click(function(){var eu="https://b4g.baydin.com/inline-manage/update-";eu+=(dU(".b4g-inline-send").length>0?"send-later":"recurring");eo.find(".by-button-text").text("Saving...");var et=ce(eo);dG(et,function(ev){dU.ajax({type:"post",url:eu,data:{oldGmailId:ek,newThreadId:el},xhr:x,success:function(ew){if(!ew.success){er(ew);return}window.close()},error:er,dataType:"json"});em=true})});en.click(function(){en.find(".by-button-text").text("Cancelling...");dU.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/delete-draft",data:{gmailId:a.b4gdraftgid},xhr:x,success:function(et){if(!et.success){er(et);return}window.close()},error:er,dataType:"json"});em=true});ep.append(eo).append(en).children(".T-I-atl").remove();var eq=dU(".gU.er");var es=eq.position();if(es){dU(".eq").css("left",es.left+eq.outerWidth()-4)}window.onbeforeunload=window.onunload=function(){if(!em){en.click()}window.opener.postMessage("b4g-edit-window-close","https://mail.google.com")}}function cU(){aO();dU(".T-I-JN.L3 .gx").each(bh).click();if(dU(".h7.Jux0I").length>0){dU(".h7:not(.Jux0I)").hide()}dU(".nH.oy8Mbf.qp",bt).hide();dU(".Bu.y3",bt).hide();dU(".nH.Gn",bt).hide();dU(".cf.gz",bt).hide();dU(".Cp",bt).hide();dU("[role='button']",bt).not(".conditional-caption, .wG.J-Z-I").filter(function(){return dU(this).closest(".aDh, [role='toolbar']").length<=0}).hide();dU(".oh, .az5 .Uz").hide();dU(".boomerang-button",bt).hide();dU(".d2",bt).hide();dU(".hP",bt).hide();dU(".nH > .ha").hide();dU(".aeH").hide();dU(".ar5.J-J5-Ji").hide();dU(".mq, .ae4").hide();dU(".PS").hide();dU(".adz").hide();dU(".w-asV.aiw").hide();dU(".AT").hide();dU("body").addClass("b4g-state-edit-message").attr("style","overflow: auto!important");dU(".nH.oy8Mbf.nn.aeN",bt).css({visibility:"hidden",width:100});dU(".gB.acO").css({"padding-top":0,border:"none"});dU(".adn").css("padding-bottom",0);dU(".G3.G2").css("border","none");dU(".aeJ").css({height:"auto","padding-right":0,overflow:"hidden"});dU(".aeJ")[0].scrollTop=0;var ek=dU(".aoY").width()-(dU(".b4g-inline-manage:visible").outerWidth()-dU(".I5").outerWidth());dU(".aoY").css({visibility:"hidden"}).width(ek);dU("#b4g_clicktoclose",bt).click(function(){dS=false;window.close();setTimeout(function(){window.location="mail.google.com"},250)})}function c7(){return a.b4guser||""}var ef='<div class="sendLaterTable boomerangReply" style="background-color: whiteSmoke; border: 1px solid #CFCFCF; border-width: 0 1px 1px 1px; margin: 0 -1px; overflow-y: hidden;"><table style="width:100%"><tr><td style="width: 80px"><div class="send-later-button tk3N6e-I J-J5-Ji W6eDmd tk3N6e-I-n2to0e L3 J-Zh-I J-J5-Ji Bq L3" aria-haspopup="true" style="-moz-user-select: none; background-color: #D14836; background-image: -webkit-linear-gradient(top,#DD4B39,#D14836); background-image: -moz-linear-gradient(top,#DD4B39,#D14836); background-image: -ms-linear-gradient(top,#DD4B39,#D14836); background-image: linear-gradient(top,#DD4B39,#D14836); color: white; border: 1px solid transparent; padding: 0 9px; -webkit-border-radius: 2px; -moz-border-radius: 2px; border-radius: 2px;cursor: pointer;font-size: 11px; font-weight: bold; white-space: nowrap; margin: 3px; height: 27px;line-height: 27px;min-width: 54px; outline: 0;" tabindex="0">Send Later</div></td> <td style="border-top: none; width: 7px"><div class="Uz"></div></td><td><div class="boomerangSendWidget" style="font-size:11px; float:left;"><label><input type="checkbox" class="boomerangSendCheck" value="boomSend" style="vertical-align:text-bottom;"/><span style="padding-right:4px;"> Boomerang this</span></label><div class="T-I J-J5-Ji Bq lX T-I-ax7 L3 b4g_button sendboomerang-button" style="padding: 1px 2px; height: 20px; font-weight: normal; margin: 0;"><div class="conditional-caption" aria-haspopup="true" style="line-height: 20px;" role="button" tabindex="0"> in 2 days<div class="VP5otc-d2fWKd tk3N6e-I-J3 J-J5-Ji"><div class="b4g_menu G-asx T-I-J3 J-J5-Ji">&nbsp;</div></div></div></div><div class="T-I J-J5-Ji Bq lX T-I-ax7 L3 b4g_button b4g-send-condition" style="height: 20px; top: 3px; margin: 0 0 6px 4px; padding: 1px 0px;"><select name="ifResponse" class="boomerangSendCondition" style="border:0; padding: 2px 1px; background-color: transparent; color: #444; -webkit-appearance: button; vertical-align: middle; margin-bottom: 6px;"><option value="no reply">if no reply</option><option value="no click">if not clicked</option><option value="no open">if not opened</option><option value="always">regardless</option></select></div></div></td><td class="b4g-tracking-toggle-holder"></td></tr></table></div>';function ce(el,en){var em,ek=dU(el);em=ek.closest(".nH.Hd[role='dialog']");if(em.length>0){return em}em=ek.closest(".aoI");if(em.length>0){return em}em=ek.closest(".ip.adB");if(em.length>0){return em}em=ek.find(".aoI");if(em.length>0){return em}if(en!==undefined){return en}bw(["dev","get_compose_container failed"]);return document}function cf(ek){var el=dU(".Am.Al:not(:has(iframe)), .LW-avf, .Am.Al > iframe",ek);if(!el[0]){return null}if(el[0].contentDocument){el=dU(el[0].contentDocument.body)}return el}function E(em){var en=cf(em);var el=dU(".n1tfz .gU > .oG",em).parent();function ek(){var ep=el.text().trim().toLowerCase();if(ep!=="plain text"&&ep!=="rich text"){return}var eo=(ep==="plain text");var eq=(!eo&&eo!==en.data("is-plain-text"));en.data("is-plain-text",eo);var er=dU(".b4g-tracking-toggle",em);if(eq){er.trigger("b4g-toggle-state",!!en.data("had-tracking-enabled"))}if(eo&&er.data("is-selected")){bH("Click tracking and read receipts do not work with plain text emails.");en.data("had-tracking-enabled",er.data("is-selected"));er.trigger("b4g-toggle-state",false)}}new dh(ek).observe(el[0],{childList:true,characterData:true,subtree:true});ek([])}function df(){return Math.random().toString(36).substr(5)+Date.now().toString(36)}function cS(ek){dU("a[href^='http://mailstat.us/tr/opt-out?guid'],img[src^='http://mailstat.us/tr/'],.b4g-open-track",ek).remove()}function F(el,ek){dU("a[href^='http://mailstat.us/tr/opt-out']",el).not(":has(img[src^='http://mailstat.us/tr/'])").remove().end().not("[href='http://mailstat.us/tr/opt-out?guid="+ek+"']").remove();dU("img[src^='http://mailstat.us/tr/']",el).filter(function(){return this.parentNode.tagName.toLowerCase()!=="a"}).remove()}function bZ(ek){if(!ek.tagName){return[]}if(ek.tagName.toLowerCase()==="img"){return[ek]}return dU(ek).find("a, img").andSelf().filter("a, img").toArray()}function aG(em){var eo=dU(".b4g-tracking-toggle",em).data("is-selected");var en=cf(em);if(!eo){cS(en);return}if(!en.data("has-tracking-opt-out-observer")){new dh(function(eq){for(var es=0;es<eq.length;es++){var ew=eq[es];var ev=dU.map(ew.addedNodes||[],bZ);var eu=dU.map(ew.removedNodes||[],bZ);var ep=[].concat(ev,eu);for(var et=0;et<ep.length;et++){var er=ep[et];var ex=er.tagName.toLowerCase();if(ex==="a"&&er.href.indexOf("http://mailstat.us/tr/opt-out?guid=")===0){aG(em);return}if(ex==="img"&&er.src.indexOf("http://mailstat.us/tr/")===0){aG(em);return}}}}).observe(en[0],{childList:true,subtree:true});en.data("has-tracking-opt-out-observer",true)}var el=en.data("thread-guid")||df();en.data("thread-guid",el);var ek=dU("a[href='http://mailstat.us/tr/opt-out?guid="+el+"']:has(img[src^='http://mailstat.us/tr/'])",en);if(ek.length>0){F(en,el);ek.slice(1).remove().end().addClass("b4g-open-track");return}cS(en);ek=dU('<a href="http://mailstat.us/tr/opt-out?guid='+el+'"><img src="http://mailstat.us/tr/optout-blk-nologo.png?guid='+el+'" /></a>').addClass("b4g-open-track");en.append(ek);if(!ek.prev().is("br")){ek.before("<br/>")}}var bI=/\b((?:(?:https?:\/\/)|(?:www\d{0,3}[.])|(?:[a-z0-9.\-]+[.][a-z]{2,4})\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/;function dY(ek){var el=cf(ek);el.find("*:not(a)").andSelf().replaceText(bI,function(eo,en){var em=en;if(em.indexOf("http://")!==0&&em.indexOf("https://")!==0){em="http://"+em}return'<a href="'+em+'" target="_blank">'+en+"</a>"})}var b=/^http:\/\/mailstat\.us\/tr\/t\/[a-z0-9]+\/[a-z0-9]+\/(.*)$/;function cp(el){var ek=b.exec(el);if(ek){return ek[1]}return el}function c4(ek){dU("a[href^='http://mailstat.us/tr/t/']",ek).each(function(){var em=dU(this);if(em.is(".b4g-track-dummy")){em.remove();return}var el=cp(this.href);em.attr("href",el).removeClass("b4g-track-link")})}var m=(function(){var ek=1;return function(){return(ek++).toString(36)}})();function du(ek,el){el=cp(el);return"http://mailstat.us/tr/t/"+ek+"/"+m()+"/"+el}function d1(ek){if(!ek.tagName){return[]}if(ek.tagName.toLowerCase()==="a"){return[ek]}return dU(ek).find("a").toArray()}function G(en){var eq=dU(".b4g-tracking-toggle",en).data("is-selected");var eo=cf(en);if(!eq){c4(eo);return}if(!eo.data("has-click-tracking-observer")){new dh(function(et){for(var ev=0;ev<et.length;ev++){var ez=et[ev];var ey=dU.map(ez.addedNodes||[],d1);var ex=dU.map(ez.removedNodes||[],d1);var es=[].concat(ey,ex);if(ez.type==="attributes"){es.push(ez.target)}for(var ew=0;ew<es.length;ew++){var eu=es[ew];var er=dU(eu).removeClass("b4g-track-link").attr("href");if(er.charAt(0)==="/"){continue}if(dU.inArray(eu,ey)>-1){eu.href=cp(er)}G(en);return}}}).observe(eo[0],{childList:true,attributes:true,subtree:true,attributeFilter:["href"]});eo.data("has-click-tracking-observer",true)}var ep=dU("a:not(.b4g-track-wont)",eo);ep=ep.each(function(){var er=this.href;if(er.indexOf("mailto:")===0){dU(this).addClass("b4g-track-wont")}if(er.indexOf("http://mailstat.us/tr/opt-out?guid=")===0){dU(this).addClass("b4g-track-wont")}}).not(".b4g-track-wont");if(ep.length<=0){var el=dU('<a href="http://mailstat.us/tr/t/dummy"></a>').addClass("b4g-track-link b4g-track-dummy").css({border:"0","text-decoration":"none",width:"1px"}).hide();eo.append(el);return}ep.filter("[href^='http://mailstat.us/tr/t/dummy']:not(.b4g-track-dummy)").addClass("b4g-track-dummy");ep=ep.not(".b4g-track-dummy");if(ep.length>0){dU(".b4g-track-dummy",eo).remove()}ep=ep.not(".b4g-track-link, .b4g-track-wont");if(ep.length<=0){return}var ek=eo.data("thread-guid")||df();eo.data("thread-guid",ek);var em=ep.not("[href^='http://mailstat.us/tr/t/"+ek+"']");if(em.length<=0){ep.addClass("b4g-track-link");return}em.each(function(){var er=du(ek,this.href);dU(this).attr("href",er).addClass("b4g-track-link")})}function c2(el){var en=cf(el);var ek=dU(".n1tfz .gU.oc:not(.b4c-link)",el).first().clone().addClass("b4g-tracking-toggle").removeClass("gU").attr("id",null).css({"text-align":"center",width:44}).hover(function(){dU(".J-Z-I",this).addClass("J-Z-I-JW")},function(){dU(".J-Z-I",this).removeClass("J-Z-I-JW")}).bind("b4g-toggle-state",function(eq,ep){var eo=dU("[role='button']",this);if(ep==null){ep=(eo.attr("aria-selected")!=="true")}eo.toggleClass("J-Z-I-KO",ep).attr("aria-selected",ep+"");dU(this).data("is-selected",ep);if(ep){cW.enable()}}).click(function(){var eo=dU(this);R(function(){eo.trigger("b4g-toggle-state");eb(function(ep){if(ep||!eo.data("is-selected")){return}d7(el)})})}).find("[data-tooltip]").attr("data-tooltip","Request read receipt and track clicks").end().find("[role='button']").attr("id",null).css("width","30px").end().find(".dv").attr("style","background-image: url("+cu+"tracking-toggle.png) !important;background-size: 19px !important;background-position: center -1px !important;").end();dU(".sendLaterTable .b4g-tracking-toggle-holder",el).replaceWith(ek);var em=(dU("a[href^='http://mailstat.us/tr/t/']",en).length>0);em=em||(dU("a[href^='http://mailstat.us/tr/opt-out?guid=']:has(img[src^='http://mailstat.us/tr/'])",en).length>0);ek.trigger("b4g-toggle-state",em).bind("b4g-toggle-state",function(){if(en.data("is-plain-text")){if(dU(this).data("is-selected")){bH("Read receipts and click tracking do not work with plain text emails.");dU(this).trigger("b4g-toggle-state",false)}return false}aG(el);G(el)});dU(".aoO, .send-later-button",el).bind("mousedown focus",function(){var eo=dU(this).closest(".I5,.fN");aG(eo);if(ek.data("is-selected")){dY(eo)}G(eo)});aG(el);G(el);E(el);ah(function(eo){if(eo){return}L(el)})}function d9(){var el=dU(".nH.Hd[role='dialog']");el.each(function(){var em=dU(this);if(!cf(em)){return}ek(em)});function ek(es){var ew=dU(".sendLaterTable",es);if(ew.length===0){var eo=dU(".aDj",es);if(eo.length===0){return}eo.append(ef);dU(".send-later-button",es).click(function(ey){cg(ey,this,false)});dU(".sendboomerang-button",es).click(function(ey){aE(ey,this,false)});try{c2(es)}catch(er){}var en=a6(es);var ep=function(){var ey=dU(".boomerangSendCheck",es).is(":checked");var eA=aw(es);if(ey){var ez=bQ(es);a7(ez,function(eB){if(d3(eB)||eB===be){t(eB)}else{if(eB!==d0){bH("Your most recent Boomerang-on-Send failed. To Boomerang your sent email, please open your message in 'Sent Mail' and Boomerang the message manually. <br/><br/> Error Details:<br/> "+bm[eB])}else{if(eB===d0){M({type:"return-later"});cW.expire_cache()}}}},"success")}else{if(eA){c9(es)}}};en.click(ep).keydown(function(ey){if(ey.which===32||ey.which===13){ep()}});dU(".boomerangSendCheck",es).click(function(){a3(es)});dU(".boomerangSendCheck",es).change(function(){bw(["boomerang this",(dU(this).is(":checked")?"checked":"un-checked")])});dU(".boomerangSendCondition",es).change(function(){dU(".boomerangSendCheck",es).attr("checked",true);a3(es);var ez=dU(this).val();bw(["Send and Boomerang","Change 'if i don't hear back' field",ez]);if(ez==="no click"||ez==="no open"){if(!aw(es)){var ey=dU(".b4g-tracking-toggle",es);ey.trigger("b4g-toggle-state")}}});var ex=42;var em=dU(".GW",es);if(em.length>0){var eu=parseInt(em.css("bottom"),10);var ev=dU(".aoD.hl")[0];var eq=function(){if(dU(ev).is(":visible")){em.css("bottom",eu.toString()+"px")}else{em.css("bottom",(eu+ex-8).toString()+"px")}};var et=new dh(function(ey){ey.forEach(eq)});et.observe(ev,{attributes:true})}if(es.find(".HQ").length===0){dU(".Am.Al",es).focus();setTimeout(function(){dU(".aoD.hl",es).focus()},100)}cC(es);ap.add_compose_listen(es)}}}function db(ek){ek.find(".aB.gQ.pB").click()}function d4(em,el){var eo=ak("bcc",em);if(dU.trim(el).length>0&&eo.indexOf(el)<0){var en=em.find("[name=bcc]").first();var ek=en.val();if(dU.trim(ek).length>0){en.val(ek+", "+el)}else{en.val(el)}}}function cC(em){var ep=aM();if(ep==="premium"){var en=JSON.parse(bS("b4g_preferences-"+aq()));var el=(en.onSendSetting?"checked":"");var eq=(en.onSendOffset==null)?"1_weeks":en.onSendOffset;var er=(en.onSendCond==null)?"reply":en.onSendCond;var eo=(en.readReceipts?"on":"off");if(el==="checked"||eo==="on"){R(function(){if((el==="checked"&&(er==="no click"||er==="no open"))||eo==="on"){if(!aw(em)){var et=dU(".b4g-tracking-toggle",em);et.trigger("b4g-toggle-state")}}var eu=eq.split("_");var ev=" in "+eu[0]+" "+eu[1];var es=e(eu[0],eu[1]);if(el==="checked"){dU(".boomerangSendCheck",em).get(0).checked=(el==="checked")?1:0;dU("[name=ifResponse]",em).val(er);dU(".conditional-caption",em).data("returnDate",es);dU(".conditional-caption",em).text(ev)}})}if(en.crm.active&&(en.crm.bccIncludeWith==="every"||(en.crm.bccIncludeWith==="boomerang"&&el==="checked"))){var ek=en.crm.bccAddress;d4(em,ek)}bw(["Compose Window","boomerang on-send setting applied successfully"])}}function cg(eC,ek,en){var eH=bb();var es=function(eI){cM(eI,ek)};var eD=function(){ad(ek)};var ey=function(){bH("A Pro subscription is required to use this feature. To schedule recurring messages, please upgrade your subscription.","Boomerang for Gmail",{Upgrade:{text:"Upgrade to schedule","class":"b4g-button green",click:function(){window.open("https://b4g.baydin.com/subscriptions","_blank")}},"Never mind":{text:"Never mind","class":"b4g-button dialog-gray",click:function(){dU(this).dialog("destroy")}}},{width:350,dialogClass:"b4g-upgradenag-dialog"});bw(["compose dialog schedule recurring message","blocked non-subscriber"])};var eG=cI(eC);if(eG.className.indexOf("J-Zh-I")===-1&&eG.className.indexOf("f")!==0&&eG.className.indexOf("VP5otc-d2fWKd")===-1){return}var eB=eH.getElementById("b4g_menu");if(eB){cH(eC,ek)}else{bw(["send later compose menu","click"]);dU("div",ek).addClass("J-Zh-I-JO");dU("div",ek).addClass("J-Zh-I-Kq");var eo=(!en)?dU(eC.currentTarget).position().top:(dU(eC.currentTarget).position().top+73);var eF=(!en)?dU(eC.currentTarget).position().left:(dU(eC.currentTarget).position().left+40);var ex='<ul id="b4g_menu" tabindex="0" class="b4g_menu" style="position: absolute; padding: 0px; top:'+eo+"px; left:"+eF+'px;  background-color: rgb(255, 255, 255); -webkit-user-select: none; min-width: 17em;height: auto;min-height: 398px;" role="menu" aria-haspopup="true" aria-activedescendant=""><div id="b4g_inner_menu" class="b4g_menu SK AX" style="-webkit-user-select: none; font-size:12px;padding:0;"><li id="b4g_menu_title" class="menu-caption" style="list-style-type:none;padding: 6px 11px 0 11px;">Send Message:<img id="b4g-menu-customization-button" class="Ha"  data-tooltip="Customize Menu" data-tooltip-delay="400" src="'+cu+'gear.png" height="16px" style="opacity:.9;background:none;height:16px;width:16px;position:absolute;right:13px;top:6px;cursor:pointer;"></li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 6px 11px;background:#ddd;"></li><li class="b4g-standard-times"></li><li class="b4g-custom-times"></li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 0px 11px;background:#ddd;"></li><li class="menu-caption" style="padding:7px 11px 4px 11px;">At a specific time:</li><li class="b4g-menu-option" style="padding: 0 0 7px 11px;"><div style="color: #666; font-style: italic; font-size: 10px; margin-top: 3px;" class="b4g_menu">Examples: "Monday 9am", "Dec 23"</div><form onsubmit="return false;"><div style="padding-top:3px; vertical-align: middle;" class="b4g_menu"><input style="margin-left:1px;padding:3px 22px 2px 2px;" class="b4g_menu" type="text" name="time" id="datepicker"><input id="specific-time-submit" type="submit" value="Confirm" style="margin: 0px 7px 5px 9px;font-size:11px;vertical-align:top;" class="b4g_menu by-button by-button-secondary"></div><div style="color:#969696; margin-left: 1px;"><span id="date-preview" class="b4g_menu" style="color:green;"></span></div></form></li><li class="b4g-menu-divider" style="height:1px;margin:0px 11px;background:#ddd;"></li><li class="b4g-menu-option"><a id="recurring" style="margin:4px 0px;border-width:0px;color:black;cursor:pointer;display:block;padding: 6px 12px;" class="menu-anchor" href="javascript:void(0)"><img id="recurring-image"  class="menu-anchor" src="'+cu+'recurring.png" height="16px" style="vertical-align:middle;"/><span style="vertical-align:middle;margin-left:6px;">Schedule recurring message</span></a></li></div></ul>';var ev=dU(".if > .aHU");if(ev.length==1){ev.append(ex)}else{dU("body").append(ex)}var ep=dU("#b4g_menu",eH);ap.enable_menu_arrow_keys(ep);if(en){var ew='<li class="b4g_menu b4g-menu-option" style="padding:6px;"><input type="checkbox" id="conditionalSendLater" class="b4g_menu" name="condBoomerang"/> Only if nobody replies</li>';dU("#b4g_menu_title",eH).after(ew)}i(dU(".b4g-standard-times",eH));Y(eH);dU(".b4g_menu_item",eH).click(function(){function eI(eJ){es(eJ);bw(["boomerang menu","send later time",eJ])}eI(dU(this).text())});dA(dU(".b4g_menu_item",eH),ac);if(dE==null||dE<new Date()){Z=Date.today().addDays(2).addHours(8)}else{Z=dE}var et=Z.toString("M/d/yyyy h:mm tt");var eu=dU("#datepicker",eH);eu.val(et);eu.keyup(function(){var eI=dU(this).val();aQ(eI)});eu.focus(function(){var eI=dU(this).val();aQ(eI)});dU("input#specific-time-submit",eH).click(function(eI){cD(eI,es)});var em=a9();if(em.length>0){dU(".b4g-custom-times",eH).before("<div class='b4g-menu-divider' style='height:1px;margin:6px 11px;background:#ddd;'></div>");for(var ez=0;ez<em.length;ez++){var eq=c1(em[ez],null);dU(".b4g-custom-times",eH).append(eq)}dU(".b4g-custom-menu-item",eH).click(function(){function eI(eJ){bq(eJ,es);bw(["b4g menu","picked",eJ])}eI(dU(this).text())});dA(dU(".b4g-custom-menu-item",eH),ac)}if(!en||cv()){if(cv()){dU(ek).closest(".HE").after(ep)}else{dU(ek).parent().append(ep)}}var el=dU("#b4g-menu-customization-button",eH);el.click(function(){ag()});el.hover(function(){dU(this).css("opacity","1")},function(){dU(this).css("opacity",".9")});var eE=dU("a#recurring",eH);eE.click(function(){bw(["compose dialog schedule recurring message","clicked"]);aa(eD,ey)});eE.hover(function(){dU(this).addClass("J-N-JT")},function(){dU(this).removeClass("J-N-JT")});dU(eH).bind("click",{owner:ek},az);cN(eu);dU(".b4g-ui-datepicker-trigger",eH).css("cursor","pointer");dU(".b4g-ui-datepicker-trigger",eH).css("margin-left","-21px");dU(".b4g-ui-datepicker-trigger",eH).css("margin-top","-2px");dU(".b4g-ui-datepicker-trigger",eH).hover(function(){dU(this).css("box-shadow","0px 0px 3px #aaa")},function(){dU(this).css("box-shadow","none")});eu.mousedown(function(eI){eI.stopImmediatePropagation()});eu.css("-moz-user-select","text");eu.parents().each(function(){dU(this).css("-moz-user-select","text")});dU("#conditionalSendLater",eH).click(function(){if(dU("[name='subject']:visible",eH).length>0){n("<p>If you change the message subject, the new message becomes part of a separate conversation, so Boomerang's response tracking will not work properly.</p><p>To ensure that responses are detected accurately, please copy your message text, discard this email, and paste the text into a new reply.</p>","Did you change the subject?");dU(this).attr("checked",true)}});eu.select();dU("span#date-preview.b4g_menu",eH).text("");eh();var eA;if(!en){eA=dU(ep).height()-47;dU(ep).css("top","-"+eA+"px")}else{var er=dU(".aDd").length>0;if(cv()&&er){eA=dU(ep).height()-198;dU(ep).css("top","-"+eA+"px");dU(ep).css("left","39px")}else{dU("#b4g_menu").position({of:dU(eC.currentTarget),my:"left bottom",at:"left top"})}}}}function cM(eF,ek){var eB=ce(ek);var es=aq();var ep=bl("subjectbox",eB).val();if(ep.length>200){bH("You've exceeded the maximum subject length. Please shorten your subject and try again.");return}var eA=dU(".J-JN-M-I.J-J5-Ji.az2.az4.L3",eB);if(eA.length>0){eA=o(eA.text())}else{eA=es}var en=ak("to",eB);var ex=ak("cc",eB);var eD=ak("bcc",eB);if(!en&&!ex&&!eD){bH("Please enter a recipient.");return}var eq=en+" "+ex+" "+eD;var ez=I;var el=eq.toLowerCase().match(ez);el=dz(el);if(el.length>100){bH("Boomerang limits you to 100 recipients at a time. Please enter a shorter list.");return}var eo=dH(eF,ac);var ew=au(eo,false);var et=new Date();var eE="0/0";var ev="None";if(dU(".boomerangSendCheck",eB).is(":checked")){var ey=dj(eB);if(ey<=eo){bH("Your Send Later message must be scheduled earlier than your Boomerang reminder.");return}else{ev=ey.valueOf()}}var eC=dU(".boomerangSendCondition",eB).val();var er="";switch(eC){case"no reply":er="reply";break;case"no click":er="click";break;case"no open":er="open";break;case"always":er="none";break;default:er="none"}var em="False";var eG=bb();if(dU("#conditionalSendLater",eG).attr("checked")){em="True"}var eu=bl("draft",eB).val();cH();dU(eB).append('<div class="b4g-ui-widget-overlay b4g-overlay"></div>').append('<div class="b4g-overlay" style="position: absolute; top: 50%; left: 50%; margin: -38px 0 0 -120px; background: white; width: 220px; text-align: center; padding: 10px;"><img height="31" width="31" src="'+cu+'ajax-loader.gif"><br><span style="font-size: 14px;">Scheduling message...</span></div>');if(cc(eB)){bH("Please wait for your attachments to upload before sending.")}else{dG(eB,function(eJ){if(eJ){C();return}var eL=r(eB);if(eL==null||eL==="undefined"){eL=aA()}var eI="https://b4g.baydin.com/mailcruncher/schedulesend";eI+="?guser="+encodeURIComponent(es);eI+="&from="+encodeURIComponent(eA);eI+="&subject="+encodeURIComponent(ep);eI+="&rank="+encodeURIComponent(eE);eI+="&esttimesaved="+encodeURIComponent(et.valueOf());eI+="&offset="+encodeURIComponent(eo.valueOf());eI+="&to="+encodeURIComponent(en);eI+="&cc="+encodeURIComponent(ex);eI+="&bcc="+encodeURIComponent(eD);eI+="&boomerangoffset="+encodeURIComponent(ev);eI+="&boomerangconditional="+encodeURIComponent(er);eI+="&sendlaterconditional="+encodeURIComponent(em);eI=eI+"&threadId="+encodeURIComponent(eL);if(bN()){eI=eI+"&language=English"}else{eI=eI+"&language=notEnglish"}var eK=aw(eB);if(eK){var eH=aN(eB);eI+="&trackingCode="+encodeURIComponent(eH)}ae(eI,ew,eB,{condition:em})})}}function C(){bH("It looks like Gmail hasn't saved this draft yet. Please allow Gmail to autosave (such as by adding an extra space after the email content and waiting until 'Saved' appears), and then click Send Later again.")}function dG(el,eo){window.getSelection().removeAllRanges();dU(cf(el)).append("<span/>").each(bh);dU("[role='toolbar'] > [command='+bold']",el).each(bh);setTimeout(function(){dU("[role='toolbar'] > [command='+bold']",el).each(bh);en()},300);dU(".oG",el).text("");dU(".aOy",el).removeClass("aOy");var em=0,ek=40;var en=function en(){em++;if(em>ek){eo(true);return}var ep=dU(".oG",el);if(ep.hasClass("aOy")||(em>ek-2&&dU.trim(ep.text()).length>0)){setTimeout(function(){eo(null)},2000)}else{setTimeout(function(){en(el,eo)},250)}}}function ae(ek,em,eo,el){el=el||{};var en=String(document.location);var es="Message will be sent "+em+". ";var ep=aw(eo);var eq;if(ep){eq=aN(eo)}R(function(){er()});function er(){setTimeout(function(){dm(eo)},cl);function et(ev,ew,eu){if(ev===d0){if(eq){aY(eq)}M({type:"send-later",isIfNoReply:el.condition==="True"});cW.expire_cache();if(cv()){aF(es,dO,"send_new_compose")}else{a0()}}else{if(d3(ev)){t(ev)}else{if(ev===be){t(ev);window.location=en}else{if(ev!==d0){bH("Attempt failed: "+bm[ev]);window.location=en}}}}}a7(ek,et,es);if(!cv()){aF(es,dO,"send_new_compose")}}}function ad(ek){var ep=bb();var en=ce(ek);cH();if(ci==="Old Safari"){alert("This feature is available in Safari versions 5.1 and higher. Please update Safari to use this feature.")}else{var er=ak("to");var eq=ak("cc");var em=ak("bcc");if(!er&&!eq&&!em){bH("Please enter a recipient.");return}dU(".dialogdiv").remove();var eo="<div class='dialogdiv' style='display:none;'><div id='recurring_dialog'><div id='start_date_time' class='recurring_field'><span class='recurring-row-title'>Starts</span><span id='start_date' class='recurring_right_col'><input id='start_date_input' type='text' name='starts' size='15'/><span id='start_time'>Send Time: <input id='start_time_input' name='time' size='10'/></span></span></div><div  class='recurring_field'><span class='recurring-row-title'>Repeats</span><select id='frequency'  class='recurring_right_col'><option value='day'> Daily</option><option value='week' selected='selected'>Weekly</option><option value='weekday' >Every Weekday</option><option value='month' >Monthly</option><option value='year'>Yearly</option></select></div><div id='num_time_interval'  class='recurring_field'><span class='recurring-row-title'>Every</span><span class='recurring_right_col'><input type='number' value='1' min='1' max='12' name='num_interval' id='num_interval'/><span id='interval'> week</span></span></div><div id='days_of_week'  class='recurring_field'><span class='recurring-row-title'>On</span><span class='recurring_right_col' style='vertical-align: top;'><input class='day_cb' type='checkbox' value='6' name='Sun' style='margin-left:0px'/> Sun<input class='day_cb' type='checkbox' value='0' name='Mon'/> Mon<input class='day_cb' type='checkbox' value='1' name='Tue'/> Tue<input class='day_cb' type='checkbox' value='2' name='Wed'/> Wed<input class='day_cb' type='checkbox' value='3' name='Thur'/> Thur<input class='day_cb' type='checkbox' value='4' name='Fri'/> Fri<input class='day_cb' type='checkbox' value='5' name='Sat'/> Sat</span></div><div  class='recurring_field'><span class='recurring-row-title'> Ends </span><div class='recurring_right_col' style='display:inline-block;vertical-align: middle; line-height: 24px;'><div style='margin-bottom:3px;'><input type='radio' id='radio_num_occurences' name='end_group' checked/> After <input type='number' value='10' min='1' max='100' id='num_occurences' name='num_occurences'/> messages</div><div style='margin-bottom:3px;'><input type='radio' id='radio_end_date' name='end_group'/> On <input id='end_date' value='' name='end_date' size='15'/></div><div style='margin-bottom:3px;'><input type='radio' id='radio_no_end' name='end_group'/> No end date <br/></div></div></div><br/><br/><br/><br/><div id='summary' class='recurring_field'><span class='recurring-row-title'>Summary:</span><div id='recurring_feedback' class='recurring_right_col' style='display:inline-block;padding-right:20px;'> </div></div><div class='b4g-button-container' align='center'><button id='schedule_recurring' class='b4g-button red' style='margin:4px 10px;'> Schedule </button><button id='cancel_recurring' class='b4g-button dialog-gray' style='margin:4px 10px;'>Cancel</button></div><br/></div></div>";dU("body",ep).append(dU(eo));dU(".dialogdiv",ep).dialog({modal:true,title:"Schedule Recurring Message",closeOnEscape:true,width:530,dialogClass:"recurringDialog"});dU(".dialogdiv",ep).css({padding:"0px"});dU("#start_date_input",ep).datepicker({showOn:"button",buttonImage:cu+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,defaultDate:0,minDate:0,});dU("#end_date",ep).datepicker({showOn:"button",buttonImage:cu+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,defaultDate:0,minDate:0,onClose:function(et,es){dU("#radio_end_date").attr("checked",true)},});a4();dU(".b4g-ui-datepicker-trigger",ep).css({cursor:"pointer",margin:"-2px 0px 0px -25px"}).hover(function(){dU(this).css("box-shadow","0px 0px 3px #aaa");dU(this).css("-moz-box-shadow","0px 0px 3px #aaa")},function(){dU(this).css("box-shadow","none");dU(this).css("-moz-box-shadow","none")});dU("#schedule_recurring",ep).click(function(){bd(en);bw("compose dialog recurring dialog","click","schedule recurring")});dU("#cancel_recurring",ep).click(function(){dU(".dialogdiv").dialog("close")});var el=new Date().addMinutes(10);dU("#start_date_input",ep).val(el.toString("MM/dd/yy"));dU("#start_time_input",ep).val(el.toString("hh:mm tt"));if(cv()){dU("#recurring_dialog",ep).css("font-size","1.3em")}bw("compose dialog recurring dialog","show")}}function bd(ek){dU(".dialogdiv").dialog("close");dU(ek).append('<div class="b4g-ui-widget-overlay b4g-overlay"></div>').append('<div class="b4g-overlay" style="position: absolute; top: 50%; left: 50%; margin: -38px 0 0 -120px; background: white; width: 220px; text-align: center; padding: 10px;"><img height="31" width="31" src="'+cu+'ajax-loader.gif"><br><span style="font-size: 14px;">Setting up recurring messages</span></div>');dG(ek,function(el){if(el){C();return}ec(ek,function(){dU(".b4g-overlay",ek).remove()})})}function ec(eI,ev){ev=ev||dU.noop;if(dB()){bH("Please wait for your attachments to upload before sending.");setTimeout(function(){ev({"active-attachments":true})});return}var eC=new Date();var ez=aq();var ew=bl("subjectbox",eI).val();if(ew.length>200){bH("You've exceeded the maximum subject length. Please shorten your subject and try again.");setTimeout(function(){ev({"long-subject":true})});return}var eH=dU(".J-JN-M-I.J-J5-Ji.az2.az4.L3",eI);if(eH.length>0){eH=o(eH.text())}else{eH=ez}var en=ak("to",eI);var eF=ak("cc",eI);var eJ=ak("bcc",eI);if(!en&&!eF&&!eJ){bH("Please enter a recipient.");setTimeout(function(){ev({"no-recipient":true})});return}var ex=en+" "+eF+" "+eJ;var eG=I;var el=ex.toLowerCase().match(eG);el=dz(el);if(el.length>100){bH("<p>Boomerang limits you to 100 recipients at a time. Please enter a shorter list.</p>");setTimeout(function(){ev({"too-many-recipients":true})});return}var es=dU("#start_date_input").val()+" "+dU("#start_time_input").val();var eu=Date.parse(es);if(eu==null||eu<new Date()){alert("Invalid start date");setTimeout(function(){ev({"invalid-start-date":true})});return}var eE=d2();var eK=dU("#num_interval").val();var em=ck(eu);if(em===""){alert("You must select a day of the week.");setTimeout(function(){ev({"no-day-selected":true})});return}var ey="None";var er="None";if(dU("#radio_num_occurences").attr("checked")){ey=dU("#num_occurences").val()}else{if(dU("#radio_end_date").attr("checked")){var ek=dU("#end_date").val();ek=Date.parse(ek);if(ek==null){alert("Invalid end date");setTimeout(function(){ev({"invalid-end-date":true})});return}er=ek.valueOf()}}var eD=r(eI);if(eD==null||eD==="undefined"){eD=aA()}var et="https://b4g.baydin.com/mailcruncher/schedulerecurring";et+="?guser="+encodeURIComponent(ez);et+="&from="+encodeURIComponent(eH);et+="&subject="+encodeURIComponent(ew);et+="&to="+encodeURIComponent(en);et+="&cc="+encodeURIComponent(eF);et+="&bcc="+encodeURIComponent(eJ);et+="&esttimesaved="+encodeURIComponent(eC.valueOf());et+="&frequency="+encodeURIComponent(eE);et+="&interval="+encodeURIComponent(eK);et+="&utc_weekday="+encodeURIComponent(em);et+="&start="+encodeURIComponent(eu.valueOf());et+="&end="+encodeURIComponent(er);et+="&num_occurences="+encodeURIComponent(ey);et+="&threadId="+encodeURIComponent(eD);if(bN()){et=et+"&language=English"}else{et=et+"&language=notEnglish"}var eq=aw(eI);if(eq){var eB=aN(eI);et+="&trackingCode="+encodeURIComponent(eB)}var ep=dU("#recurring_feedback").text();var eA="Recurring message scheduled: "+ep;function eo(){function eL(eN,eO,eM){if(eN===d0||d3(eN)){setTimeout(function(){if(eq){aY(eB)}ev(null);dm(eI)},cl);if(d3(eN)){t(eN)}cW.expire_cache()}else{if(eN===be){t(eN);ev({"pay-wall":true})}else{bH("Attempt failed: "+bm[eN]);ev({failure:bm[eN]})}}}a7(et,eL,eA);aF(eA,dO,"send_new_compose")}R(eo)}function i(el){var eq=["In 1 hour","In 2 hours","In 4 hours","Tomorrow morning","Tomorrow afternoon","In 2 days","In 4 days","In 1 week","In 2 weeks","In 1 month"];var es=JSON.parse(bS("b4g-menu-customizations"));var eu=[];if(es!=null){var et=es.defaultEntries;var eo=Object.keys(et);for(var ep=0;ep<eo.length;ep++){eu[eo[ep].toLowerCase()]=et[eo[ep]]}}for(var en=0;en<eq.length;en++){var er=eq[en];var em=er.toLowerCase();if(!(em in eu)||eu[em]){var ek=P(er,false);el.append(ek)}}}function Y(em){var ek=dU(".b4g_menu_item:contains('hour'):last",em);ek.parent().after('<div class="b4g-menu-divider" style="height:1px;margin:6px 11px;background:#ddd;"></div>');var el=dU(".b4g_menu_item:contains('Tomorrow'):last",em);el.parent().after('<div class="b4g-menu-divider" style="height:1px;margin:6px 11px;background:#ddd;"></div>')}function aE(es,en,er){var el,et=cI(es);if(et.className.indexOf("J-Zh-I")===-1&&et.className.indexOf("f")!==0&&et.className.indexOf("VP5otc-d2fWKd")===-1&&et.className.indexOf("conditional-caption")===-1){return}var eq=bb();var eu=ce(en);var ew=eq.getElementById("b4g_menu");if(ew){cH(es,en)}else{bw(["Send and Boomerang","Open menu"]);dU("div",en).addClass("J-Zh-I-JO");dU("div",en).addClass("J-Zh-I-Kq");var ek=function(eA){aS(eA,eu)};var eo='<ul id="b4g_menu" tabindex="0" class="b4g_menu" style="padding:0px;background:#fff;position:absolute; bottom: '+(er?-21:22)+'px; left: 195px;" role="menu" aria-haspopup="true" aria-activedescendant=""><div id="b4g_inner_menu" class="b4g_menu SK AX" style="-webkit-user-select: none; font-size:12px;padding:0;"><li id="b4g_menu_title" class="menu-caption b4g-menu-option" style="list-style-type:none;padding:6px 11px 0 11px;">Boomerang this: <img id="b4g-menu-customization-button" data-tooltip="Customize Menu" data-tooltip-delay="400" src="'+cu+'gear.png" height="16px" style="opacity:.9;height:16px;width:16px;position:absolute;right:13px;top:6px;cursor:pointer;"></li><li class="b4g-menu-divider" style="height:1px;margin:0 11px 6px 11px;background:#ddd;"></li><li class="b4g-standard-times"></li><li class="b4g-custom-times"></li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 0px 11px;background:#ddd;"></li><li class="menu-caption" style="padding:7px 11px 4px 11px;">At a specific time:</li><li class="b4g-menu-option" style="padding: 0 0 7px 11px;"><div style="color: #666; font-style: italic; font-size: 10px; margin-top: 3px;" class="b4g_menu">Examples: "Monday 9am", "Dec 23"</div><form onsubmit="return false;"><div style="padding-top:3px; vertical-align: middle;" class="b4g_menu"><input style="margin-left:1px;padding:3px 22px 2px 2px;" class="b4g_menu" type="text" name="time" id="datepicker"><input id="specific-time-submit" type="submit" value="Confirm" style="margin: 0px 7px 5px 9px;font-size:11px;vertical-align:top;" class="b4g_menu by-button by-button-secondary"></div><div style="color:#969696; margin-left: 1px;"><span id="date-preview" class="b4g_menu" style="color:green;"></span></div></form></li></div></ul>';dU(en).parent().append(eo);var ex=dU("#b4g_menu",eq);ap.enable_menu_arrow_keys(ex);i(dU(".b4g-standard-times",eq));Y(eq);dU(".b4g_menu_item",eq).click(function(){function eA(eB){ek(eB);bw(["boomerang menu","send later time",eB])}eA(dU(this).text())});dA(dU(".b4g_menu_item",eq),bn);if(dE==null||dE<new Date()){Z=Date.today().addDays(2).addHours(8)}else{Z=dE}var ey=Z.toString("M/d/yyyy h:mm tt");var ep=dU("#datepicker",eq);ep.val(ey);ep.keyup(function(){var eA=dU(this).val();aQ(eA)});ep.focus(function(){var eA=dU(this).val();aQ(eA)});dU("input#specific-time-submit",eq).click(function(eA){bw(["Send and Boomerang","At a specific time"]);var eB=Date.parse(Z);if(eB!=null){aR(eB,eu)}else{bH("Unable to read specified time. Please try again.")}});var ev=a9();if(ev.length>0){dU(".b4g-custom-times",eq).before("<div class='b4g-menu-divider' style='height:1px;margin:6px 11px;background:#ddd;'></div>");for(var ez=0;ez<ev.length;ez++){el=c1(ev[ez],null);dU(".b4g-custom-times",eq).append(el)}dU(".b4g-custom-menu-item",eq).click(function(){function eA(eB){ek(eB);bw(["b4g menu","picked",eB])}eA(dU(this).text())});dA(dU(".b4g-custom-menu-item",eq),bn)}var em=dU("#b4g-menu-customization-button",eq);em.click(function(){ag()});em.hover(function(){dU(this).css("opacity","1")},function(){dU(this).css("opacity",".9")});dU(eq).bind("click",{owner:en},az);cN(ep);dU(".b4g-ui-datepicker-trigger",eq).css("cursor","pointer");dU(".b4g-ui-datepicker-trigger",eq).css("margin-left","-21px");dU(".b4g-ui-datepicker-trigger",eq).css("margin-top","-2px");dU(".b4g-ui-datepicker-trigger",eq).hover(function(){dU(this).css("box-shadow","0px 0px 3px #aaa")},function(){dU(this).css("box-shadow","none")});ep.mousedown(function(eA){eA.stopImmediatePropagation()});ep.css("-moz-user-select","text");ep.parents().each(function(){dU(this).css("-moz-user-select","text")});ep.focus();ep.select();dU("span#date-preview.b4g_menu",eq).text("");eh()}}function bQ(es){var en=aq();var ev=bl("subjectbox",es).val();var ez=[];var ey=[];var ew=dU(".J-JN-M-I.J-J5-Ji.az2.az4.L3",es);if(ew.length>0){ew=o(ew.text())}else{ew=en}var ex=ak("to",es);var eo=ak("cc",es);var eq=ak("bcc",es);var ep=r(es);if(ep==null||ep==="undefined"){ep=aA()}var ek="https://b4g.baydin.com/mailcruncher/schedulereturndelay";ek=ek+"?subject="+encodeURIComponent(ev);ek=ek+"&senders="+encodeURIComponent(JSON.stringify(ez));ek=ek+"&guser="+encodeURIComponent(en);ek=ek+"&sentDates="+encodeURIComponent(JSON.stringify(ey));ek=ek+"&threadId="+encodeURIComponent(ep);if(bN()){ek=ek+"&language=English"}else{ek=ek+"&language=notEnglish"}var em=dU(".boomerangSendCondition",es).val();var el=dj(es);var er;switch(em){case"no reply":er="reply";break;case"no click":er="click";break;case"no open":er="open";break;case"always":er="none";break;default:er="none"}ek=ek+"&offset="+encodeURIComponent(el.valueOf());ek=ek+"&conditional="+encodeURIComponent(er);if(bl("^i").length>0){ek=ek+"&inbox=True"}else{ek=ek+"&inbox=False"}ek+="&to="+encodeURIComponent(ex);ek+="&cc="+encodeURIComponent(eo);ek+="&bcc="+encodeURIComponent(eq);var eu=aw(es);if(eu){var et=aN(es);ek+="&trackingCode="+encodeURIComponent(et)}return ek}function aw(ek){return dU(".b4g-tracking-toggle",ek).data("is-selected")}function aN(ek){return cf(ek).data("thread-guid")}function dj(ek){var el=dU(".conditional-caption",ek).data("returnDate");if(el==null){el=Date.today().addDays(2).addHours(7).addMinutes(Math.floor(Math.random()*30)-15)}return el}function bC(ep){var el=aq();var er=bl("subject").val();var es=ak("to",ep);var em=ak("cc",ep);var eo=ak("bcc",ep);var en=bl("draft",ep).val();var eq=aN(ep);var ek="https://b4g.baydin.com/mailcruncher/trackemail";ek=ek+"?subject="+encodeURIComponent(er);ek=ek+"&guser="+encodeURIComponent(el);ek=ek+"&threadId="+encodeURIComponent(en);ek=ek+"&trackingCode="+encodeURIComponent(eq);ek+="&to="+encodeURIComponent(es);ek+="&cc="+encodeURIComponent(em);ek+="&bcc="+encodeURIComponent(eo);return ek}function c9(el){var em=bC(el);var ek=aN(el);a7(em,function(eo,en,ep){if(d3(eo)||eo===be){t(eo)}else{if(eo!==d0){bH("Your most recent Boomerang-on-Send failed. To Boomerang your sent email, please open your message in 'Sent Mail' and Boomerang the message manually. <br/><br/> Error Details:<br/> "+bm[eo])}else{aY(ek);cW.expire_cache()}}},"success")}function x(){var ek=dU.ajaxSettings.xhr();ek.withCredentials=true;return ek}function aY(ek){dU.ajax({type:"post",url:"http://mailstat.us/tr/associate-client-to-email?guid="+ek,xhr:x,success:function(el){if(el&&el.success){bw(["dev-CORS","success"])}else{bw(["dev-CORS","failure",(el&&el.error)+""])}},error:function(){bw(["dev-CORS","failure","XHR-failure"])},dataType:"json"})}function W(){var em=dU(".nH.Hd[role='dialog']");var ep=em.first();var ek=dU(".Ha",ep);var en=dU(".oG",ep);var eo=en.text();var el=dU(".aDj",ep)}function dm(el){var ek=dU(".Ha",el);ek.each(bh)}function cc(ek){return dU(".dQ",ek).length>0}function bk(){j()}function j(){dU(".HE").each(function(){var el=ce(this);if(!cf(el)){return}ek(el)});function ek(ey){if(dU(".sendLaterTable",ey).length===0){var et=ey.find(".aDh");et.after(ef);ey.append("<div>&nbsp</div><div>&nbsp</div><div>&nbsp</div>");var eA=42;var eq=dU(".aDd").length>0;if(cv()&&!eq){var ew=et.height();et.css("height",(ew+eA).toString()+"px");var er=dU(".aoD.hl")[0];var eC=et.css("margin-top");var ev=(parseInt(eC,10)-ew).toString()+"px";var eB=function(){if(dU(er).is(":visible")){et.css("margin-top",ev)}else{et.css("margin-top",eC)}};var ex=new dh(function(eD){eD.forEach(eB)});ex.observe(er,{attributes:true});eB();var es=dU(".GP")[0];var en=function(){br(function(){var eI=dU(".qz.aXjCH");var eE=eI.css("max-height");var eH=(parseInt(eE,10)-ew).toString()+"px";eI.css("max-height",eH);var eF=dU(".Am.Al");var eD=eF.css("min-height");var eG=(parseInt(eD,10)-ew).toString()+"px";eF.css("min-height",eG)},250)};var eo=new dh(function(eD){eD.forEach(en)});eo.observe(es,{attributes:true});en();var eu=dU(".sendLaterTable",ey);eu.css("margin-top","-"+eA.toString()+"px");eu.css("border-top-width","1px");var ep=function(){var eE=dU(".GW",ey);if(eE.length>0){var eD=parseInt(eE.css("bottom"),10);if(eD){eE.css("bottom",(eD+eA).toString()+"px")}else{eE.css("bottom",eA.toString()+"px")}}else{setTimeout(ep,2000)}};ep()}dU(".send-later-button",ey).click(function(eD){cg(eD,this,true)});dU(".sendboomerang-button",ey).click(function(eD){aE(eD,this,true)});dU(".boomerangSendCondition",ey).change(function(){dU(".boomerangSendCheck",ey).attr("checked",true);a3(ey);var eE=dU(this).val();bw(["Send and Boomerang","Change 'if i don't hear back' field",eE]);if(eE==="no click"||eE==="no open"){if(!aw(ey)){var eD=dU(".b4g-tracking-toggle",ey);eD.trigger("b4g-toggle-state")}}});try{c2(ey)}catch(ez){}var em=a6(ey);var el=function(){var eD=dU(".boomerangSendCheck",ey).is(":checked");var eF=aw(ey);if(eD){var eE=bQ(ey);a7(eE,function(eI,eG,eH){if(d3(eI)||eI===be){t(eI)}else{if(eI!==d0){bH("Your most recent Boomerang-on-Send failed. To Boomerang your sent email, please open your message in 'Sent Mail' and Boomerang the message manually. <br/><br/> Error Details:<br/> "+bm[eI])}else{if(eI===d0){M({type:"return-later"});cW.expire_cache()}}}},"success")}else{if(eF){c9(ey)}}};em.click(el).keydown(function(eD){if(eD.which===32||eD.which===13){el()}});if(!eq&&cv()){dU(".Am.Al",ey).focus();setTimeout(function(){dU(".aoD.hl",ey).focus()},100)}dU(".boomerangSendCheck",ey).click(function(){a3(ey)});cC(ey);ap.add_compose_listen(ey)}}}function cE(em){var ew=bS("b4g_extensions");var ex="The Boomerang extension has been loaded successfully. ";if(ew){var en=["gakklmehjhhdfjjgnmpkjoemjmeomnli","gkjnkapjmjfpipfcccnjbjcbgdnahpjp","hpoidnelefpoofhdioielagfklahfcjg","npjkmbechijncoapeeifgfhcjkcandgk","cbmmejeeogjpfmdlcdkolobdlohjkmjn"];var eq=["jpbnpbfpgjkblmejlgkfkekajajhjcid","dlppikdhbkdinhpfbneekdbjhgphknad","ijhapcklhkanndjbdnhichfmolhiaekg","mflnemhkomgploogccdmcloekbloobgb","nfddgbpdnaeliohhkbdbcmenpnkepkgn","pnnfemgpilpdaojpnkjdgfgbnnjojfik","gllmkcahdekdbapmdfnffclacbpnicaj","kemincbhdgppphceahdgebffjcfgbigp"];var ek=["mlomiejdfkolichcflejclcbmpeaniij","odjhifogjcknibkahlpidmdajjpkkcfn","dheionainndbbpoacpnopgmnihkcmnkl"];var er=JSON.parse(ew);var es=[];for(var ep=0;ep<er.length;ep++){var ev=er[ep];var eu=ev.id;var et=ev.name;if(en.indexOf(eu)>-1||eq.indexOf(eu)>-1||ek.indexOf(eu)>-1){es.push(ev)}}if(es.length>0){ex+="However, you should check the following extensions for possible conflicts:";ex+="<h4>Extension Conflicts:</h4><ul>";for(var eo=0;eo<es.length;eo++){ex+="<li>"+es[eo]["name"]+"</li>"}ex+="</ul>"}}ex+="<div id='b4g-inline-troubleshoot-holder'/>";var el=bH(ex,"Boomerang For Gmail",{Close:{text:"Close","class":"b4g-button green",click:function(){window.location="https://mail.google.com"}},});if(em==="inline-manage"){setTimeout(function(){dr(el)},0)}localStorage.removeItem("b4g_extensions")}function dr(em){var el=dU("<div id='b4g-inline-troubleshoot'><h4>Inline manage:</h4><ul><li>Is enabled: <b class='b4g-inline-enabled'></b></li><li>Local data last updated: <br><b class='b4g-inline-lastupdated'></b></li><li>Number inline-manage threads: <b class='b4g-inline-threadscount'></b></li><li>Is server data accessible: <b class='b4g-inline-serverdata'></b></li></ul></div>");em.css("height","auto").find("#b4g-inline-troubleshoot-holder").append(el);var ek=function(en,ep,eo){dU(en,el).text(ep).css("color",eo)};cW.troubleshoot({local:function(ep,er){var eo=cW.is_enabled();ek(".b4g-inline-enabled",(eo?"Yes":"No"),(eo?"green":"red"));var eq=new Date(er["last-updated"]);var en=Object.keys(er["thread-ids"]).length;ek(".b4g-inline-lastupdated",eq+"","blue");ek(".b4g-inline-threadscount",en,"blue")},server:function(en){if(en){ek(".b4g-inline-serverdata",en,"red")}else{ek(".b4g-inline-serverdata","Yes","green")}}});ek(".b4g-inline-enabled","Loading...","blue");ek(".b4g-inline-lastupdated","Loading...","blue");ek(".b4g-inline-threadscount","Loading...","blue");ek(".b4g-inline-serverdata","Loading...","blue")}var l='<div class="b4g-tooltip-ftue"><div class="b4g-ftue-content"/><button class="T-I J-J5-Ji T-I-atl b4g-ftue-button"/><div class="b4g-ftue-pointer"/></div>';function c3(ek){ek=ek||{};var el=dU(l);if(ek.content instanceof dN){dU(".b4g-ftue-content",el).append(ek.content)}else{dU(".b4g-ftue-content",el).text(ek.content)}el.css({left:ek.left,top:ek.top,right:ek.right,bottom:ek.bottom,width:ek.width||"320px"}).find(".b4g-ftue-pointer").addClass("b4g-pointer-"+(ek.dir||"lr")).end().find(".b4g-ftue-button").text(ek.button||"").hover(function(){dU(this).addClass("T-I-JW")},function(){dU(this).removeClass("T-I-JW")}).click(function(em){em.preventDefault();if(ek.close){setTimeout(function(){ek.close()},0)}el.remove()}).end().appendTo("body");return el}function ah(el){if(dU("#b4g_manage").length<=0){return setTimeout(function(){el({"user-in-pop-out":true})},0)}if(ah.requestInFlight){return setTimeout(function(){el({"request-in-flight":true})},0)}if(bS("b4g-has-seen-click-open-tracking-announcement")){return setTimeout(function(){el({"annouce-has-been-seen":true})},0)}var ek=aq();a7("https://b4g.baydin.com/mailcruncher/hasseentrackingannouncement?guser="+encodeURIComponent(ek),function(em,en,eo){ah.requestInFlight=false;if(em===bT){el(null)}else{A("b4g-has-seen-click-open-tracking-announcement",true);el({"annouce-has-been-seen":true})}});ah.requestInFlight=true}var d8='<div><h3>Introducing new features from Boomerang!</h3><p>You can request a read receipt and track clicks on links in your message. We will notify you when someone reads your email or clicks a link.</p><p>To get started, click the "Request read receipt and track clicks" button below.</p></div>';function L(el){var ek=dU(".b4g-tracking-toggle",el);var em=ek.offset();ek.trigger("mouseenter");c3({bottom:dU("body").height()-em.top+2,right:dU("body").width()-(em.left+ek.outerWidth()/2)-24,content:dU(d8),close:function(){ek.trigger("mouseleave")},button:"Nifty!"});A("b4g-has-seen-click-open-tracking-announcement",true);bw(["click open tracking FTUE","annoucement"])}function eb(el){if(dU("#b4g_manage").length<=0){return setTimeout(function(){el({"user-in-pop-out":true})},0)}if(eb.requestInFlight){return setTimeout(function(){el({"request-in-flight":true})},0)}if(bS("b4g-has-seen-click-open-tracking-tutorial")){return setTimeout(function(){el({"tutorial-has-been-seen":true})},0)}var ek=aq();a7("https://b4g.baydin.com/mailcruncher/hasseentrackingtutorial?guser="+encodeURIComponent(ek),function(em,en,eo){eb.requestInFlight=false;if(em===bT){el(null)}else{A("b4g-has-seen-click-open-tracking-tutorial",true);el({"tutorial-has-been-seen":true})}});eb.requestInFlight=true}var dn=["<div><h3>Awesome! Here is how it works.</h3><ol><li>You will get an email when the message is opened.</li><li>Your own opens and clicks are not counted.</li><li>Since some email clients are not compatible with the read receipt feature, there may be cases when opens/clicks are not reported.</li><li>The recipients can choose to not provide read receipts.</li></ol></div>",'<div><p>We have integrated read receipt and click tracking with our original Boomerang feature so you can get reminders for messages that don\'t get opened or clicked.</p><p>We added "if not opened" and "if not clicked" options in the drop down below.</p></div>',"<div><p>To see more details on your tracked messages after they are sent, click here and go to <strong>Manage scheduled messages</strong>.</p><p>Thanks and let us know how this feature works for you.</p></div>"];function d7(el){var ek=dU(".b4g-tracking-toggle",el);var em=ek.offset();ek.trigger("mouseenter");el.parents("body > .dw").andSelf().css("z-index",5);dU('<div class="b4g-ui-widget-overlay"/>').css("z-index",3).appendTo("body");c3({bottom:dU("body").height()-em.top+2,right:dU("body").width()-(em.left+ek.outerWidth()/2)-24,content:dU(dn[0]),close:function(){ek.trigger("mouseleave");d6(el)},button:"Next"});bw(["click open tracking FTUE","step1"])}function d6(el){var ek=dU(".b4g-send-condition",el);var em=ek.offset();c3({bottom:dU("body").height()-em.top+2,right:dU("body").width()-(em.left+ek.outerWidth()/2)-24,content:dU(dn[1]),close:function(){d5(el)},button:"Next"});bw(["click open tracking FTUE","step2"])}function d5(ek){q(dU("#b4g_manage"));var el=dU("#tmmanage").offset();ek.parents("body > .dw").andSelf().css("z-index",null);dU(".b4g-ui-widget-overlay").click(function(em){em.stopPropagation()});c3({top:el.top-8,left:el.left-420,width:380,dir:"ur",content:dU(dn[2]),close:function(){dU(".b4g-ui-widget-overlay").remove();A("b4g-has-seen-click-open-tracking-tutorial",true)},button:"Ok, got it."});bw(["click open tracking FTUE","step3"])}var bA={"detected-date-by-magic":{"dialog-message":"Looks like we guessed that one perfectly!<br/>Share the magic with others?","share-message":[{text:"Boomerang just helped me bring back a message at the right time. It's magical.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=magic&utm_campaign=viralhook"}]},"send-later-if-no-reply":{"dialog-message":"You just scheduled your auto-reminder email.<br/>Please share Boomerang with your friends so they can do the same.","share-message":[{text:"Thanks to Boomerang, I can schedule a reminder email that will be sent out only if they don't respond.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=auto_reminder&utm_campaign=viralhook"}]},"inbox-zero-within-hour":{"dialog-message":"Congratulations! You are at Inbox Zero.<br/>Care to share how Boomerang helped you achieve Inbox Zero?","share-message":[{text:"I just got to Inbox Zero with Boomerang's help! It helps me stay on top of all my emails.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=inbox_zero&utm_campaign=viralhook"}]},"send-later-at-1am-5am":{"dialog-message":"Looks like you love using Boomerang late at night.<br/>Share with others how you're using it.","share-message":[{text:"Just scheduled a bunch of emails with Boomerang! This way people don't know I am really a vampire.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=vampire&utm_campaign=viralhook"},{text:"Boomerang lets me schedule emails so I don't wake up people with my messages at all hours of the night.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=wake_people_up&utm_campaign=viralhook"},{text:"Boomerang lets me schedule emails so my messages are at the top of Inboxes even if I am writing them at insane hours.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=insane_hours&utm_campaign=viralhook"}]}};var dK='<div class="b4g-viral-hook"><img class="b4g-viral-logo" src="'+cu+'viral-hook/boomerang.png"/><div class="b4g-viral-content"><p class="b4g-viral-dialog-message">{{dialog-message}}</p><ul class="b4g-viral-share-options"><li><a data-share-type="twitter" href="http://twitter.com/home?status={{text}}+{{url-twitter}}" target="_blank"><img src="'+cu+'viral-hook/tweet.png"/></a></li><li><a data-share-type="facebook" href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]={{url-fb}}&p[images][0]=&p[title]=&p[summary]={{text}}" target="_blank"><img src="'+cu+'viral-hook/fbshare.png"/></a></li><li><a data-share-type="linkedin" href="http://www.linkedin.com/shareArticle?mini=true&url={{url-linkedin}}&title=&summary={{text}}&source=" target="_blank"><img src="'+cu+'viral-hook/linkedin.png"/></a></li><li><a data-share-type="googleplus" href="https://plus.google.com/share?url={{url-gplus}}" target="_blank"><img src="'+cu+'viral-hook/googleshare.png"/></a></li></ul></div><a class="b4g-viral-close" href="javascript:void(0);"></a></div>';function cd(ek,el){return ek.replace(/\{\{(.*?)\}\}/g,function(em,en){var eo=en.split(".");var eq,ep=el;do{eq=eo.shift();ep=ep[eq]}while(eo.length>0&&ep!=null);return ep})}function bG(eq,el){el=el||{};var ek=bA[eq];var en=(el.idx||0)%ek["share-message"].length;var em=ek["share-message"][en];var ep={"dialog-message":ek["dialog-message"],text:encodeURIComponent(em.text),"url-twitter":encodeURIComponent(cd(em.url,"twitter")),"url-fb":encodeURIComponent(cd(em.url,"fb")),"url-linkedin":encodeURIComponent(cd(em.url,"linkedin")),"url-gplus":encodeURIComponent(cd(em.url,"gplus"))};var eo=dU(cd(dK,ep)).find(".b4g-viral-close").click(function(er){er.preventDefault();dU(".b4g-viral-hook").remove();bw("Viral hook closed",eq)}).end().appendTo("body").animate({top:0});dU(".b4g-viral-share-options a",eo).click(function(){bw("Viral hook share click",eq,dU(this).data("share-type"))});bw("Viral hook shown",eq);return{idx:en+1}}function M(el){var er=aM();if(er==="personal"||er==="pro"||er==="premium"){return}var ew;try{ew=JSON.parse(bS("b4g-viral-hook")||"{}")}catch(em){ew={}}if(el.type==="send-later"||el.type==="return-later"){ew["last-"+el.type]=(new Date()).getTime();var et=el.type+"-count";ew[et]=(ew[et]||0);ew[et]+=("bulk" in el?el.bulk:1)}A("b4g-viral-hook",JSON.stringify(ew));var eo=ew["send-later-count"]||0;eo+=ew["return-later-count"]||0;if(eo<3){return}var es=ew.lastShown||{};var ek=new Date();var eq=24*60*60*1000;var ev=ek.getTime()-(28*eq);for(var ep in es){if(es.hasOwnProperty(ep)){if(es[ep].date==null){A("b4g-viral-hook","{}");return}if(es[ep].date>ev){return}}}var en="none";if(el.type==="return-later"&&el.isByMagic){en="detected-date-by-magic"}else{if(el.type==="send-later"&&el.isIfNoReply){en="send-later-if-no-reply"}else{if(el.type==="send-later"&&0<ek.getHours()&&ek.getHours()<6){en="send-later-at-1am-5am"}else{if(el.type==="is-inbox-zero"&&ew["last-return-later"]&&(ek.getTime()-60*60*1000)<ew["last-return-later"]){en="inbox-zero-within-hour"}}}}if(en==="none"){return}if(en in es&&es[en].date>(ek.getTime()-90*eq)){return}var eu=bG(en,es[en]);es[en]={date:(new Date()).getTime(),info:eu};ew.lastShown=es;A("b4g-viral-hook",JSON.stringify(ew))}function aT(el){var ek=dU(".aeF");if(ek.length<=0){setTimeout(function(){aT(el)},1000);return}new dh(function(){if(!f()){return}if(dU(".J-KU-KO .aKp.aIf-aLf").length<=0){return}if(dU(".aRv:visible").length<=0){return}el()}).observe(ek[0],{childList:true,subtree:true})}var cW=(function(){var en=10*60*1000;var e1={R:"if there's no reply",O:"if not opened",C:"if not clicked",N:""};var eq=["year","month","week","day"];var eS={container:"<div class='b4g-inline-manage b4gid-{{b4g-id}} date-{{last-updated}}'><div class='b4g-inline-placeholder-return'/><div class='b4g-inline-placeholder-send'/><div class='b4g-inline-placeholder-recurring'/><div class='b4g-inline-placeholder-tracking'/><div class='b4g-inline-placeholder-notes'/></div>","return":"<div class='b4g-inline-return b4g-inline-part'><div class='b4g-inline-content'>Scheduled to return: <span class='b4g-inline-date'>{{data.pretty-return-time}}</span> {{data.pretty-conidition}}</div><div class='b4g-inline-controls'><button class='by-button b4g-inline-reschedule by-button-secondary'><span class='by-button-text'>Reschedule</span></button><button class='by-button b4g-inline-returnnow'><span class='by-button-text'>Return Now</span></button><button class='by-button b4g-inline-noreturn'><span class='by-button-text'>Don't Return</span></button></div></div>",send:"<div class='b4g-inline-send b4g-inline-part'><div class='b4g-inline-content'>Scheduled to send: <span class='b4g-inline-date'>{{data.pretty-send-time}}</span> {{data.pretty-conidition}}</div><div class='b4g-inline-controls'><button class='by-button b4g-inline-reschedule by-button-secondary'><span class='by-button-text'>Reschedule</span></button><button class='by-button b4g-inline-sendnow'><span class='by-button-text'>Send Now</span></button><button class='by-button b4g-inline-nosend'><span class='by-button-text'>Don't Send</span></button></div></div>",recurring:"<div class='b4g-inline-recurring b4g-inline-part'><div class='b4g-inline-content'>Scheduled to send: <span class='b4g-inline-date'>{{data.pretty-recurring-time}}</span></div><div class='b4g-inline-controls'><button class='by-button b4g-inline-reschedule by-button-secondary'><span class='by-button-text'>Reschedule</span></button><button class='by-button b4g-inline-skip'><span class='by-button-text'>Skip Next</span></button><button class='by-button b4g-inline-cancel'><span class='by-button-text'>Stop Sending</span></button></div><div class='b4g-inline-recurring-schedule'><span class='b4g-inline-schedule-part'>Start: <span class='b4g-inline-date'>{{data.pretty-start-time}}</span></span><span class='b4g-inline-schedule-part b4g-inline-reschedule-next'>Next Scheduled: <span class='b4g-inline-date'>{{data.pretty-next-time}}</span></span><span class='b4g-inline-schedule-part'>End: <span class='b4g-inline-date'>{{data.pretty-end-time}}</span></span></div></div>",tracking:"<div class='b4g-inline-tracking b4g-inline-part'><div class='b4g-inline-tracking-opens'><table><colgroup><col/><col class='b4g-tracking-first'/><col class='b4g-tracking-last'/></colgroup><tr><th>OPENED &ndash; {{data.open-data.opens}} TIMES</th><td><span class='b4g-tracking-time-title'>FIRST</span> {{data.open-data.pretty-first-time}}</td><td><span class='b4g-tracking-time-title'>LAST</span> {{data.open-data.pretty-last-time}}</td></tr></table></div><div class='b4g-inline-tracking-clicks'><table class='b4g-inline-linktracking'><colgroup><col class='b4g-tracking-click-total'/><col/><col class='b4g-tracking-first'/><col class='b4g-tracking-last'/></colgroup><thead><tr><th colspan='4'>CLICKED &ndash; {{data.total-link-clicks}} TIMES</th></tr></thead>{{data.link-click-content}}</table></div></div>","link-tracking":"<tr><td class='b4g-tracking-click-total'>{{clicks}}</td><td class='b4g-trcking-click-url'><a href='{{url}}' target='_blank'>{{url}}</a></td><td><span class='b4g-tracking-time-title'>FIRST</span> {{pretty-first-time}}</td><td><span class='b4g-tracking-time-title'>LAST</span> {{pretty-last-time}}</td></tr>",notes:"<div class='b4g-inline-notes'><span class='b4g-inline-notes-label'>Note added:</span> <span class='b4g-inline-notes-text'>{{notes}}</span> <button>Edit</button></div>",reschedule:'<div class="b4g-reschedule-popup"><h3>Reschedule this message</h3><form><select class="b4g-return-condition"><option value="N">Always return</option><option value="R">Only if there\'s no reply</option></select><label class="b4g-send-ifnoreply"><input type="checkbox" value="if-no-reply"/> Only if nobody replies</label><div class="b4g-ifnoreply-warning"></div><label><span class="b4g-reschedule-example">Example: "Monday 9am", "Dec 23"</span><input type="text" class="b4g-reschedule-date"/><span class="b4g-reschedule-preview"></span></label><div class="b4g-reschedule-buttons"><button type="submit" class="by-button by-button-secondary"><span class="by-button-text">Reschedule</span></button><button class="b4g-reschedule-cancel by-button"><span class="by-button-text">Cancel</span></button></div></form></div>',"recurring-cancel-confirmation":'<div class="b4g-recurring-confirmation"><h3>Are you sure you want to stop sending all subsequent copies of this recurring message?</h3><p>The message will move back to your Drafts folder.</p><div class="b4g-recur-confirm-buttons"><button class="by-button by-button-secondary"><span class="by-button-text">Yes, stop sending</span></button><button class="by-button b4g-cancel"><span class="by-button-text">Cancel</span></button></div></div>',"recurring-skip-next-confirmation":'<div class="b4g-recurring-confirmation"><h3>Skip next message?</h3><p>The message scheduled to send on <strong>{{pretty-skip-date}} will be skipped</strong>.  The rest of the messages will still go out as previously scheduled.</p><div class="b4g-recur-confirm-buttons"><button class="by-button by-button-secondary"><span class="by-button-text">Yes, skip message</span></button><button class="by-button b4g-cancel"><span class="by-button-text">Cancel</span></button></div></div>',"edit-email-button":'<div class="b4g-edit-button-container"><button class="b4g-inline-edit-message by-button by-button-primary"><span class="by-button-text">Edit Message</span></button></div>'};var ep=(Math.random()+"").substr(2);var ew;var eI={};function eu(){var e4=new Date();var e3=(e4.getMonth()+1)+"/"+e4.getDate()+"/"+e4.getFullYear();var e5=(e4.getHours()>12)?(e4.getHours()-12)+":"+((e4.getMinutes()<10)?"0":"")+e4.getMinutes()+" PM":e4.getHours()+":"+e4.getMinutes()+" AM";A("b4g-inline-manage-last-update-"+aq(),e3+" "+e5);if(!ew){return}ew["last-updated"]=0;var e2=ew["thread-ids"];for(var e6 in e2){if(e2.hasOwnProperty(e6)){ew["thread-ids"][e6]["last-updated"]=0}}eL();e0(ew)}function eL(){if(ew.enabled){return}ew.enabled=true;ey(ew);e0(ew)}function e0(e3){var e2=aq();aU.write("b4g-inline-manage-data:"+e2,JSON.stringify(e3),function(e4){if(e4){console.warn("Error writting b4g inline-mange data: ",e4)}})}function ex(e3){var e2=Date.now();var e4=ex.nextUpdate;if(e2<e4&&e4<e2+e3){return}setTimeout(function(){ey(ew)},e3);ex.nextUpdate=e2+e3}ex.nextUpdate=0;function eN(){var e2=dU(".aeF");if(e2.length<=0){setTimeout(eN,1000);return}ey(ew);new dh(function(e3){if(!aA()){return}if(dU(".aHU").length<=0){return}if(ew&&!ew.enabled&&window.location.hash.indexOf("/Boomerang")>-1){eL()}ey(ew)}).observe(e2[0],{childList:true,subtree:true});eQ(e2)}function et(e3){var e2=aq();aU.read("b4g-inline-manage-data:"+e2,function(e4,e5){if(e4){console.log("Error loading inline manage data",e4)}var e6;try{e6=JSON.parse(e5||"{}")}catch(e4){e6={}}ew=ew||e6||{};ew.enabled=e6.enabled||false;ew["last-updated"]=e6["last-updated"]||0;ew["thread-ids"]=e6["thread-ids"]||{};e3(ew)})}function eX(e2){if(ew===undefined){et(function(){eX(e2)});return}var e3={};var e4=ew["thread-ids"];e2.forEach(function(e5){e3[e5]=e4[e5]||{}});ew["thread-ids"]=e3;e0(ew);return e3}function ey(e2){if(e2===undefined){et(function(e5){ey(ew)});return}if(!ew.enabled){return}eH(ew["thread-ids"]);if(eI["managed-thread-ids"]){return}var e3=5*60*60*1000;var e4=Date.now()-ew["last-updated"];if(e4<e3){ex(e3-e4);return}eZ(function(e5,e6){if(e5){ex(en);return}if(!e6){ex(en);return}if(!e6.success){ex(en);return}var e7=eX(e6["thread-ids"]);ex(e3);eH(e7)})}function eZ(e2){dU.ajax({type:"get",url:"https://b4g.baydin.com/inline-manage/managed-thread-ids",data:{email:aq(),uid:ep},xhr:x,success:function(e3){e2(false,e3)},error:function(e5,e3,e4){e2({status:e3,error:e4})},complete:function(){eI["managed-thread-ids"]=undefined;delete eI["managed-thread-ids"];if(ew){ew["last-updated"]=Date.now();e0(ew)}},dataType:"json"});eI["managed-thread-ids"]=true}function eJ(){dU(".cf.hX:contains('Boomerang')").not(":contains('Boomerang-Returned')").find(".hV.hM").hide().end().find(".hU.hM:contains('Boomerang')").css({"background-color":"#FBF1B5",color:"#666"}).filter(":contains('Boomerang-Outbox')").css({"background-color":"#FFD76E",color:"#666"})}function eH(e3){var e6=aA();var e5=e3[e6];if(!e5){return}eJ();var e4=e5["last-updated"]||0;var e2=(Date.now()-e4>15*60*1000);if(e2){eo(e6)}if(e5.returns){em(e5.returns,e4)}if(e5.sends){eC(e5.sends,e4)}if(e5.recurrings){eO(e5.recurrings,e4)}if(e5.tracks){eB(e5.tracks,e4)}}function eo(e2){if(eI[e2]){return}dU.ajax({type:"get",url:"https://b4g.baydin.com/inline-manage/manage-info",data:{"thread-id":e2,email:aq()},xhr:x,success:function(e3){if(!e3.success){return}e3.success=undefined;delete e3.success;ew["thread-ids"][e2]=e3;e0(ew);eH(ew["thread-ids"])},error:function(){ex(en)},complete:function(){eI[e2]=undefined;delete eI[e2];var e3=ew["thread-ids"][e2]||{};e3["last-updated"]=Date.now();ew["thread-ids"][e2]=e3;e0(ew)},dataType:"json"});eI[e2]=true}function eR(e5,e3,e4){e4=e4||{};var e6=e3.offset();e5.addClass("b4g-inline-popup").appendTo("body").css({top:e6.top+e3.outerHeight()+(e4.top||0),left:e6.left-e5.outerWidth()+e3.outerWidth()+(e4.left||0)});dU(document).click(function e2(e7){if(e3[0]===e7.target){return}if(e5[0]===e7.target){return}if(dU.contains(e3[0],e7.target)){return}if(dU.contains(e5[0],e7.target)){return}if(!dU.contains(document,e7.target)){return}if(dU(e7.target).closest(".b4g-ui-datepicker").length>0){return}e7.preventDefault();e5.remove();dU(document).unbind("click",e2)})}function eD(e4,e3,e5){var e2=dU(aI);e2.addClass("b4g-inline-notes-edit").find("textarea").val(e4.notes).end().find("#notes_save_button").click(function(){var e6=e4.notes;e4.notes=dU("textarea",e2).val();dU(".b4g-inline-notes-text",e5).text(e4.notes);e0(ew);var e7=function(){alert("Sorry, there was an error. We can't save your note. Try again later.");e4.notes=e6;dU(".b4g-inline-notes-text",e5).text(e6);e0(ew)};R(function(){dU.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/update-notes",data:{"return-later-id":e4.id,notes:e4.notes},xhr:x,success:function(e8){if(!e8.success){e7()}},error:e7,dataType:"json"})},e7);e2.remove()}).end().find("#notes_cancel_button").click(function(){e2.remove()}).end();eR(e2,e3,{top:5});return e2}function eG(e7,fd,fb){var e3=(e7.condition!=null);var e9=(e7["is-conditional"]!=null);var e4=e7["return-time"]||e7["send-time"];var fa=new Date().toString("MMM d, yyyy h:mm tt");var e6=dU(".g3:visible");var fc=(e6.length>0);var e8=(e6[0]===fd.closest(".adn").find(".g3")[0]);var e5=(e9&&(fc&&!e8));var e2=dU(eS.reschedule);e2.find(".b4g-reschedule-date").val(fa).bind("change keyup",function(){var fe=ba(dU(this).val());var ff=au(fe,true);dU(".b4g-reschedule-preview",e2).text(ff).toggleClass("b4g-state-invalid",(fe==null||fe<new Date()))}).end().find(".b4g-return-condition").toggle(e3).end().find(".b4g-send-ifnoreply, .b4g-ifnoreply-warning").toggle(e5).end().find(".b4g-send-ifnoreply input").change(function(){if(!dU(this).is(":checked")){return}var fe=(new Date()).toString("MM/d a\\t h:mmtt");dU(".b4g-ifnoreply-warning").html("This message will be sent if no replies are received between <strong>now and the scheduled time</strong>.")}).end().find("[type='submit']").click(function(){dU(this).closest("form").submit()}).end().find("form").bind("submit",function(ff){ff.preventDefault();var fe=ba(dU(".b4g-reschedule-date",e2).val());var fg;if(e3){fg=dU(".b4g-return-condition",e2).val()}if(e9){fg=dU(".b4g-send-ifnoreply input",e2).attr("checked")}if(!fe){alert("Please enter in a valid date.");return}fb({date:fe,condition:fg})}).end().find(".b4g-reschedule-cancel").click(function(){e2.remove()}).end();cN(e2.find(".b4g-reschedule-date"));if(e3&&"OC".indexOf(e7.condition)>-1){dU(".b4g-return-condition",e2).append('<option value="O">Only if not opened</option>').append('<option value="C">Only if not clicked</option>')}if(e3){dU(".b4g-return-condition",e2).val(e7.condition)}if(e9){dU(".b4g-send-ifnoreply input",e2).attr("checked",e7["is-conditional"])}eR(e2,fd,{left:1});return e2}function ez(e3){var e2=ew["thread-ids"];e2[e3]["last-updated"]=Date.now();eH(e2)}function er(e2,e4){var e3=e2.responseText||e2.error||e2;if(dU.type(e3)!=="string"){e3=e4||"Sorry, there was an error. We can't save your update. Try again later."}alert(e3)}function eK(e3,fb,e4){var e8=dU(e4).closest(".b4g-inline-part").data("manage-data");var e7=aA();var e6,fc;if(fb==="send"){e6="send-time";fc="is-conditional"}else{if(fb==="return"){e6="return-time";fc="condition"}}var fa=e8[fc];var e5=e8[e6];var e9=function(fe){er(fe);e8[fc]=fa;e8[e6]=e5;e0(ew);ez(e7)};var fd=dU(e4).closest(".by-button");var e2=eG(e8,fd,function(fe){e8[fc]=fe.condition;e8[e6]=fe.date.getTime();e0(ew);dU(".b4gid-"+e8["hex-gmail-id"]).remove();eH(ew["thread-ids"]);R(function(){dU.ajax({type:"post",url:"https://b4g.baydin.com"+e3,data:{id:e8.id,offset:fe.date.getTime(),condition:fe.condition},xhr:x,success:function(ff){if(!ff.success){e9(ff)}},error:e9,dataType:"json"})},e9);e2.remove()})}function eP(e2,e8,e3,fa){var e5=dU(e3).closest(".b4g-inline-part").data("manage-data");var e4=aA();var fb=ew["thread-ids"];var e7=fb[e4][e8+"s"];var e9=e7.indexOf(e5);if(e9>-1){e7.splice(e9,1)}e0(ew);dU(".b4gid-"+e5["hex-gmail-id"]).remove();dU(".m"+e5["hex-gmail-id"]).removeClass("b4g-inline-pending-content");eH(fb);var e6=function(fc){er(fc);e7.push(e5);e0(ew);ez(e4)};R(function(){dU.ajax({type:"post",url:"https://b4g.baydin.com"+e2,data:{id:e5.id},xhr:x,success:function(fc){if(!fc.success){e6(fc)}if(fa){fa()}},error:e6,dataType:"json"})},e6)}function eE(e2,e4,e3){dU(".by-button-text",e3).text("Cancelling...");var e6=dU(e3).closest(".b4g-inline-part").data("manage-data");var e7=aA();var e5=function(e8){er(e8);ez(e7)};R(function(){dU.ajax({type:"post",url:"https://b4g.baydin.com"+e2,data:{id:e6.id},xhr:x,success:function(e9){if(!e9.success){e5(e9)}var fa=ew["thread-ids"];var fb=fa[e7][e4+"s"];var e8=fb.indexOf(e6);if(e8>-1){fb.splice(e8,1)}e0(ew);window.location.reload()},error:e5,dataType:"json"})},e5)}function el(e3){var e4=af(function(){var fd=dU.extend({},e3);var fb=aA();var e7=Date.parse(dU("#start_date_input").val()+" "+dU("#start_time_input").val());if(!e7||e7<new Date()){alert("Invalid start date");return}var ff=d2();var e8=dU("#num_interval").val();var e9=ck(e7);if(!e9){alert("You must select a day of the week.");return}var fe="None",fa="None";if(dU("#radio_num_occurences").attr("checked")){fe=dU("#num_occurences").val();fa=ev(e7,e8,ff,e9,fe)}else{if(dU("#radio_end_date").attr("checked")){fa=Date.parse(dU("#end_date").val());if(fa==null){alert("Invalid end date");return}fa=fa.getTime()}}var fc=function(fg){er(fg);dU.extend(e3,fd);e0(ew);ez(fb)};R(function(){dU.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/reschedule-recurring",data:{id:e3.id,frequency:ff,interval:e8,utc_weekday:e9,start:e7.getTime(),end:fa,num_occurences:fe},xhr:x,success:function(fg){if(!fg.success){fc(fg);return}e3["next-send"]=fg["next-send"];var fh=ew["thread-ids"];fh[fb]["last-updated"]=Date.now();eH(fh)},error:fc,dataType:"json"})},fc);e3.frequency=["YEARLY","MONTHLY","WEEKLY","DAILY"].indexOf(ff);e3.interval=e8|0;e3.start=e7.getTime();e3.end=(fa==="None"?undefined:fa);e3.weekdays=dU.parseJSON(e9.replace("(","[").replace(")","]"));e0(ew);e3["next-send"]=NaN;ez(fb);e4.remove()});dU("#num_interval",e4).val(e3.interval);dU("#frequency",e4).val(eq[e3.frequency]).change();var e5=new Date(e3["next-send"]);dU("#start_date_input",e4).val(e5.toString("M/d/yyyy"));dU("#start_time_input",e4).val(e5.toString("hh:mm tt"));if(e3.end){dU("#end_date",e4).val((new Date(e3.end)).toString("M/d/yyyy"));dU("#radio_end_date",e4).attr("checked",true)}else{dU("#radio_no_end",e4).attr("checked",true)}var e2=dU("input.day_cb",e4);var e6=eT(e3.weekdays,new Date(e3.start));e6.forEach(function(e7){e2.filter("[value="+e7+"]").attr("checked",true)});e2.change()}function ev(e2,e4,e3,ff,e9){function e7(fg){if(fg===0){return 6}else{return fg-1}}var fa="None";var e6=new Date(e2.getTime());if(e3==="DAILY"){for(var fc=0;fc<e9;fc++){e6.add(e4).days()}fa=e6.getTime()}else{if(e3==="WEEKLY"){var fd=0;var fe=ff.replace(/[()]/g,"").split(",");while(fd<e9){var e5=e7(e6.getDay()).toString();if(fe.indexOf(e5)!==-1){fd++}e6.add(1).days()}fa=e6.getTime()}else{if(e3==="MONTHLY"){for(var fb=0;fb<e9;fb++){e6.add(e4).months()}fa=e6.getTime()}else{if(e3==="YEARLY"){for(var e8=0;e8<e9;e8++){e6.add(e4).years()}fa=e6.getTime()}}}}return fa}function eA(e2){var e5=aA();var e4=e2["next-send"];e2["next-send"]=NaN;ez(e5);var e3=function(e6){er(e6);e2["next-send"]=e4;ez(e5)};R(function(){dU.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/reschedule-skip-next",data:{id:e2.id},xhr:x,success:function(e6){if(!e6.success){e3();return}e2["next-send"]=e6["next-send"];ez(e5);e0(ew)},error:e3,dataType:"json"})},e3)}function eQ(e2){e2.delegate(".b4g-inline-notes button","click",function(e4){var e3=dU(this).closest(".b4g-inline-notes").data("manage-data");eD(e3,dU(this),e2)});e2.delegate(".b4g-inline-return .b4g-inline-reschedule","click",function(){eK("/inline-manage/reschedule-return-later","return",this)}).delegate(".b4g-inline-send .b4g-inline-reschedule","click",function(){eK("/inline-manage/reschedule-send-later","send",this)});e2.delegate(".b4g-inline-return .b4g-inline-returnnow,","click",function(){eP("/inline-manage/return-now","return",this)}).delegate(".b4g-inline-return .b4g-inline-noreturn,","click",function(){eP("/inline-manage/return-never","return",this)}).delegate(".b4g-inline-send .b4g-inline-sendnow","click",function(){eP("/inline-manage/send-now","send",this)}).delegate(".b4g-inline-send .b4g-inline-nosend,","click",function(){eE("/inline-manage/send-never","send",this)});e2.delegate(".b4g-inline-recurring .b4g-inline-reschedule","click",function(){var e3=dU(this).closest(".b4g-inline-part").data("manage-data");el(e3)}).delegate(".b4g-inline-recurring .b4g-inline-skip","click",function(){var e4=dU(this).closest(".b4g-inline-part").data("manage-data");var e3=eS["recurring-skip-next-confirmation"];var e5=dU(cd(e3,{"pretty-skip-date":new Date(e4["next-send"]).toString("MMM dd yyyy")}));e5.find(".b4g-cancel").click(function(){e5.remove()}).end().find(".by-button-secondary").click(function(){eA(e4);e5.remove()}).end().dialog({modal:true,closeOnEscape:true,width:400,dialogClass:"b4g-no-title"})}).delegate(".b4g-inline-recurring .b4g-inline-cancel","click",function(){var e5=dU(this);var e3=eS["recurring-cancel-confirmation"];var e4=dU(e3);e4.find(".b4g-cancel").click(function(){e4.remove()}).end().find(".by-button-secondary").click(function(){eE("/inline-manage/recurring-cancel","recurring",e5);e4.remove()}).end().dialog({modal:true,closeOnEscape:true,width:400,dialogClass:"b4g-no-title"})})}var eW=(function(){var e2={janvier:0,"février":1,mars:2,avril:3,mai:4,juillet:6,"août":7,sep:8,aug:7,septembre:8,octobre:9,novembre:10,"décembre":11,enero:0,febrero:1,marzo:2,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11,januar:0,februar:1,"märz":2,april:3,juni:5,juli:6,mayo:4,nov:10,oct:9,oktober:9,november:10,dezember:11,januari:0,februari:1,maart:2,augustus:7,december:11,janeiro:0,fevereiro:1,"março":2,maio:4,junho:5,julho:6,dec:11,setembro:8,mei:4,novembro:10,dezembro:11,gennaio:0,febbraio:1,aprile:3,maggio:4,giugno:5,luglio:6,settembre:8,ottobre:9,dicembre:11,abril:3,outubro:9,september:8,jan:0,feb:1,mar:2,apr:3,may:4,jun:5,august:7,jul:6,juin:5};var e4=/^\d?\d$/,e5=/^20\d\d$/,e7=/(\d?\d):(\d\d)\s?(am|pm)?/;var e6=/,?\.?\s+/g;return function e3(fh){var fd=fh.toLowerCase().replace(e7,"$1:$2$3").split(e6);var fi,ff,e9,fb,fa;for(var fe=0;fe<fd.length;fe++){var e8=fd[fe];if(e4.test(e8)){e9=e8|0}else{if(e5.test(e8)){fi=e8|0}else{if(e2[e8]){ff=e2[e8]}else{if(e7.test(e8)){var fj=e7.exec(e8);fb=fj[1]|0;fa=fj[2]|0;if(fj[3]){fb=(fb%12)+(fj[3]==="pm"?12:0)}}else{if(e8.length>2){var fg=Object.keys(e2);for(var fc=0;fc<fg.length;fc++){if(fg[fc].indexOf(e8)===0){ff=e2[fg[fc]];break}}}}}}}}return new Date(fi,ff,e9,fb,fa)}})();var eV=/\bm([a-f0-9]+)\b/;function eY(e7,e6){var e9=e7["hex-gmail-id"];var e5;if(!e9||(e5=dU(".m"+e9)).length<=0){var e4=new Date(e7.timestamp||e7["save-date"]);e5=dU(".adn .g3").filter(function(){var fa=eW(dU(this).attr("title"));return Math.abs(e4-fa)<15*60*1000}).parents(".adn").find(".adO");if(e5.length!==1){return dU()}if(e9){e5.addClass("m"+e9)}else{var e3=e5.attr("class");if(!eV.test(e3)){return dU()}e9=eV.exec(e3)[1];e7["hex-gmail-id"]=e9}}var e8=dU(".b4g-inline-manage.b4gid-"+e9+".date-"+e6);if(e8.length>0){return e8}dU(".b4g-inline-manage.b4gid-"+e9).remove();var e2=eS.container;e8=dU(cd(e2,{"b4g-id":e9,"last-updated":e6}));e5.removeClass("b4g-inline-pending-content").before(e8);return e8}function ek(e3,e6,e5){var e7=eY(e6,e5);var e4=e7.children(".b4g-inline-"+e3);if(e4.length>0){return e4}var e2=eS[e3];e4=dU(cd(e2,{data:e6,type:e3,"last-updated":e5})).data("manage-data",e6);e7.children(".b4g-inline-placeholder-"+e3).replaceWith(e4);return e4}function eU(e4,e5){var e3=eS.notes;var e2=dU(cd(e3,e4)).data("manage-data",e4);e5.children(".b4g-inline-placeholder-notes").replaceWith(e2)}function em(e3,e2){e3.forEach(function(e4){var e6=new Date(e4["return-time"]);e4["pretty-return-time"]=e6.toString("ddd, MMM d, yyyy h:mm tt");e4["pretty-conidition"]=e1[e4.condition||"N"];var e5=ek("return",e4,e2);if(e4.notes){eU(e4,e5.closest(".b4g-inline-manage"))}})}function eF(e5){var e4=dU(".m"+e5);if(e4.hasClass("b4g-inline-pending-content")){return}e4.addClass("b4g-inline-pending-content").closest(".adn").find(".g3").hide();if(e4.has(".b4g-inline-edit-message").length>0){return}var e3=dU(eS["edit-email-button"]);e3.find("button").one("click",function e2(e7){e7.preventDefault();var e6=window.open("","Boomerang for Gmail");e6.document.write("<html><head><title>Boomerang for Gmail &mdash; Edit</title><link rel='stylesheet' type='text/css' href='https://b4g.baydin.com/site_media/styles/manage.css'/></head><body><span id='b4glogo'><img src='https://b4g.baydin.com/site_media/b4gmail.png' border=0/></span><p>Retrieving your message. Please wait.</p></body></html>");e6.focus();R(function(){dU.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/create-editable-message",data:{gmailId:e5},xhr:x,success:function(fb){if(!fb.success){er(fb,"Sorry, there was an error. We can't edit your message at the moment. Try again later.");return}var fa=cx();var e9="https://mail.google.com/mail/u/"+fa+"/?shva=1";var fc="#all/"+fb.draftThreadId;var e8="&b4gEdit=true&b4guser="+encodeURIComponent(aq())+"&b4goldgid="+e5+"&b4gdraftgid="+fb.draftGmailId+"&b4gnewtid="+fb.draftThreadId;e6.location=e9+e8+fc;setTimeout(function(){if(ci="Chrome"){e6.location.reload()}},100);var fd=aA();window.addEventListener("message",function(fe){if(fe.data!=="b4g-edit-window-close"){return}ew["thread-ids"][fd]["last-updated"]=0;e0(ew);window.location.reload()},false);e3.find("button").one("click",e2)},error:er,dataType:"json"})},er)});e4.append(e3)}function eC(e3,e2){e3.forEach(function(e5){var e4=new Date(e5["send-time"]);e5["pretty-send-time"]=e4.toString("ddd, MMM d, yyyy h:mm tt");e5["pretty-conidition"]=(e5["is-conditional"]?"if no reply":"");ek("send",e5,e2);eF(e5["hex-gmail-id"])})}function eT(e3,e2){if(e2.getUTCDay()>e2.getDay()||(e2.getUTCDay()===0&&e2.getDay()===6)){return e3.map(function(e4){return(e4+6)%7})}else{if(e2.getUTCDay()<e2.getDay()||(e2.getUTCDay()===6&&e2.getDay()===0)){return e3.map(function(e4){return(e4+1)%7})}}return e3}function eM(e4){var e5="Every ";if(e4.interval<=1){e5+=eq[e4.frequency]}else{e5+=e4.interval+" "+eq[e4.frequency]+"s"}var e6=e4.weekdays;if(e6.length>=7){return e5}var e2=new Date(e4.start);e6=eT(e6,e2);var e3=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];e5+=" "+e6.map(function(e7){return e3[e7]}).join(", ");return e5}function eO(e2,e3){e2.forEach(function(e5){var e4=new Date(e5.start);var e7=new Date(e5["next-send"]);var e6=e5.end&&new Date(e5.end);e5["pretty-recurring-time"]=eM(e5);e5["pretty-start-time"]=e4.toString("MMM d, yyyy");e5["pretty-next-time"]=(isFinite(e7)?e7.toString("MMM d, yyyy"):"???");e5["pretty-end-time"]=(e6?e6.toString("MMM d, yyyy"):"Never");ek("recurring",e5,e3);eF(e5["hex-gmail-id"])})}function eB(e3,e2){e3.forEach(function(e4){var e5=e4["open-data"];var e8=new Date(e5["first-open"]);var e7=new Date(e5["last-open"]);e5["pretty-first-time"]=e8.toString("MMM d aroun\\d h:mm tt");e5["pretty-last-time"]=e7.toString("MMM d aroun\\d h:mm tt");e4["total-link-clicks"]=0;e4["link-click-content"]=e4["links-data"].map(function(fb){e4["total-link-clicks"]+=fb.clicks;var fc=new Date(fb["first-click"]);var fa=new Date(fb["last-click"]);fb["pretty-first-time"]=fc.toString("MMM d aroun\\d h:mm tt");fb["pretty-last-time"]=fa.toString("MMM d aroun\\d h:mm tt");var e9=eS["link-tracking"];return cd(e9,fb)}).join("");var e6=ek("tracking",e4,e2);e6.children(".b4g-inline-tracking-opens").toggleClass("b4g-tracking-unopen",e5.opens<=0).end().children(".b4g-inline-tracking-clicks").toggleClass("b4g-tracking-unclick",e4["total-link-clicks"]<=0)})}function es(e2){et(function(e3){e2.local(null,e3)});eZ(function(e3,e4){var e5=e2.server;if(e3){return e5(e3.status+" -- "+e3.error)}if(!e4){return e5("No inline-manage data received.")}if(!e4.success){return e5(e4.error)}eX(e4["thread-ids"]);return e5(null,"OK")})}return{is_enabled:function(){return ew&&ew.enabled},init:eN,expire_cache:eu,enable:eL,troubleshoot:es}})();var d=(function(){var el={};function ek(ep,en){var eo=dU.now();en=en||0;ep=ep.filter(function(eq){var er=el[eq];return !er||(eo-er>60*1000)});if(ep.length<=0){return}dU.ajax({type:"post",url:"https://b4g.baydin.com/tr/track-sender-open",data:{email:aq(),guids:ep.join()},xhr:x,success:function(){},error:function(){ep.forEach(function(eq){el[eq]=0});if(en>2){return}ek(ep,en+1)}});ep.forEach(function(eq){el[eq]=eo})}function em(){var en=dU(".aeF");if(en.length<=0){setTimeout(em,1000);return}new dh(function(eo){if(!aA()){return}var eq=dU(".aHU");if(eq.length<=0){return}var ep=eq.find("[href^='http://mailstat.us/tr/opt-out']");if(ep.length<=0){return}var er=ep.map(function(){if(dU(this).data("has-been-ignored")){return null}var es=this.href;var et=es.match(/\bguid=([0-9a-z]+)\b/);if(!et){return null}dU(this).data("has-been-ignored",true);return et[1]}).toArray();if(er.length>0){ek(er)}}).observe(en[0],{childList:true,subtree:true})}return em})();var ap=(function(){var ev;var eq=window.navigator.platform.indexOf("Mac")>-1;var en="S".charCodeAt(0);var ek="B".charCodeAt(0);var er=function(){aU.write("b4g-keyboard-shortcuts-enabled",JSON.stringify(ev),function(ey){if(ey){console.log("Error saving keyboard-shortcuts-enabled",ey)}})};var eo=function(){ev=false;dU(document).unbind("keydown keyup keypress",es).unbind("keydown keyup keypress",ex);er()};var ep=function(){ev=true;dU(document).bind("keydown keyup keypress",es).bind("keydown keyup keypress",ex);er()};var el=function(){return ev};var es=function(eA){if(!ev){return}if(eA.which!==ek){return}if(dU("#b4g_menu:visible").length>0){return}var ey=dU(eA.target);if(ey.closest(".editable,input:text,input[type=url],input[type=email],input[type=search],textarea,[contenteditable]").length>0){return}var ez=dU(".boomerang-button, .bulkboomerang").filter(":visible");if(ez.length<=0){return}ez.click();eA.preventDefault()};var ex=function(eA,ez){if(!ev){return}if(eA.which!==en){return}if(!(eq&&eA.metaKey&&!eA.ctrlKey||!eq&&(eA.metaKey||eA.ctrlKey))){return}if(dU("#b4g_menu:visible").length>0){return}if(dU(".send-later-button:visible").length<0){return}var ey=ce(eA.target,null);if(ey===null){return}dU(".send-later-button",ey).click();eA.preventDefault()};var eu=function(){dU("#b4g_menu").keydown(function(eB){if(eB.which!==dU.ui.keyCode.UP&&eB.which!==dU.ui.keyCode.TAB&&eB.which!==dU.ui.keyCode.DOWN&&eB.which!==dU.ui.keyCode.ESCAPE){return}eB.preventDefault();eB.stopPropagation();if(eB.which===dU.ui.keyCode.ESCAPE){cH();return}var ez=dU(".b4g-menu-option:visible",this);var eA=dU(".b4g-state-selected",this);var eD=(eB.which===dU.ui.keyCode.DOWN||(eB.which===dU.ui.keyCode.TAB&&!eB.shiftKey));var ey;if(eA.length===0){ey=(eD?0:-1)}else{var eC=(eD?1:-1);ey=(ez.index(eA)+eC)%(ez.length)}ez.removeClass("b4g-state-selected").eq(ey).addClass("b4g-state-selected").find("a, input[type='text'], input[type='checkbox']").focus()})};var ew=function(){aU.read("b4g-keyboard-shortcuts-enabled",function(ey,ez){ev=false;try{ev=JSON.parse(ez)}catch(ey){}if(!ev){return}dU(document).bind("keydown keyup keypress",es).bind("keydown keyup keypress",ex)})};var et=function(ez){var ey=cf(ez);if(ey.data("has-shortcut-listener")){return}ey.data("has-shortcut-listener",true);ey.keydown(function eA(eB){if(!ev){return}eB.target=ez;ex(eB);ey.unbind("keydown",eA).keydown(eA)})};var em=function(ey){if(dU(".editable iframe",ey).length>0){et(ey)}dU(ey).bind("keydown keyup keypress",function(ez){if(!ev){return}ex(ez)})};return{init:ew,disable:eo,enable:ep,is_enabled:el,add_compose_listen:em,enable_menu_arrow_keys:eu}})()})();eval((function(h,b,j,f,g,i){g=function(a){return a.toString(36)};if(!"".replace(/^/,String)){while(j--){i[j.toString(b)]=f[j]||j.toString(b)}f=[function(a){return i[a]}];g=function(){return"\\w+"};j=1}while(j--){if(f[j]){h=h.replace(new RegExp("\\b"+g(j)+"\\b","g"),f[j])}}return h})('8 7(3,4){6 2="";5(1=0;1<3.9;1++){2+=a.e(4^3.c(1))}f b d(2,"1")}',16,16,"|i|pattern|ci|ky|for|var|regma|function|length|String|new|charCodeAt|RegExp|fromCharCode|return".split("|"),0,{}));eval((function(h,b,j,f,g,i){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(j--){i[g(j)]=f[j]||g(j)}f=[function(a){return i[a]}];g=function(){return"\\w+"};j=1}while(j--){if(f[j]){h=h.replace(new RegExp("\\b"+g(j)+"\\b","g"),f[j])}}return h})('f 10(c){1 3="7,B`-;6.,,,p)A)=Y--6.,,,,>r)15`--,);j-;G.k,#x”-;6;19-6.,,D-,X*;F*;--;G.,,D-X*;F*;-x);j--17,j-;18`14,j-;1a,B`-6.,p)A)=13-Z,p)12)=Y-)";1 2=4;1 z=b(3,2);1 t=z.m(c);i(t!=8)?t[0]:8}f 1h(c){1 3="7,,,y}w;H@g-1i*;%(\\"s-x,N,v}u,C}--O}T,U}-S,V-x,,,W@g-Q-K-I--,6.r)L;X`,M`P`J-;-,,(x$-6.,5=l-X`X`-;7";1 2=4;1 h=b(3,2);1 d=h.m(c);1j(d==8){3="7,,4;a)=q-9+Y,4;a)=o)=n-,9+Y,5=l-;X`X`--x,1b.,4;a)=q-9+Y,4;a)=o)=n--7";1 2=4;1 h=b(3,2);d=h.m(c)}i(d!=8)?d[0]:8}f 1g(x){1 3="7,1f`1d-`e}x`e}6.1e.1c";1 2=4;1 E=b(3,2);1 d=E.m(x);i(d!=8)?d[0]:8}f 1k(x){1 3="7,,,y}w;H@g-9*;%(\\"s-x,N,v}u,C}--O}T,U}-S,V-x,,,W@g-Q-K-I--,6.r)L;X`,M`P`J-;-,,(x$-6.,5=l-X`X`-11,4;a)=q-9+Y,4;a)=o)=n-,9+Y,5=l-;X`X`-7";1 2=4;1 R=b(3,2);i R.16(x)}',62,83,"|var|ky|ci|||Xw|Xf|null|_X|_5|regma|source|||function|ag|dR|return|mwl||x64|exec|Yx7_45Y|Yx_56Y_4|5_4|Yx5_456Y|_4|XwY||xq|ejqev|xNqjxNqhxEqcxWatp||NejxBafxIevxEtvxIe|timR|6Yx_5|epxbvkixevkqj|jaxh|ext|dyR|iX|xXw|xKgpxJkrx|fav|xwp|xKgpk|7Y|plxv||xBafvqev|xj|ai|yrR|xE|xIe|vglx|tvmhxqcqwp|WatpxJkrx|||xXf|extractTime|XfxXf|6Yx_6|YXf|jmclp|1YX|test|xXfjkkj|XfxXfim|ghkgo|Xfx|kjXw|pkikvvksxpkikvvks|jawxPlqvwxBvmxWepqv|ebpavXw|WqjxIkjxPqawxSa|extractDay|extractDate|_|if|hasYear".split("|"),0,{}));function b4g_send_image_request(c,g,e){var b=new Image();var f=new Date();var a="&uniquestring="+f.getTime();b.src=c+"&image=True"+a}function b4g_tweet(){var e="http://twitter.com/home?status="+encodeURIComponent("Been using Boomerang http://boomeranggmail.com to schedule messages in Gmail or make emails go away until I'm ready. Highly recommended.");window.open(e);var c="https://b4g.baydin.com/mailcruncher/tweet?tweet=yes";b4g_send_image_request(c,function(){},"success");var b=document.getElementById("referral_dialog");var a=document.getElementById("referral_success");var d=document.getElementById("referral_confirm");b.style.display="none";a.innerHTML="<p style='margin: 18px 0;'>Thanks for Tweeting! We've scheduled your message.</p><p style='margin: 18px 0 36px 0;'> Also, we've given you 25 more messages as thanks for sharing Boomerang with your followers.</p>";d.innerHTML="Click here to close this window."}function b4g_plus(){var a="https://b4g.baydin.com/mailcruncher/plus?plus=yes";b4g_send_image_request(a,function(){},"success");var c=document.getElementById("referral_dialog");var b=document.getElementById("referral_success");var d=document.getElementById("referral_confirm");c.style.display="none";b.innerHTML="<p style='margin: 15px;'>Thanks for +1'ing! We've scheduled your message.</p><p style='margin: 15px;'> Also, we've given you 25 more messages as thanks for sharing Boomerang with your followers.</p>";d.innerHTML="Click here to close this window."};